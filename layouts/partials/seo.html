<!-- Enhanced SEO Meta Tags -->
{{- $title := .Title -}}
{{- $description := .Description -}}
{{- $keywords := .Keywords -}}
{{- $image := .Params.image -}}
{{- $author := .Params.author | default site.Params.author.name -}}
{{- $publishedTime := .PublishDate -}}
{{- $modifiedTime := .Lastmod -}}

{{- if .IsHome -}}
  {{- $title = site.Title -}}
  {{- $description = site.Params.description -}}
  {{- $keywords = site.Params.keywords -}}
{{- else if .IsSection -}}
  {{- $title = printf "%s - %s" .Title site.Title -}}
  {{- $description = .Description | default (printf "Browse %s articles on %s" .Title site.Title) -}}
{{- else if .IsPage -}}
  {{- $title = printf "%s - %s" .Title site.Title -}}
  {{- $description = .Description | default .Summary | default site.Params.description -}}
  {{- $keywords = .Params.tags | default site.Params.keywords -}}
{{- end -}}

<!-- Basic Meta Tags -->
<meta name="description" content="{{ $description | truncate 160 }}">
<meta name="keywords" content="{{ delimit $keywords ", " }}">
<meta name="author" content="{{ $author }}">
<meta name="robots" content="index, follow">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Canonical URL -->
<link rel="canonical" href="{{ .Permalink }}">

<!-- Open Graph Meta Tags -->
<meta property="og:title" content="{{ $title }}">
<meta property="og:description" content="{{ $description | truncate 300 }}">
<meta property="og:url" content="{{ .Permalink }}">
<meta property="og:site_name" content="{{ site.Params.opengraph.site_name | default site.Title }}">
<meta property="og:locale" content="{{ site.Params.opengraph.locale | default "en_US" }}">

{{- if .IsPage -}}
<meta property="og:type" content="article">
<meta property="article:author" content="{{ $author }}">
{{- if $publishedTime -}}
<meta property="article:published_time" content="{{ $publishedTime.Format "2006-01-02T15:04:05Z07:00" }}">
{{- end -}}
{{- if $modifiedTime -}}
<meta property="article:modified_time" content="{{ $modifiedTime.Format "2006-01-02T15:04:05Z07:00" }}">
{{- end -}}
{{- range .Params.tags -}}
<meta property="article:tag" content="{{ . }}">
{{- end -}}
{{- range .Params.categories -}}
<meta property="article:section" content="{{ . }}">
{{- end -}}
{{- else -}}
<meta property="og:type" content="website">
{{- end -}}

<!-- Open Graph Image -->
{{- if $image -}}
  {{- $imageURL := $image | absURL -}}
  <meta property="og:image" content="{{ $imageURL }}">
  <meta property="og:image:alt" content="{{ .Title }}">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
{{- else if site.Params.images -}}
  {{- range first 1 site.Params.images -}}
  <meta property="og:image" content="{{ . | absURL }}">
  <meta property="og:image:alt" content="{{ site.Title }}">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  {{- end -}}
{{- end -}}

<!-- Twitter Card Meta Tags -->
<meta name="twitter:card" content="{{ site.Params.twitter.card | default "summary_large_image" }}">
<meta name="twitter:site" content="{{ site.Params.twitter.site }}">
<meta name="twitter:creator" content="{{ site.Params.twitter.creator }}">
<meta name="twitter:title" content="{{ $title }}">
<meta name="twitter:description" content="{{ $description | truncate 200 }}">

{{- if $image -}}
  <meta name="twitter:image" content="{{ $image | absURL }}">
  <meta name="twitter:image:alt" content="{{ .Title }}">
{{- else if site.Params.images -}}
  {{- range first 1 site.Params.images -}}
  <meta name="twitter:image" content="{{ . | absURL }}">
  <meta name="twitter:image:alt" content="{{ site.Title }}">
  {{- end -}}
{{- end -}}

<!-- Additional SEO Meta Tags -->
{{- if .IsPage -}}
<meta name="article:author" content="{{ $author }}">
<meta name="article:publisher" content="{{ site.BaseURL }}">
{{- if .Params.tags -}}
<meta name="news_keywords" content="{{ delimit .Params.tags ", " }}">
{{- end -}}
{{- end -}}

<!-- Schema.org JSON-LD -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  {{- if .IsHome -}}
  "@type": "WebSite",
  "name": "{{ site.Title }}",
  "description": "{{ site.Params.description }}",
  "url": "{{ site.BaseURL }}",
  "publisher": {
    "@type": "Person",
    "name": "{{ site.Params.author.name }}",
    "jobTitle": "{{ site.Params.author.title }}",
    "description": "{{ site.Params.author.bio }}",
    "url": "{{ site.BaseURL }}",
    "sameAs": [
      {{- range $i, $social := site.Params.socialIcons -}}
      {{- if $i -}},{{- end -}}
      "{{ $social.url }}"
      {{- end -}}
    ]
  },
  "potentialAction": {
    "@type": "SearchAction",
    "target": "{{ site.BaseURL }}search/?q={search_term_string}",
    "query-input": "required name=search_term_string"
  }
  {{- else if .IsPage -}}
  "@type": "BlogPosting",
  "headline": "{{ .Title }}",
  "description": "{{ $description }}",
  "author": {
    "@type": "Person",
    "name": "{{ $author }}",
    "jobTitle": "{{ site.Params.author.title }}",
    "description": "{{ site.Params.author.bio }}",
    "url": "{{ site.BaseURL }}"
  },
  "publisher": {
    "@type": "Person",
    "name": "{{ site.Params.author.name }}",
    "jobTitle": "{{ site.Params.author.title }}",
    "url": "{{ site.BaseURL }}"
  },
  "datePublished": "{{ $publishedTime.Format "2006-01-02T15:04:05Z07:00" }}",
  {{- if $modifiedTime -}}
  "dateModified": "{{ $modifiedTime.Format "2006-01-02T15:04:05Z07:00" }}",
  {{- end -}}
  "url": "{{ .Permalink }}",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ .Permalink }}"
  },
  {{- if $image -}}
  "image": {
    "@type": "ImageObject",
    "url": "{{ $image | absURL }}",
    "width": 1200,
    "height": 630
  },
  {{- else if site.Params.images -}}
  "image": {
    "@type": "ImageObject",
    "url": "{{ index site.Params.images 0 | absURL }}",
    "width": 1200,
    "height": 630
  },
  {{- end -}}
  "keywords": "{{ delimit $keywords ", " }}",
  "articleSection": "{{ range .Params.categories }}{{ . }}{{ end }}",
  "wordCount": {{ .WordCount }},
  "genre": ["Cybersecurity", "Technology", "Education"],
  "about": [
    {{- range $i, $tag := .Params.tags -}}
    {{- if $i -}},{{- end -}}
    {
      "@type": "Thing",
      "name": "{{ $tag }}"
    }
    {{- end -}}
  ]
  {{- else -}}
  "@type": "WebPage",
  "name": "{{ .Title }}",
  "description": "{{ $description }}",
  "url": "{{ .Permalink }}",
  "publisher": {
    "@type": "Person",
    "name": "{{ site.Params.author.name }}",
    "jobTitle": "{{ site.Params.author.title }}",
    "url": "{{ site.BaseURL }}"
  }
  {{- end -}}
}
</script>

<!-- Breadcrumb Schema -->
{{- if not .IsHome -}}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "{{ site.BaseURL }}"
    }
    {{- if .IsSection -}}
    ,{
      "@type": "ListItem",
      "position": 2,
      "name": "{{ .Title }}",
      "item": "{{ .Permalink }}"
    }
    {{- else if .IsPage -}}
    {{- range $i, $section := .GetTerms "categories" -}}
    ,{
      "@type": "ListItem",
      "position": {{ add $i 2 }},
      "name": "{{ $section.Title }}",
      "item": "{{ $section.Permalink }}"
    }
    {{- end -}}
    ,{
      "@type": "ListItem",
      "position": {{ add (len (.GetTerms "categories")) 2 }},
      "name": "{{ .Title }}",
      "item": "{{ .Permalink }}"
    }
    {{- end -}}
  ]
}
</script>
{{- end -}}