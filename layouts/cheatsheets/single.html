{{ define "main" }}
<link rel="stylesheet" href="/css/cheatsheet-style.css">

<article class="post-single cheatsheet-page">
  <header class="post-header">
    <div class="breadcrumbs">
      <a href="/">Home</a> &nbsp;/&nbsp; <a href="/cheatsheets/">Cheatsheets</a> &nbsp;/&nbsp; {{ .Title }}
    </div>
    <h1 class="post-title">
      {{ .Title }}
    </h1>
    {{- if .Params.description }}
    <div class="post-description">
      {{ .Params.description }}
    </div>
    {{- end }}
    <div class="post-meta">
      <span title='{{ .Date.Format "January 2, 2006" }}'>
        {{ .Date.Format "January 2, 2006" }}
      </span>
      {{- with .Params.tags }}
      <span class="post-tags">
        {{- range . }}
        <a href="{{ "/tags/" | relLangURL }}{{ . | urlize }}">#{{ . }}</a>
        {{- end }}
      </span>
      {{- end }}
    </div>
  </header>

  <div class="post-content">
    {{- .Content }}
  </div>

  <footer class="post-footer">
    {{- $tags := .GetTerms "tags" }}
    {{- if $tags }}
    <nav class="paginav">
      Tags:
      {{- range $tags }}
      <a class="tag" href="{{ .Permalink }}"># {{ .LinkTitle }}</a>
      {{- end }}
    </nav>
    {{- end }}
  </footer>
</article>

<style>
.breadcrumbs {
  font-size: 0.875rem;
  color: var(--secondary);
  margin-bottom: 1rem;
}

.breadcrumbs a {
  color: var(--primary);
  text-decoration: none;
}

.breadcrumbs a:hover {
  text-decoration: underline;
}

.post-description {
  font-size: 1.125rem;
  color: var(--secondary);
  margin: 1rem 0 2rem 0;
  font-style: italic;
}

.post-tags a {
  display: inline-block;
  background: var(--code-bg);
  color: var(--primary);
  padding: 0.25rem 0.75rem;
  border-radius: 1rem;
  text-decoration: none;
  font-size: 0.875rem;
  margin: 0 0.5rem 0.5rem 0;
  transition: all 0.2s ease;
}

.post-tags a:hover {
  background: var(--primary);
  color: var(--theme);
  transform: translateY(-1px);
}

.tag {
  display: inline-block;
  background: var(--tertiary);
  color: var(--primary);
  padding: 0.25rem 0.75rem;
  border-radius: 1rem;
  text-decoration: none;
  font-size: 0.875rem;
  margin: 0 0.5rem 0.5rem 0;
  transition: all 0.2s ease;
}

.tag:hover {
  background: var(--primary);
  color: var(--theme);
  transform: translateY(-1px);
}

/* Enhance code blocks for cheatsheets */
.cheatsheet-page pre {
  position: relative;
  font-size: 0.9rem;
}

.cheatsheet-page pre code {
  display: block;
  padding: 0;
  margin-left: 0;
}

/* Copy button for code blocks */
.cheatsheet-page pre::after {
  content: "Copy";
  position: absolute;
  top: 0.5rem;
  right: 0.5rem;
  background: rgba(255, 255, 255, 0.1);
  color: #fff;
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  opacity: 0;
  transition: opacity 0.2s ease;
}

.cheatsheet-page pre:hover::after {
  opacity: 1;
}

/* Table of contents styling */
.cheatsheet-page ul li a {
  color: var(--primary);
  text-decoration: none;
  padding: 0.25rem 0;
  display: block;
  transition: color 0.2s ease;
}

.cheatsheet-page ul li a:hover {
  color: var(--tertiary);
  padding-left: 0.5rem;
}
</style>

<script>
// Add copy functionality to code blocks
document.addEventListener('DOMContentLoaded', function() {
  const codeBlocks = document.querySelectorAll('.cheatsheet-page pre');
  
  codeBlocks.forEach(block => {
    block.addEventListener('click', function(e) {
      if (e.target === this || e.target.tagName === 'CODE') {
        const code = this.querySelector('code');
        if (code) {
          navigator.clipboard.writeText(code.textContent).then(() => {
            const button = this.querySelector('::after') || this;
            const originalContent = button.textContent;
            
            // Visual feedback
            this.style.borderLeftColor = '#10b981';
            setTimeout(() => {
              this.style.borderLeftColor = '#2563eb';
            }, 300);
          });
        }
      }
    });
  });

  // Add anchor links to headers
  const headers = document.querySelectorAll('.cheatsheet-page h2, .cheatsheet-page h3');
  headers.forEach(header => {
    const id = header.textContent.toLowerCase()
      .replace(/[^a-z0-9\s-]/g, '')
      .replace(/\s+/g, '-')
      .replace(/-+/g, '-')
      .replace(/^-|-$/g, '');
    
    header.id = id;
    header.style.cursor = 'pointer';
    
    header.addEventListener('click', () => {
      window.location.hash = '#' + id;
      navigator.clipboard.writeText(window.location.href);
    });
  });
});
</script>
{{ end }}
